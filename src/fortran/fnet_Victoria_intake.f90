module fnet_Victoria_intake

! a = 0.0003468
! b = 0.41247

intrinsic Reshape
real, dimension(8,126) :: input = &
  Reshape((/0.230907897018,0.042916752308,-0.038169101580,-0.085583244136,-0.087805050693,-0.006108161126,-0.133854316135,-0.001202714466,-0.266482233174,-0.886008282124,0.550421928640,-0.158798304498 &
            ,-0.365813867082,-0.058577962493,0.167904377238,-0.054935440389,0.223006686387,0.140385160754,-0.189528656569,-0.054709164377,0.009175790852,-0.086157243088,-0.243562828488,-0.077926191297 &
            ,-0.087655018522,-0.135430818042,-0.462623284148,0.174507276452,0.278022388170,0.064498385711,0.070389812479,0.063519624236,-0.035436170725,0.481064351309,-0.345210810870,-0.033551693929 &
            ,0.288865704501,-0.000875798406,0.066163473286,0.006236790412,0.191719252721,-1.114120512057,-2.227061971209,0.071809102709,0.374431938557,-0.003836956587,-0.148799172177,0.004865759892 &
            ,0.080011751577,-6.871561939958,-7.370624290314,-0.194986798856,-0.253231421657,0.010371615728,0.040813520429,0.005666246236,-0.271801582768,-3.413249978437,0.207110055121,0.025076370995 &
            ,0.386501283590,-0.028994506515,0.158656562594,-0.018689312568,0.024112636754,0.088735634804,-0.346215926100,0.093094278618,-0.047286004799,0.092806467471,0.045857948241,0.100158596223 &
            ,-0.324804571320,-0.714219144157,0.647056561544,0.130441801484,-0.448507965337,0.085780717470,0.290209992306,0.092486503106,-0.054604021567,-0.168040260550,0.138049698721,-0.046163156771 &
            ,-0.136322616971,-0.014006938970,0.026983099906,-0.015475583249,-0.026478731401,-0.270373964626,0.228269229816,0.013128416228,-0.183732708997,-0.012656077459,0.008622339344,-0.016001637058 &
            ,-0.605782977073,-5.987089519093,4.368601574596,-0.029463595571,-4.984812596659,0.037544440029,0.253279190080,-0.055027894879,-0.012004000563,-0.034877209947,0.245408177465,0.038773125985 &
            ,-0.003099238341,-0.022224273564,0.013595134615,-0.025544777612,-0.037853280756,-0.068766674998,0.087152776507,0.038791378476,-0.048422670316,0.007510377265,0.009779836122,0.006438641038 &
            ,-0.052265715969,-0.182151734910,0.146152709550,0.052903205252,-0.196795350097,0.022202190886,0.040243377828,0.017290771266,0.044523206237,-0.306235931514,0.259003192208,0.058430770633 &
            ,-0.227485490233,-0.026938253315,-0.076421185772,-0.031440713304,0.084574150806,-0.239950583429,0.241048884951,-0.174287425154,-0.203089153452,-0.065929683205,-0.079852085725,-0.064347253170 &
            ,1.278073933548,5.627750952700,-1.551742304637,1.041817881420,4.552637353589,0.293883031563,-0.495477069740,0.310208084510,-0.091542117491,-1.760216585863,-0.412451087443,-0.821755977887 &
            ,-1.571992465853,-0.034090520149,-0.135520496849,-0.032019478320,0.011564406760,-0.651382573206,-0.154471928305,0.212443769254,0.320573673619,0.235121355189,0.183677739932,0.227954071973 &
            ,-0.331329051364,2.936497285334,1.709560605610,-0.101328461271,1.176155072733,0.057447364238,0.433476537086,0.065671744023,1.901501548632,-3.518333113852,5.133249216863,0.990219567527 &
            ,-2.846587237322,0.429428358490,-1.159367137904,0.326292482476,-1.467912622105,1.780607201736,-1.152730590419,-0.250269365353,0.985225750515,0.310620271142,0.953280090002,0.314502194361 &
            ,-1.083009983712,0.601268179012,-0.630716360335,-1.046433880168,1.345908513674,0.175442023922,-0.002136385148,0.237466158463,0.226080108181,-1.813005440032,3.586468633275,0.665693149155 &
            ,-1.334922563777,0.402339052888,-0.783585381596,0.407569683646,-1.382414656706,-1.401742361950,-0.070040861664,-1.528756143599,-0.739401637766,-0.042981915700,0.689942866346,-0.004894389544 &
            ,-0.036472606820,-0.182006194484,3.286989406560,-0.557220089976,-0.992360543692,0.176877667704,0.204411156511,0.281351783385,-0.433988327609,-1.307200937289,1.256456209667,0.430482470229 &
            ,-0.980441125160,0.137288162171,0.299422292697,0.127594542193,-0.078694782332,-0.211377601918,0.150286159269,0.181530841670,-0.178644056363,0.050937345802,0.066488981809,0.058663697211 &
            ,-0.107342245320,0.338172908057,0.626734003814,-0.551081584857,-0.126187313897,-0.103550388300,0.140113994151,-0.063142181637,-0.661914735422,-1.456869800137,1.094969203999,0.312500394583 &
            ,-1.301032343671,0.222502123519,0.567872498711,0.207388744681,-0.083654874608,-1.443808183290,1.338137147571,-0.033219623028,-1.247435627128,0.025820304710,0.157611099261,0.018281117798 &
            ,-0.469163953578,-1.012855076453,1.194211618875,0.002636584072,-0.725196499592,0.195357698393,0.537115994222,0.203231132162,-0.140608314518,0.032312860425,1.117455038066,-0.367865340264 &
            ,-0.210563798020,-0.136546259981,0.036717539442,-0.085044475122,-0.229250054441,0.042961809411,0.684988057741,0.179384892114,-0.221914355041,-0.040866914474,0.068664713948,-0.043116868580 &
            ,-0.736627808405,-3.311395946339,2.794114619422,0.531443507350,-2.959746114488,0.231110009019,0.654433443750,0.172687577140,-0.678967837537,-3.550936712886,0.767007233537,0.364112822408 &
            ,-2.677004926168,0.071676099695,0.537232307967,0.052341970641,-0.431360524001,-5.302085934121,1.326762714056,-0.381989012003,-3.288570006606,0.210614900388,1.053342976133,0.178764514391 &
            ,0.178887805672,-2.462597230759,-0.424771339104,-0.797483156747,-1.831273498270,-0.051484663621,0.185013822279,-0.065924775464,0.374569632092,-0.562903636787,0.048887644072,-0.632255467110 &
            ,-0.606964847376,-0.085568499227,0.026177476371,-0.133625104319,1.487018686019,4.632816648234,-0.700866321558,-0.830176664050,2.922651875593,-0.237963529317,-1.039634693069,-0.251699710019 &
            ,0.937625229318,4.203143029101,2.576085112816,-0.192773988671,2.259509664486,0.123631797859,-0.503641469545,0.069172425807,0.790330878207,6.419195019026,1.314786748876,0.500926257828 &
            ,3.411163637117,-0.048735404858,-1.073884790324,-0.069586452779,-0.289900921162,0.632651689707,1.373645004025,0.479789911166,1.378643887015,0.573111409954,0.704509094890,0.600908878268 &
            ,-0.737850896241,-1.310035406680,1.290593261243,0.280417741678,-0.034365199267,0.589235731264,0.882818755795,0.638355238357,-0.066606502786,-0.830522382040,0.377755451878,-0.120259287610 &
            ,-0.391442959743,0.010254933765,0.018141383189,0.021382923141,-0.114725050990,0.269213234479,-0.204984436284,0.072158452988,0.289115863418,0.089410694174,0.206178975525,0.092571099587 &
            ,-0.152209393067,-0.732034994505,0.277016743276,0.150131466905,-0.388246401853,0.048115391389,0.072513602165,0.051523313174,-0.117285347379,0.086555304879,-0.245430698584,-0.004865704355 &
            ,0.223612701556,-0.003316403783,0.083354109295,0.010852114344,-0.175372227606,-0.511214246790,0.089259770090,0.043672260392,-0.397442640075,0.077990732553,0.156552056099,0.073776357410 &
            ,-0.167676783904,-0.160563167940,-0.109965575530,0.032635710300,0.010699881934,0.083477671189,0.219725674429,0.089016665537,0.495435738786,-0.270808004965,-0.123648747093,-0.085640062389 &
            ,0.018881379583,-0.067607721411,-0.352348925161,-0.069715533217,-0.506564791896,0.097397355289,0.475148657900,0.261916751062,-0.086673167150,0.051532031696,0.267323427260,0.058832221489 &
            ,-5.535453968162,8.215866591888,-9.888968659675,-2.504565086614,3.799792229474,-0.350827369527,3.674790477823,-0.299760878143,13.137048909590,-1.392268564772,-19.227861767679,1.863212894919 &
            ,2.830379878409,-0.861667287322,-8.701055490507,-0.683903984401,-0.688146913043,4.660653073138,-6.260857312345,9.545261966024,1.013901688123,1.061907850161,-0.428485243075,0.856212220495 &
            ,0.277261384967,5.011548072504,-2.672573608520,14.147054924047,5.164196763602,0.343061938779,1.414270171415,0.305910268126,-2.250536394683,-11.781369208617,-9.759945524341,7.584333178282 &
            ,-7.480232865455,0.023277199751,1.424983347654,0.029050330585,-0.257392472072,1.241308661937,-11.079986595216,9.101142971922,1.161591434213,-0.112036652589,4.066725826638,-0.087952715274 &
            ,-8.648617211440,1.797392561716,-18.876111698313,-2.353640516053,-0.295018502800,0.065812601874,7.247223933706,0.130667557654,-9.421882884638,-1.278866123012,4.421600990072,21.304096558925 &
            ,-0.162302936250,1.117312234140,6.839971866063,0.944852766501,14.606963886669,5.239668536662,1.906462755598,7.886679228225,4.791377194352,3.190403444861,-0.327520905123,2.349990142805 &
            ,5.221908617875,-2.090871531782,-0.577225515612,9.573280366975,-0.724059889462,3.409025054589,-3.857022429417,2.545555299217,-3.520604742898,1.884950128073,-0.841822848630,2.061874691953 &
            ,-0.434428855002,-0.231643580778,1.434851439008,-0.239948723095,-0.290254155379,0.584145252451,4.121786098434,-0.524148981138,2.667196888311,-0.377592128481,0.636106025128,-0.267234572636 &
            ,-1.736029329655,-9.138618627785,5.056301016456,-0.303565245820,-7.816834341965,1.238571376811,0.251546814050,0.944167566198,1.022551300158,-8.881744319674,4.538521805210,-0.780863357198 &
            ,-7.854468463260,0.502765643591,2.351345400273,0.400128664443,-3.017375438946,-3.365021555882,2.209213831213,1.436357321259,-2.889174765985,4.181691997162,3.842153521736,3.702647924337 &
            ,-3.365607244298,-0.719202475445,-3.572169180075,4.287507305377,-3.478632179052,0.704830370083,2.967840872186,0.112278150286,1.397027725007,2.531314417244,0.641826630059,3.930441603832 &
            ,3.831787543105,1.765169611426,-0.365411340300,1.763195422207,-1.223853825665,-2.626633607924,6.211765511014,0.315738548006,-4.007193975429,-0.801678254728,-0.942166810851,-0.930798871651 &
            ,-1.583710212170,0.352343286239,-24.200015609156,13.635802840895,0.195951085401,-0.259308713462,-0.495868071562,-0.210895127525,-3.102994704898,-3.222081583635,-8.652498062424,7.083640708261 &
            ,-3.731073446527,-0.024309678019,1.456657113483,-0.020568349386,-4.083485512349,-1.967599283469,-15.193697311344,9.270809559410,-1.519692971412,-0.353542825195,2.361796908732,-0.319743141986 &
            ,-4.023064509040,1.260812601761,-5.840719154287,23.238562453492,0.848715810241,-0.160655646640,4.323701404445,-0.123840868975,10.486795299226,2.965415512254,-1.386007954950,39.135362514012 &
            ,2.847564150051,0.608238628883,-4.794483935464,0.525627220523,-2.268980222421,2.458836995416,-1.489886932217,45.987515109877,0.719750019032,0.078025279014,1.223094266436,0.105511085040 &
            ,1.022107068817,-0.194415628987,-4.395596020055,26.008117276627,2.735968602958,-0.067352747407,6.660680740247,0.046856314817,13.021737955761,-3.375354544791,-4.997585617757,29.119145498428 &
            ,-0.590616970980,-0.014137144018,-0.344385487526,0.027564819050,31.696974312099,-3.967883463356,1.606286968861,2.998061307158,-1.587681595578,-0.421270780171,2.227589028844,-0.330206432795 &
            ,4.526182121995,-0.520224940904,-0.535309881206,2.675722790004,0.967959478511,0.051234656537,1.822481918058,0.109518812341,0.382078873943,-1.313622006559,0.631021559060,0.601492316392 &
            ,-1.172614231329,0.307142788142,-0.459379071482,0.232257719964,1.074582927022,-0.281981323501,-0.801474145977,-0.345922986578,0.082344968725,-0.209565918325,-0.202211455840,-0.179021129852 &
            ,1.412612448284,2.975299725089,-1.298376103643,0.478208378182,0.752916183163,0.155739271873,-0.819006504278,0.154080307454,-0.064223316554,-2.028490650477,1.684567326268,0.290286425419 &
            ,-1.387403857965,0.011772232524,-0.013680625208,-0.018653676922,-0.277998166949,1.167298986208,-1.623093938108,0.428789417231,1.814555713615,0.242713457691,0.316451864098,0.237980321792 &
            ,0.192796521516,-1.759715593694,0.706030625973,0.331247610056,-0.076850846980,0.250325751587,0.348681448094,0.227256006912,0.219037890143,-0.492412104008,3.368045765409,-0.072551181726 &
            ,-0.451961947321,-0.255446458908,-0.642560513581,-0.199160183205,0.633901678410,-0.061589386309,-2.115008978723,-0.904295834329,-0.450413044068,-0.476355244368,-0.615622250780,-0.465216782566 &
            ,0.329825384358,-0.727234657049,2.317220964230,-0.249046774584,-0.308810763914,0.282888329716,0.146261383841,0.256414534830,-0.497702276991,-0.498170906998,3.032845803059,-0.436524939974 &
            ,-0.418150515497,-0.071579323002,0.287437756659,-0.070136275024,-0.240361815061,0.683186582529,1.842821336238,-0.490163594655,0.709439167019,0.220716704436,0.460709759333,0.240151762321 &
            ,0.635234967632,-0.490945333088,0.588350841631,-1.415718849222,-0.213790752729,0.103762188392,-0.174561269544,0.107527116751,-0.338187944525,2.381578861373,-3.149613385062,-1.633510218660 &
            ,1.448538563526,-0.103467140474,-0.116948700276,-0.103853909479,-0.488046913241,-0.346549579003,1.016987925137,-2.424493676395,-0.003254744161,0.029566346428,0.328284216514,0.039654209451 &
            ,0.819658500976,0.180313022364,-1.166686542040,-1.997741988956,0.535332973993,0.017610852095,-0.704752018164,0.050460049932,-0.280000484728,1.777465621521,1.815244954293,-0.960117531532 &
            ,0.900450605456,0.215957361699,-0.288075454124,0.240527068417,-2.034174542590,1.863421260299,-0.563806014018,-0.232665334790,1.032666679304,0.079772446916,-0.078449261005,0.156947561095 &
            ,0.174003007909,2.765612155876,-1.890241191632,0.556605042792,1.913878739375,0.100594871417,-0.477773002674,0.247263227783,-0.007007185553,1.192640460914,-0.438495446618,0.382763128387 &
            ,0.679844837563,0.037544991586,-0.018463511304,0.053212180823,-0.029469450806,0.299234031345,-0.152928054838,0.149278396858,0.207250496760,0.034753794730,0.013240661437,0.054812915145 &
            ,0.210646568003,0.307900948054,-0.764452000790,-0.112968090934,0.489512894995,-0.057561682916,-0.163334317189,-0.030481773852,-0.167385570405,1.254973331730,-0.925045103557,0.139994140228 &
            ,1.006677128999,-0.013324754445,0.092502018430,0.018591733021,0.255333952000,0.270949978823,0.074235084618,-0.164760152631,0.479081318937,-0.128263281376,-0.211032388455,-0.089980553629 &
            ,-0.086548214454,0.676214134764,0.262925598422,-0.178676068911,0.714195099531,-0.027188896886,0.087684092222,0.025248851915,0.066395457575,0.120396309424,0.379551312250,-0.433201682206 &
            ,0.204270033461,-0.099168221754,-0.051644876510,-0.047733749075,-0.429856207703,0.054740886946,0.540417886965,0.168840329580,-0.061364975631,0.096587430848,0.354434846828,0.094511449809 &
            ,-0.204412180850,0.178426724430,-0.324967688442,0.191613516721,-0.021804273158,0.023653919540,0.015263578910,0.023004491700,0.234866816893,1.832624980772,-1.365991732990,-0.044779641362 &
            ,1.369484069041,0.006332686608,-0.122247938722,0.030418937534,0.044237550684,1.142799494169,-0.948917350511,-0.188673865761,0.753238086864,0.007789556623,0.043882667413,0.023519968372 &
            ,-0.003319873040,-0.105813298948,0.233049529548,-0.092826467878,-0.057708923533,-0.041937945051,0.017624546416,-0.033063294582,0.122511343123,-0.826782926526,0.657467255748,0.107472061219 &
            ,-0.559692218303,0.010345834060,-0.025770788480,0.008281166391,-0.047793495189,-0.231471220070,-0.180149604611,-0.074617823572,-0.050862729730,-0.004913645176,0.050194518627,0.013581943834 &
            ,-0.206165416050,-0.222120896849,-0.565181500969,-0.114342300108,0.039378729635,-0.028699256519,0.149995879466,-0.004739078701,-0.506239472247,-0.707696865990,0.235685445849,0.042548876169 &
            ,-0.550286709682,0.064402627270,0.414935186027,0.077857970407,-0.446263498979,0.270257013612,-0.051074939409,0.079854959229,0.042945072927,-0.062478833403,0.386437324429,-0.055332892393 &
            ,-0.788684425951,0.481487581333,-0.134312313872,-0.180849973928,0.161291657077,-0.098530847415,0.730029273332,-0.105027294712,0.326381581304,0.238164009512,-0.140894881839,-0.017812665466 &
            ,0.193385587569,-0.030502810223,-0.231464034135,-0.029062654614,-0.165936635261,0.078495221945,-0.204209764837,-0.030606464233,0.019478894665,-0.021972589218,0.103942651620,-0.022421287053 &
            ,0.093391200480,-0.098180922832,0.070912230865,-0.037430350778,-0.066196948449,-0.025767792571,-0.069198878673,-0.025814585868,-0.020610355054,0.089382453802,0.078825619499,0.001800662258 &
            ,0.066830988643,0.003492587096,0.022172779978,0.003878654199,-0.062575574989,-0.013721248850,0.324040024025,0.013446571330,0.014209889848,0.025330180135,0.069471966731,0.025922814701 &
            ,-0.188232788574,-0.031464931645,-0.061028691804,0.006364191033,-0.028399009938,0.009409746154,0.132190240664,0.009011398526,0.080609927340,0.107328951155,-0.097697929240,0.005898485209 &
            ,0.090589609765,0.010513657219,-0.042838000476,0.010307285942,-0.479294176913,0.094128660991,-0.276061262338,-0.043322347796,0.001719147126,-0.038672918185,0.297467896489,-0.035936138711 &
            /),(/8,126/))
real, dimension(2,8) :: hidden1 = &
  Reshape((/-0.17103,-5.8451 &
            ,-0.073367,-6.9531,0.041487,7.145 &
            ,2.0019,-1.1336 &
            ,-0.46645,7.459 &
            ,-37.6183,-10.6793 &
            ,-0.31041,-8.5164 &
            ,24.3171,15.5584 &
            /),(/2,8/))
real, dimension(1,2) :: hidden2 = &
  Reshape((/-11.4376,11.7241/),(/1,2/))
real, dimension(8) :: bias1 = &
  (/-0.33419,16.8343,-7.0529,-27.1882,5.364,-2.6095,-7.2705,-3.3653/)
real, dimension(2) :: bias2 = &
  (/18.031,0.60917/)
real, dimension(1) :: bias3 = &
  (/11.8664/)
contains
subroutine fnet_Victoria_intake_initall()
end subroutine fnet_Victoria_intake_initall
subroutine fnet_Victoria_intake_engine(inarray, outarray, init)
  intrinsic MatMul, Size
  real, dimension(:), intent(in) :: inarray
  real, dimension(:), intent(inout) :: outarray
  real, dimension(126) :: inarray2
  real (kind=8), dimension(8) :: layer1
  real (kind=8), dimension(2) :: layer2
  real (kind=8), dimension(1) :: layer3
  integer , intent(inout) :: init
  integer :: i, j
  do i = 1, 126
    inarray2(i) = inarray(127-i)
  end do
  layer1 = MatMul(input,inarray2)
  layer1 = layer1 + bias1
  do i = 1, Size(layer1,1)
    layer1(i) = 1.0 / (1.0 + DEXP(-1.0 * layer1(i)))
  end do
  layer2 = MatMul(hidden1,layer1)
  layer2 = layer2 + bias2
  do i = 1, Size(layer2,1)
    layer2(i) = 1.0 / (1.0 + DEXP(-1.0 * layer2(i)))
  end do
  layer3 = MatMul(hidden2,layer2)
  layer3 = layer3 + bias3
  outarray(1) = layer3(1)
end subroutine fnet_Victoria_intake_engine
end module fnet_Victoria_intake
