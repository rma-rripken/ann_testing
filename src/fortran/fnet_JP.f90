module fnet_JP

! a = 0.00012646
! b = 0.21394

intrinsic Reshape
real, dimension(8,126) :: input = &
  Reshape((/0.030365175640,0.003531667385,-0.001580691912,0.144025228510,0.413331538935,-0.010699024290,-0.006555519337,-0.183868385369,-0.216591715635,0.205925643753,0.109301730680,-0.043996973930 &
            ,-0.479772559589,0.014266720766,0.058519437929,0.205931415643,0.380043066197,-0.521123224976,0.137992073921,-0.181173696447,0.748052770451,-0.067783655028,0.098246127973,-0.159868229123 &
            ,-0.239747530078,0.246809113004,0.126301458510,0.237649787798,-0.291025697498,0.077860040092,-0.050594364562,-0.041881800502,0.405105302526,-0.357515598801,-0.458205596582,-0.181188722719 &
            ,0.281731116601,0.412239092250,-0.549152196014,0.102645762762,-0.054851974389,0.178320037277,-0.169347864555,-0.095034352780,1.646842089715,-0.686134823133,1.025646120604,-0.063687928978 &
            ,-0.037107263337,-0.007655828146,0.043626114884,0.161842446234,0.378180185361,-0.152867580003,0.188601348790,-0.177242934004,0.177836765988,-0.201412853192,0.138522066862,0.142336074214 &
            ,2.095703266947,0.425999801868,-0.548283465699,-0.198126435815,0.076547921855,-0.016003945803,-0.109156103864,0.048064200273,-1.068759202724,0.224125674040,-0.320634368631,-0.056280997652 &
            ,-0.197362340772,0.192186956786,-0.052207288644,0.060368566165,-0.131910028222,-0.426437345568,0.702738253392,-0.027420892152,-0.208862075004,0.403946330628,-0.082568176169,0.076982443965 &
            ,-1.147012599191,0.444278400466,-0.732317803857,0.114897710591,0.011963242518,0.023103032842,0.124291903609,-0.262273385158,-0.069565156934,0.064965625466,-0.184615335569,0.166767398638 &
            ,0.145475632905,-0.309274091801,0.235023890036,-0.448492233825,0.101579992433,-0.168640501472,0.198782352725,0.237202952369,0.086832898019,-0.140511295757,-0.049008373082,-0.100245719546 &
            ,-0.228013515333,0.081269351847,-0.135785654365,0.090885512543,-0.012461928811,0.106743786824,0.032723706531,-0.070232303147,0.028600785715,0.016914100608,-0.067282951210,0.000900560857 &
            ,0.011627744216,-0.112318350878,-0.017364458169,-0.027344783732,0.170735717912,-0.148864488072,0.266421236113,0.051715016815,0.117800846340,-0.168620964172,-0.030869208120,-0.046771050527 &
            ,0.409509390146,-0.135452881781,0.193167579191,-0.060060879317,0.052523978300,-0.086391749775,0.076139591815,-0.027951684047,0.073890836940,-0.054467875892,0.117062038545,-0.027697429709 &
            ,-0.696785966220,0.770041189721,-2.591943186705,-1.734551285222,-5.125552267945,0.537540817245,-0.303132700887,3.584993967148,-0.954832033268,1.555752001337,1.737951281535,0.702930803535 &
            ,-1.189140144938,3.673309502790,-5.495036176949,0.051865704687,1.136253537437,-0.166887743123,-3.812957146850,-0.580003173559,6.366280480448,-2.814146305735,4.050508777257,-0.366457977826 &
            ,-1.253916576886,-0.117216096145,0.680223277014,1.872452148948,-4.764206745478,-0.915159060036,1.887123292325,-0.162733021995,0.020195745303,0.781801079790,-0.532846065722,2.710147205400 &
            ,10.722370933919,-2.848897458533,3.631056982788,-3.947100861869,1.126616621961,-1.996760585666,4.038967772620,-0.524954762638,-4.784418677498,1.866357586130,-2.537047607634,-0.666149266647 &
            ,-1.109936561406,2.052325193332,0.374163884157,-0.131273112450,-0.624678840996,0.693632173675,-1.234941429652,0.577208832266,2.238289904614,-5.236185802450,-1.355609362018,0.782153853078 &
            ,3.803115121477,-0.810579724549,1.974475976607,-0.284559981725,-0.198785944609,2.224572794285,1.422978925960,1.548344387249,2.363054367514,0.388504697804,-1.171503159882,-2.218342877736 &
            ,0.667917892343,-2.103752210962,3.558292484622,-1.693867427122,-5.069204236849,0.596924674414,-0.305256835084,1.598567152766,-0.295512562568,-0.084560177036,-0.656601162149,-1.121026473263 &
            ,-1.436509794780,-0.069450801689,0.256616132428,1.835974534257,0.042052466901,-0.368762448123,-0.746226522195,-0.654955053811,-0.167758733403,0.207680038684,-0.082885626479,1.210293400429 &
            ,0.108777750122,0.275178175176,-0.899545452534,0.600668023235,1.587934678511,-0.757196381607,1.133248135901,-0.625495255313,-0.016406921754,-0.125780157296,0.973614644128,0.157585951911 &
            ,0.366463610582,-0.287592892316,0.349457332064,-0.506452169192,0.425748126318,-0.536632441890,-0.377723189801,-0.131026763279,-0.113293149644,-0.441914960457,0.440603189084,-0.132006898501 &
            ,0.575280473169,-1.206326848492,0.421504471057,-0.629068144290,-0.585073181779,0.091250381793,-0.099135944535,0.359919251682,-0.023699013357,-0.077965056707,-0.781808818727,0.018116032979 &
            ,-1.727051375672,0.402559327640,-0.555605216387,0.503366591234,0.032573991483,-0.176002916120,0.163436710883,-0.480992369956,0.021098226727,-0.654026583084,0.682140235960,0.178907953990 &
            ,1.218041062372,-1.673425596836,0.279231744779,-0.850791226751,-0.426196810924,-0.047618632124,0.188335667854,-0.218787129383,-0.206475142733,0.011521233304,0.472888257087,1.120866342423 &
            ,1.009672704266,0.084677413021,0.044584785425,-1.231673502736,1.252959435424,-2.619878466386,0.458437580543,0.932316900288,2.587164983571,-1.939497928148,3.378601308113,-1.964032510943 &
            ,0.188035262153,-0.403645226346,0.002210200327,1.173862176747,1.553887443489,0.423150521438,0.051565911743,-0.382552698303,0.766078510449,-1.884780921682,-1.092181847753,0.330790779812 &
            ,4.229871748212,-4.036646049140,5.715639519162,-1.082205843850,-0.107501067772,0.100608960519,-1.269515021870,-0.250784192616,2.088718217292,-1.786527450505,2.601028865121,0.631507827460 &
            ,1.182866257993,-1.612044618060,-1.297955404335,-2.983947189108,-0.500397074128,-2.864715697719,4.034218903303,1.765402038318,0.554042705725,-0.176085680652,-0.880105559281,-2.618698624626 &
            ,-0.418686196093,-0.243548263046,0.632305102174,2.307695355351,-1.214068801227,1.045988931573,0.744228533927,-0.440075246125,-2.553603091781,0.303198516733,-0.497222414206,0.711035377830 &
            ,-1.480554654004,2.295439304870,1.391737641827,0.345487877275,-5.218394502553,4.731220450518,-6.725004131488,1.389606735923,-0.151012821611,-0.129911418495,0.207414874877,0.118993064001 &
            ,-0.635184055702,-0.009641795528,0.020953439662,0.047384935643,-0.074064057952,0.373234451586,-0.447652858954,0.255177430770,0.795024098052,-0.051503977146,-0.006950918205,-0.254523144928 &
            ,-0.188699149063,0.260607325744,0.257210661122,0.134645895230,-0.481058571555,0.255386585552,-0.386472474962,-0.065189158409,-0.044434010862,-0.181376665223,-0.404930954504,-0.559797658387 &
            ,-1.427248958302,0.507068687080,-0.612274590911,0.997131147894,-0.283019295342,0.381875009407,0.858950457045,1.025647237129,1.676288324013,-0.252357560399,0.289625546480,-1.273293070174 &
            ,-0.168645325258,0.243383085890,0.751036106975,-0.378223155755,-0.958517619250,-0.231583828286,0.295963679064,0.173034667223,-0.171678327683,0.177543072197,-1.214911795373,0.159654362954 &
            ,-1.099354967827,0.395900295778,-0.632071377963,0.605619526141,0.393600619259,-0.496386379741,-0.053218269733,-0.563974421536,0.657156392023,-0.863759367662,1.235812974711,0.151460938148 &
            ,1.509292556284,-1.039371335311,1.469608917711,-3.190654308149,-0.487427996799,-0.239827679536,0.159832927543,0.434385852092,-3.099863251490,4.017798786910,3.806706488687,2.648068382695 &
            ,-6.986180675414,0.990453559161,-4.333885328976,-2.118209619314,-3.585526040157,2.880322834126,-2.269379168203,-1.321977138228,-1.780088094734,0.930049627989,-2.670808920634,3.316201087102 &
            ,1.330216973030,-1.161160463206,-2.458969663897,5.806064225947,-0.602147904779,-0.572289195211,3.915272625436,-3.543917248407,3.879552768663,5.273581584848,-4.062287468465,0.410408028925 &
            ,1.680395802700,0.333230340694,-4.385281445414,-8.564006252855,4.324954526269,-5.023641669112,-3.210359997390,-0.078182214204,-8.395622561563,5.152513284246,-2.330376224698,1.414598281153 &
            ,-5.961737827131,3.719396931702,-5.762413172756,1.322750277437,0.213047969979,-2.361202770193,0.825311776722,2.833450034284,-3.350220467199,-5.426521489596,-4.739806983658,2.854193616455 &
            ,-0.661417102114,-1.345152042079,7.026995803144,4.262086502416,4.734026086125,3.464553097612,-1.434049690247,-6.108381514339,2.223687197351,1.236955677368,0.627772596169,-1.444836836363 &
            ,-3.820108218810,-4.050244225860,-0.943126373554,-1.259443078432,-2.454184486520,-0.929005390058,0.109476625708,-0.930649470675,0.992505311813,-4.576298339347,1.176626349576,-0.506373756302 &
            ,-0.013602382814,-1.757499289983,-0.379210612300,0.591877843423,0.854233112268,-3.019101668296,0.437481017022,0.375797565966,-4.124877255622,-0.181970056272,2.575024949017,-2.014414908462 &
            ,-0.348180676850,-0.942895378294,1.228246742696,-0.398027996644,-5.157412143660,-1.815787414375,2.461824458368,-1.184307710593,-0.570897956620,0.011290048186,2.383313189511,-3.276106016152 &
            ,-3.731662575114,-1.643714084796,1.363466768827,0.864722410493,-0.455829286142,-0.849645665593,2.746406421206,-4.336456314586,-1.511117324366,-0.835194741595,-0.285871746372,2.132679247422 &
            ,1.069028572930,-2.530762595449,1.341597524316,-1.655563765308,1.155112218209,2.200203293538,0.653777530654,1.766207062248,-2.969046846160,-1.193373398676,0.837116994538,-2.234963087619 &
            ,5.344506566422,-2.255892236302,-1.032649281665,1.606530906389,0.215837223292,-0.075906475784,2.263709108996,3.257884730451,0.368224821866,0.109074306129,3.911885908424,-1.360351911750 &
            ,0.067653601805,-0.477091984702,-1.363719908548,-0.334362823759,4.527668075369,1.198210868641,-2.064715677745,1.337100886139,1.308441930179,-1.958161567838,0.378176360089,0.506002793068 &
            ,8.637091912925,-0.545903923282,1.912020051912,-1.538824025461,-1.130855295040,0.961107033957,-1.104994353327,-0.141247728220,5.616887225183,-1.259345632479,-0.388101679204,0.001992768874 &
            ,-1.629764133133,4.937065543683,-6.577734400936,-0.752157114088,3.495903727385,1.748997202442,-3.603050199585,0.921156217795,0.572857516504,7.970568846828,-6.505721631123,-3.963589577625 &
            ,5.561669679616,-2.048448235202,2.191189000618,-0.908196224447,-0.886892769825,-3.212788944340,-9.440320697480,2.087799637116,6.000385718695,-1.022314131440,0.827394667348,-0.587801645976 &
            ,2.934327156221,-5.005392850556,-15.184293562638,-0.143917864727,2.670007627195,0.307790543932,-7.085258103505,-6.734728963259,9.183016297133,0.734564324819,-17.942104478232,-9.916017380564 &
            ,0.137910829949,5.865253417184,-8.959790637894,-1.747943785226,-9.017749791020,-3.323796011753,-12.878408871340,-2.284784656333,4.805246988005,-1.585823312095,4.971397899184,2.549445552707 &
            ,-14.468181486923,-3.819242387560,2.178681617858,0.423927322407,5.297283176066,-1.551040662051,7.144235465644,-2.246793549162,-6.533120185358,3.138570719724,1.120550688616,-2.547133880772 &
            ,1.848343307538,0.378067253809,3.096405270851,7.016561015295,-4.317624240978,3.216901780157,-1.210526552214,-2.259430641733,0.664802416300,1.850642168516,-2.310603988950,2.828413070615 &
            ,-3.664938314453,1.752527094532,1.852396745104,3.157152509893,-0.620937692238,0.693166017712,-0.259316997866,-1.916675436956,0.057102508790,-0.861188277020,-0.418735242269,0.636486191361 &
            ,0.746870767152,1.111634727788,-1.622356615211,-0.296175555215,-1.333927527382,-1.946387788297,-2.643515674945,-0.245601246426,-2.388378454929,-0.340488979031,-0.461896136836,0.554336837333 &
            ,-1.261261646702,3.463090291656,1.019523739540,-3.165045136421,-4.827524317218,-1.632261228314,1.445119302261,0.686088394206,-0.644348396413,0.412174211725,1.380494250908,-0.714042666330 &
            ,-0.466864523386,-0.597198252563,0.417607233005,-1.732784101650,0.306725870477,-2.839956723715,-3.359048678017,3.762451706074,1.632672809467,3.979251025492,-4.552148780545,1.097891105781 &
            ,-0.005820103384,0.024384654073,0.832891150238,-0.535475267713,0.052410117754,0.089120502327,-0.072685429331,0.117980140331,0.251904615252,-0.756609861449,-0.603744901117,0.199161956289 &
            ,-0.311518694845,-0.562631830816,0.935861374651,0.096115258628,0.195629489075,-0.167259696618,0.517588980623,-0.879268893307,-0.622846330124,-0.129094952563,-0.004668904160,0.364702765920 &
            ,-0.129348211439,-0.157850666792,-1.057540721874,-0.571346199555,-2.938970231270,0.146633350408,0.269068116900,1.452266980034,0.094948807805,-0.696465459870,1.431481221347,0.673320106992 &
            ,1.826457004154,-0.140484221892,-0.040732909147,-0.996856897404,-0.298938821353,1.211939517987,0.037361733915,-0.363519065189,-2.104352093877,1.162771820908,-1.657038914179,0.661139088664 &
            ,-0.330496680104,0.576324096613,0.066237347542,0.333094024306,0.706451638122,-0.939485842380,1.747322791358,0.096881961724,-0.551024300845,-0.831949499723,1.852284432834,-0.336281287995 &
            ,-1.315767701955,-0.356225950870,0.404603432773,0.979545848243,0.320302922339,0.719152872568,0.325205510478,0.923873537299,-0.095305592692,-0.035550061423,0.024995271607,-0.740704651887 &
            ,-0.031752556159,1.639875565128,-0.730632860775,1.012704204676,1.095150757727,0.761618498016,-1.144940941938,-0.004434656275,0.398705868684,-0.765689374954,-0.798372949740,-0.403768765500 &
            ,-1.840969670191,0.186730091843,-0.397988257697,0.798817117314,0.179359958926,0.098490096669,-0.333017198012,0.168136531366,0.538834215701,-0.227586112624,0.294081879108,-0.202298918246 &
            ,0.108319028973,0.011630673861,-0.476326431621,0.061414809906,-0.289826880529,0.256639899441,-0.581283942183,0.142952955757,-0.027172090593,0.412956469214,0.100959350383,0.223352293849 &
            ,0.672114115336,-0.302463210142,0.431490821330,-0.327392749776,-0.240395770547,0.709265860156,-0.019123566923,-0.040547317312,-1.546879706218,0.638965269296,-1.083313051875,0.322483159015 &
            ,-0.194537977223,0.174869537889,0.196647849775,-0.450297258533,-2.234813776552,0.421982822941,-0.730610565801,0.804762074228,0.171380098085,-0.255925504850,0.432848716360,-0.337139452406 &
            ,-0.616074295682,0.181361996183,-0.432026772686,0.191338538371,0.113112373230,-0.131842723803,-0.024239610338,-0.150955995277,-1.219823564832,0.959073020081,-1.493652628952,0.338263432458 &
            ,-0.054891587809,0.181464558010,-0.001235645921,0.374484179483,-0.241535785053,-0.521731860520,0.674444080743,-0.534478963052,0.096032151156,-0.145046096463,0.232880579216,0.112369773562 &
            ,-0.128612649089,-0.313481232642,0.398989633454,-0.308619822196,0.030390084996,-0.192808799791,0.323589311415,0.003768516458,-0.062556733257,-0.545169999335,0.728318481567,-0.271617522476 &
            ,-0.094913191673,0.188821292745,-0.081376125115,0.265520191889,0.555588588586,0.017409829942,-0.116336520524,-0.207551085860,0.191812051078,-0.677874116086,0.323149485514,-0.523842381603 &
            ,-0.417354606198,-0.142147169266,0.198802607692,0.344906918499,0.047830836894,-0.311376173448,0.008240282305,-0.028403009557,-0.101630624580,-0.110992651303,0.279036315116,0.096831571562 &
            ,0.104736183258,-0.578770430924,0.536628301623,-0.576746015742,-0.329518945562,-0.301526653724,0.331985782508,0.274200575231,0.154404277691,-0.328082377716,0.330819614020,-0.332073917788 &
            ,-0.111447323253,-0.197999021032,0.333113208658,0.101094281433,0.099916816963,-0.517916431433,0.251248599341,0.242902543430,-0.370044857613,0.141889596124,-0.008820951881,-0.105111787896 &
            ,0.336105396303,-0.216358055558,-0.646209807062,0.512675035057,1.274493739252,0.208443805994,-0.484090482867,-0.673262050579,0.240007237638,-0.192999727550,-0.079303318663,0.219792096539 &
            ,0.941153103059,-0.117883714785,0.213094885450,-0.405935221259,0.098887956493,-0.147975009423,0.057515002597,-0.070737705456,0.264973170553,-0.132649751723,0.215425965339,-0.035801734454 &
            ,0.107289425360,-0.160938517389,0.058154390683,-0.065995441723,0.105986112622,0.021275147509,0.007094356133,-0.011134347134,0.084795360976,-0.065838313857,-0.227333588348,0.024286280471 &
            ,0.115756685977,0.103604959761,-0.109885521035,0.012843346838,0.005461377310,-0.029068819783,-0.055354481925,0.060554160783,0.165563925088,-0.094529392351,0.154607513659,-0.065453239643 &
            ,-0.055233410026,0.052895231905,0.004241029557,0.102345092533,0.117074869103,-0.105989385943,0.170508890374,-0.090936069632,0.021835713299,0.011158219075,-0.017589128469,0.048075450882 &
            ,0.225846722099,-0.011003533640,0.041534796194,-0.093562562216,0.023118280143,-0.047898401624,-0.077022261267,0.057816744099,0.467189971927,-0.160888935046,0.259011518374,-0.089332607650 &
            /),(/8,126/))
real, dimension(2,8) :: hidden1 = &
  Reshape((/-10.2925,7.8414 &
            ,-3.6046,1.4836,-2.9351,2.153 &
            ,-8.3748,8.7636 &
            ,0.87419,-3.9974 &
            ,12.5163,-8.2713 &
            ,6.493,-2.5149 &
            ,-7.0399,2.8421 &
            /),(/2,8/))
real, dimension(1,2) :: hidden2 = &
  Reshape((/-3.322,-2.4435/),(/1,2/))
real, dimension(8) :: bias1 = &
  (/0.42121,8.5627,7.1985,3.4193,1.622,1.7032,-4.7393,-1.9133/)
real, dimension(2) :: bias2 = &
  (/8.3849,-6.4576/)
real, dimension(1) :: bias3 = &
  (/3.5623/)
contains
subroutine fnet_JP_initall()
end subroutine fnet_JP_initall
subroutine fnet_JP_engine(inarray, outarray, init)
  intrinsic MatMul, Size
  real, dimension(:), intent(in) :: inarray
  real, dimension(:), intent(inout) :: outarray
  real, dimension(126) :: inarray2
  real (kind=8), dimension(8) :: layer1
  real (kind=8), dimension(2) :: layer2
  real (kind=8), dimension(1) :: layer3
  integer , intent(inout) :: init
  integer :: i, j
  do i = 1, 126
    inarray2(i) = inarray(127-i)
  end do
  layer1 = MatMul(input,inarray2)
  layer1 = layer1 + bias1
  do i = 1, Size(layer1,1)
    layer1(i) = 1.0 / (1.0 + DEXP(-1.0 * layer1(i)))
  end do
  layer2 = MatMul(hidden1,layer1)
  layer2 = layer2 + bias2
  do i = 1, Size(layer2,1)
    layer2(i) = 1.0 / (1.0 + DEXP(-1.0 * layer2(i)))
  end do
  layer3 = MatMul(hidden2,layer2)
  layer3 = layer3 + bias3
  outarray(1) = layer3(1)
end subroutine fnet_JP_engine
end module fnet_JP
