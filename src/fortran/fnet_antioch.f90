module fnet_antioch

! a = 5.9955e-005
! b = 0.15402

intrinsic Reshape
real, dimension(8,126) :: input = &
  Reshape((/0.023512500060,0.041953285916,-0.013548704415,-0.090095164280,-0.011517231194,-0.205627706091,0.006927424332,-0.065120347880,0.019665841469,-0.105577195802,-0.156119271417,0.045904959933 &
            ,0.059189008681,0.169226629700,-0.115455492286,0.468083456792,0.017904334640,0.088176442742,0.075894227786,0.092549115205,0.029770575815,0.158927128611,-0.098659296296,-0.236049094333 &
            ,0.009583269472,-0.024933035887,0.080017185098,-0.161139836915,-0.107922737410,0.288613346625,0.297204576792,-0.375498786537,0.321202832994,-0.007039298563,-0.046562762736,0.255503607359 &
            ,0.059870297130,-0.498235698126,-0.390102170987,0.251929489127,-0.166321545233,0.176179825942,0.184421959607,-0.031785188373,0.011234206674,0.432106954055,0.244785715878,-0.349310256213 &
            ,0.071051864864,-0.050893445096,-0.514681454469,-0.231193113091,0.042759611463,-0.429492864896,-0.788046599605,0.462443959465,0.497323317800,-0.062595934635,0.052043491507,-0.327550392541 &
            ,-0.220700492743,1.817361129404,0.546009009749,-0.066964795445,0.006209850455,-0.099654563494,0.566925715843,1.055432908905,0.168554113941,-4.505925777001,-0.097830480556,-0.601178857149 &
            ,-0.384730037206,0.241805332774,-0.157052101454,-0.599851109818,0.050905928959,2.035290096125,0.244684267430,-0.093343943504,0.154628871577,0.002286775625,0.026980402607,0.017340702145 &
            ,-0.043402972317,0.430398543869,-0.044640590776,0.079538438625,-0.000813853329,0.012347392349,-0.085353762099,-0.073867094471,0.013876224995,-0.068224053579,-0.066815684355,0.170559247408 &
            ,0.176895402300,-0.138791424765,0.175201403850,0.029224212579,-0.113914663596,-2.185874393877,0.448911672964,-0.290827306828,-0.058821351371,-0.042746812558,-0.091899333352,-0.150761141784 &
            ,-0.014347461062,2.013960968296,0.071448982997,0.039942389947,-0.116456756782,-0.018068168469,0.008458948134,0.052546891595,0.060379468567,0.122262025229,0.038038055269,0.096206839441 &
            ,-0.091955638999,0.051361134063,0.139731972571,0.109315436934,0.023317759856,0.557143029269,0.115887278370,-0.059239589076,-0.046741961829,0.046346303338,-0.117150661406,0.045645787578 &
            ,0.095109006414,-0.148744285742,-0.297470641189,0.240148135390,0.309945363273,-0.077420718312,0.323507183743,0.192042205195,-0.128464431549,0.358401308013,0.432995623344,-0.408505463626 &
            ,-0.846260593102,0.698080419908,-2.011069149764,-3.377076370285,-0.151201131105,11.365496673812,-0.576047963854,2.269014957572,1.080700848158,0.644702829879,-0.888661732796,-0.389850728917 &
            ,0.258240839537,3.564505011980,-2.400596648404,-2.238292719006,-0.512062007812,-0.642634987453,0.443017650159,0.855002694654,-0.046894470961,6.782976743516,0.793609372085,0.389299922186 &
            ,0.311843337082,-0.457576113005,2.172469759711,2.660592895802,-0.096107211848,-14.419085247224,1.649251391336,-0.959413580979,1.919979152770,-3.332311737890,0.523777657295,-1.813404155374 &
            ,-2.709516824563,7.024278475750,4.776647926356,-2.698155344317,-1.384850787898,1.504579566841,-0.206025425168,1.387609455135,1.548873375204,-4.235410434845,-2.360875290396,1.258464706040 &
            ,-0.001619517169,-0.307582914855,-1.910133607903,-2.439529748674,-0.381873717761,7.353504079520,-0.198183564779,2.624308874794,-2.116137327321,0.758149873786,2.737535287331,1.383443400704 &
            ,0.140553918390,2.048364906543,2.523625321603,-6.438475225662,1.591914219979,-0.103479405471,-0.144758333769,0.096550049671,-0.333106030377,6.826744244083,0.588425852025,1.063280081366 &
            ,-0.031213738583,-1.166526661999,-1.427061220027,-2.517946239851,-1.639478714192,1.019247792646,0.023739741581,-0.838886500841,-0.715290325045,1.119883564199,0.304416617129,0.401164092312 &
            ,0.501013159597,1.457070405619,-0.882325240928,-0.949460900111,0.428594087183,-0.237614224379,-0.247972138295,-0.194598747942,-0.188885996800,2.434798102410,-0.225330184586,-0.264979968645 &
            ,0.025137247004,-0.071495866884,-0.196061294108,0.209622087371,0.046768164353,-0.618349954563,-0.698553323475,0.644279990650,0.135440660262,-0.366901048285,0.572057373698,1.015709325157 &
            ,-0.173310493203,-4.750472898295,-0.154480733476,-0.650030536259,1.037223431852,-0.188400795633,0.034043073313,0.510720493271,-0.095168935160,-0.080397456187,-0.048705129259,0.891957692865 &
            ,1.487744637570,-0.248813836733,-0.242578249930,0.596661319952,-0.006543688263,-2.809734587491,-0.739454943044,1.250540201575,0.604942151275,0.110460140797,0.557251040996,0.452092300667 &
            ,-0.096843074487,-2.290642856129,0.450200611923,-0.604302606941,0.568622299533,0.296721602601,-0.604504198362,-0.844001029798,-0.016659951237,4.522109623542,-0.310686998473,0.539983045981 &
            ,0.974182204833,-0.461897051570,0.182810362932,0.866417462734,0.226491690194,-5.484365835839,-0.044769903210,0.105259138173,-0.591107870335,0.202421306094,0.716410389987,1.484776592155 &
            ,0.841822566996,-2.765442256197,-0.261924383174,-0.767691118312,0.813819939988,-0.213189708831,1.253791768417,0.690598915445,-0.150124627525,-4.471464599884,2.061302470838,-1.019463422020 &
            ,-1.858607680179,0.007844677290,1.070171536848,1.400521588739,-0.071950093180,-3.385192390197,0.437526348597,-0.379300141411,1.822064012848,0.032323199424,-0.999611614494,-0.967880710779 &
            ,-0.015210871853,7.105285501077,-0.218905459806,2.175341619524,-1.283466013691,0.861143777245,0.006647806736,0.457847987232,0.525299063270,1.898502734129,-0.784583944863,2.172213194673 &
            ,1.632986260246,0.479469264846,-0.956460662938,0.619005658761,0.794298216100,0.233546638589,-2.182186072616,3.073137386763,-0.530399745320,0.795153544432,-1.576462681544,0.294008711429 &
            ,0.719269452192,2.783775019724,-4.497258857549,1.159117749002,2.037178241317,-1.156435572189,0.528918736506,-0.049667869761,-0.562405331988,-5.326975654915,1.663705349882,-1.098894323220 &
            ,-1.332745663787,-1.402979315512,2.723807831160,2.260891977389,-0.819327046309,-14.135722689955,3.048637779420,-3.300570941875,-0.178841700330,-0.173362747066,0.548241246407,0.731427224888 &
            ,0.125878445455,-2.000764496888,0.483691765589,-0.285122638358,-0.004622569087,0.111217084607,-0.392545679191,-0.895515520286,-0.126307191224,2.754778987347,0.160172043035,0.030958766791 &
            ,-0.004477772737,-0.013782103960,0.423957349410,0.688296717281,0.141658425857,-2.197570637165,0.090999183925,-0.053977602735,0.249491255258,-0.029477977260,0.046189624701,-0.792311320839 &
            ,-0.367011334696,2.822103507110,0.796453772660,-0.969620732879,0.540835981750,-0.434408910744,0.321533861095,0.452195637324,-0.188564635454,-3.598287820936,0.424360974075,0.011024857223 &
            ,0.281468367236,-0.244358954416,0.443493173142,1.397981407859,0.251798579991,-7.840574947111,-0.432991493014,0.557690524840,-0.248555580846,0.490481201734,-0.917454331590,-1.874452500769 &
            ,-0.198177830551,11.706419190432,-0.191457712637,-0.473439830268,1.058672691031,-0.330886985109,0.001962853565,0.084951597389,-0.419783609927,-1.963450791412,-0.084655681745,-0.192764493118 &
            ,-2.283007340899,2.050508608293,1.063820315717,1.989746065322,1.671214242715,-7.791915281223,-0.599157105086,10.325064317330,4.238065713274,-2.400644076471,0.656421135882,-1.839839137347 &
            ,-2.427810997248,1.120267608611,4.736997724178,-9.183212077873,-4.744250791497,0.030432508515,2.217453161232,-2.941955924784,-1.730772306431,-0.098690242885,3.841371536718,-14.579640008905 &
            ,4.567331562982,-0.120402982100,-0.397451421993,4.482513423978,1.595033187189,3.613922508363,-2.451694964830,9.890096569569,-2.224122497758,-1.801462917476,-6.421069799068,-2.780707131537 &
            ,0.306625173323,4.599751584901,-9.873489749876,3.223845523399,-2.052534179413,4.508380645465,3.316435210458,-4.337341417265,-0.623963851893,-7.601148499030,6.551713658374,-3.799899965576 &
            ,-1.389500015474,-1.761476797546,2.052014940304,3.405993955249,0.082038746378,-6.054324423929,-3.065211838087,-1.995933454829,7.592779682301,6.707497524389,3.783622451890,-3.267197688283 &
            ,0.924453933340,3.039439234158,9.600750181477,-0.858231101710,9.400355031621,-2.709189992148,-1.340867241056,5.373552383245,1.726178427979,0.863318669927,-5.304245620291,7.338312907583 &
            ,-5.347710677508,1.108655836665,2.104378742926,-2.198017739167,2.861596869324,-3.712443093399,4.018491476760,-3.496990489624,-5.094262033692,-2.969282416373,-2.488765425442,-0.401412818028 &
            ,0.505913053561,5.986585486495,-2.908527211110,-5.645632908189,-0.849255489113,0.108507508955,2.222287590842,5.800003245388,2.646058749815,5.207479129382,-2.479105012840,-3.873387931402 &
            ,0.783520019023,0.117214390270,4.203886396175,5.575431802444,2.152363397412,4.202606412685,-0.278168484884,0.178005026722,1.844030207859,0.432296491078,1.133895626544,1.109326631953 &
            ,-1.304969200232,2.731615588325,1.263418462952,0.316527881349,2.719943335373,0.029956387912,-0.502753695549,-2.942928433084,1.138847933849,1.154675560668,0.952070588521,-1.875439866627 &
            ,-0.505303751540,-0.474353534736,-1.636829832290,-1.561114052688,-0.566509078938,-0.202139760024,1.365581321309,-1.315030664899,-2.985990382903,-2.360858844358,-4.337665801503,-6.615865717979 &
            ,1.840624078625,-3.235280398827,-1.342801936445,-0.500590414464,1.938260937540,-0.333009805531,3.827716349538,2.354644549073,-3.372131423898,-8.160478628713,3.767684213539,-1.990562131687 &
            ,-2.150195576855,1.032168381456,-0.634401451005,0.317174726167,1.070926827739,8.497071019415,-1.809771897549,8.354549655357,2.268446033734,0.203304957864,0.483552919259,-2.615074924465 &
            ,-1.271891910057,5.319519538292,3.744644791711,-3.108200630217,-2.598902995071,2.703751919852,-2.105287759901,3.286522483910,3.525971341287,3.856836776333,-12.356463965782,-4.119180200266 &
            ,4.504824311260,-1.832925369532,-2.491503267246,-3.015750807052,-1.350986555253,-5.180494683612,-0.878233414015,9.352244222209,-3.093064161466,-5.532748208760,-0.174640976928,3.002919346872 &
            ,-1.557174933949,10.317028788225,-3.504381318281,-6.417809530781,1.068126878507,6.376522487518,4.189058742254,-2.414632329501,0.956621913248,-1.803282744966,3.652480132981,1.732984235515 &
            ,5.622156075943,3.841814259269,2.102688673875,2.872634399750,2.338961548502,3.828784364443,-7.444548345926,-0.165759086759,5.267486370146,9.174822874017,1.540564035756,-14.517557320692 &
            ,0.615363451128,11.715363228775,4.925688085131,-15.346519132537,9.853506527216,8.648312859557,4.450404528090,-5.320167019801,4.967035375663,12.672573520075,2.132223684712,-0.595017194057 &
            ,-9.057341388478,1.226118850645,-6.294024455270,-11.021193684193,12.965448086406,3.056711865333,-0.329983336093,9.969538019927,-4.774698693599,-6.280890544110,-2.369626798933,2.141271818979 &
            ,5.088883468530,0.521583894358,3.816591678113,2.348250005623,-1.951065984549,-1.829847927763,0.425731480555,-1.754120277717,0.031334840022,-2.579538211055,2.446072095612,-0.270206081478 &
            ,-2.283107949065,-4.196602506983,-0.206516300639,-0.979105467573,1.010538194925,-8.470376188485,4.033010912402,-2.655231912047,-1.976026013265,-2.038210257895,1.647874456955,2.120215241933 &
            ,0.781883982216,-8.819817230825,3.846135788101,-0.304667920681,-0.147663012796,-3.302041533714,3.167710248178,4.169979126051,1.885537158850,-9.007180149721,3.840080101377,0.577990101589 &
            ,-4.074414124993,-2.312313952891,2.296597897747,3.269837281992,2.927094586325,-15.007301847142,3.206402453850,-2.856140734250,-1.802435557213,-1.450315907003,2.368665275156,1.207292566159 &
            ,0.215815414391,-15.527616931089,2.544111726239,-4.275318176986,-0.035742912253,-1.208866232003,0.231405618137,-0.041547096273,-0.341784292409,3.323095604449,3.038837271524,-1.045733459047 &
            ,-0.116373987725,-0.274631224777,-0.369627585619,-0.429562313309,-0.108210735380,3.174781217663,0.073116621632,-0.106732530332,0.235472824772,-0.072208454121,0.671278383608,1.398992808664 &
            ,0.206814570356,-6.247271296029,-0.104053496084,0.509892945961,0.594716813362,-0.434136330908,-0.751754748323,-0.651371335461,-0.309688196911,0.854578117747,-0.674460772409,0.174252787615 &
            ,0.086081508134,0.260536524335,0.590694918859,-0.264851377375,-0.216687970305,3.581321180312,1.424704170776,-1.023735976465,-0.275876150759,-0.356045382514,0.118303807362,0.227986231781 &
            ,-0.073374844138,-5.182114439131,0.270385714048,0.235405466124,0.209527473269,0.054299038798,-0.633144703870,0.734473770969,0.508535825814,1.279675711533,-1.836953801408,0.665422599507 &
            ,-0.503033038829,-0.320998496578,0.410786914218,-0.481797409601,-0.472235469139,0.489146102261,1.882521111097,-0.774310565664,0.256848245805,-0.187993188089,-0.407405352135,0.928580719804 &
            ,0.284926666197,-1.536297827266,-1.309131438130,1.428687136619,-0.950349193308,-0.719305952739,-0.728740569050,-0.545227648469,-0.462657826832,0.896793453050,0.086578898030,0.316989613099 &
            ,0.474188433189,-0.245980343683,0.648872974130,1.064471915543,-0.713657609622,-1.104850724323,0.085054491462,-0.765248723053,-0.227285007866,-0.065174723991,0.716556803991,0.147030527025 &
            ,-0.406624790799,-3.697031010997,1.080925270697,-0.727198065502,0.413606007240,0.092660307343,0.069578583839,0.228426489280,-0.079206450511,2.452024376084,-0.160795209456,0.050830179319 &
            ,-0.280077624774,0.043240419017,-0.054302344373,-0.353797626573,-0.203936559662,0.957484604603,0.189239407035,-0.043563646456,0.266037948247,0.074676703372,-0.082938217569,0.253207070698 &
            ,0.022739754217,-2.473157851405,-0.557832588808,0.348766450995,-0.224175436527,0.251301286317,0.034243938849,0.350934479041,0.127040424998,-1.212129539398,-0.549552012437,0.067644256862 &
            ,-0.001395159498,0.198432648163,-0.435919465716,-0.080650280231,0.062504517905,1.080143774048,-0.875040089320,0.611051044192,0.437899368316,0.306118570550,-0.235529661564,-0.089004374406 &
            ,-0.017541444857,-0.468171146182,-0.671778906538,0.240951431633,-0.383824512678,0.319590430943,-0.031917561737,-0.480341858126,-0.030486220216,2.789573674013,0.157595750550,-0.408994473011 &
            ,-0.012839121620,-0.097257169702,0.306468707846,-0.015925668654,-0.125261173652,-0.022488396408,0.645219795901,-1.007748579980,0.118942234544,-0.206097973914,-0.269234778446,-0.928372288734 &
            ,-0.374314886831,2.056526813250,0.556076469707,-0.593490823592,-0.156870030704,0.195619510573,0.381300294599,0.211147607576,0.023083775725,1.695301153690,0.254107264158,-0.992827895428 &
            ,-0.258309982921,-0.017693494101,0.636802069697,0.395821955337,-0.067953509682,-0.562781964647,0.784962111958,-0.577005325558,0.099616308174,0.228522055385,-0.190562864443,-0.219395722984 &
            ,0.058685399329,1.190557019915,-0.413247655671,-0.377478777746,0.269314436747,-0.089944674233,0.360124743261,-0.213086661424,-0.281132417491,-1.010224503815,0.946663518201,-0.428886663916 &
            ,-0.499843717577,-0.010984960381,-0.266925639136,0.124218671430,0.229534826596,-1.051204437164,-0.551283372227,0.557124934042,0.073217021002,0.196803540113,-0.239265003667,-0.045155194488 &
            ,0.173383735545,-0.810850310838,-0.393582768854,0.611199914564,0.099267235655,0.073224988372,0.192825588843,-0.033804749954,-0.060690712614,-0.405053930553,0.388900474948,0.035399569887 &
            ,-0.167007064016,-0.058328679198,0.012043431455,-0.244783244670,-0.089757026730,0.429729428591,0.232935466232,-0.508854808206,-0.014824991160,-0.019823409370,0.046021643964,0.122697741428 &
            ,0.019271017705,-0.263468762597,0.001476683256,0.078679813414,-0.061430016490,0.042501120693,-0.049040956296,0.005673347320,0.051981296338,-0.222632850140,-0.095723010632,0.120267985489 &
            ,-0.124742350925,0.071932737121,0.021770812971,0.043863767108,0.075699821754,0.176416521958,-0.002417126531,0.033653423848,-0.075302507174,0.026281403607,0.048820251307,-0.005677985873 &
            ,0.002430846799,0.273559814601,0.076562815014,-0.114790251082,-0.021858811463,0.017591669257,-0.000542691814,-0.035796186905,0.000612938764,0.175056844947,0.028308134729,0.009609124908 &
            ,-0.003281158968,-0.009177069204,0.015310057446,-0.047740011494,-0.023044784526,0.058702675995,0.099822343069,-0.003133628574,0.007337156372,0.000995746567,-0.023060207083,0.014276867448 &
            ,0.041243758366,0.261657925177,-0.015315651085,0.044420926211,-0.094257039478,-0.073051875251,-0.000401758515,-0.074156548734,-0.052873052771,-0.101074563247,0.118015934081,-0.003812941542 &
            /),(/8,126/))
real, dimension(2,8) :: hidden1 = &
  Reshape((/0.00088113,4.6178 &
            ,-16.414,-4.8992,28.3811,2.5177 &
            ,-17.2475,-3.0886 &
            ,13.2245,8.7686 &
            ,24.7842,18.7023 &
            ,-12.4773,0.34215 &
            ,6.6164,-0.77364 &
            /),(/2,8/))
real, dimension(1,2) :: hidden2 = &
  Reshape((/-1.6395,-1.3732/),(/1,2/))
real, dimension(8) :: bias1 = &
  (/-1.7875,0.79116,-3.8187,-0.04575,-2.5636,-15.3817,-5.3329,10.3898/)
real, dimension(2) :: bias2 = &
  (/-2.8544,-3.2492/)
real, dimension(1) :: bias3 = &
  (/3.1791/)
contains
subroutine fnet_antioch_initall()
end subroutine fnet_antioch_initall
subroutine fnet_antioch_engine(inarray, outarray, init)
  intrinsic MatMul, Size
  real, dimension(:), intent(in) :: inarray
  real, dimension(:), intent(inout) :: outarray
  real, dimension(126) :: inarray2
  real (kind=8), dimension(8) :: layer1
  real (kind=8), dimension(2) :: layer2
  real (kind=8), dimension(1) :: layer3
  integer , intent(inout) :: init
  integer :: i, j
  do i = 1, 126
    inarray2(i) = inarray(127-i)
  end do
  layer1 = MatMul(input,inarray2)
  layer1 = layer1 + bias1
  do i = 1, Size(layer1,1)
    layer1(i) = 1.0 / (1.0 + DEXP(-1.0 * layer1(i)))
  end do
  layer2 = MatMul(hidden1,layer1)
  layer2 = layer2 + bias2
  do i = 1, Size(layer2,1)
    layer2(i) = 1.0 / (1.0 + DEXP(-1.0 * layer2(i)))
  end do
  layer3 = MatMul(hidden2,layer2)
  layer3 = layer3 + bias3
  outarray(1) = layer3(1)
end subroutine fnet_antioch_engine
end module fnet_antioch
