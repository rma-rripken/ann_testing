module fnet_CO

! a = 4.3266e-005
! b = 0.13898

intrinsic Reshape
real, dimension(8,126) :: input = &
  Reshape((/0.118931429892,0.124958284507,0.965606820822,0.123687156605,0.120879194907,0.196187851730,-0.114159215418,-0.082930112127,-0.006743851470,-0.120313924256,-0.605767738330,-0.065003763986 &
            ,0.115703155022,-0.101471882646,0.187425363485,0.094813013047,0.035184301207,-0.047776069102,-0.034527639091,0.013764614778,0.094612801526,-0.157286683416,0.202147720694,0.101539258014 &
            ,0.189256658490,0.041266838947,-0.563229365859,0.156595745822,-0.019508018267,-0.894201655712,0.093827000457,-0.006884058849,0.046791464402,0.034933760938,-0.237895222790,-0.013600867600 &
            ,0.172794859950,1.336673143001,0.148624728425,-0.003004533251,-0.170641577888,0.015819387592,0.609124418716,-0.087428916959,-0.254187408211,3.812938840531,-0.370704232145,-0.108849231163 &
            ,-0.069471535954,0.063505121377,4.144667096618,-0.037461725657,-0.151571607888,1.752421262823,-0.319787348424,-0.156925848945,0.280277732475,-0.045308974562,-5.108988877728,0.096456510509 &
            ,0.810118791272,-1.980155719830,1.064172613050,0.341300361938,-0.098688267281,-0.042059473489,10.209509917459,-0.013606067996,-1.200858488549,1.124298270575,-1.533534720682,-0.613725647237 &
            ,-0.060349110794,-0.133829750829,-5.130564233302,-0.025555249551,0.453432568590,1.842847585684,0.479261474477,0.358440009558,0.196006973157,0.138647473410,-1.157148014446,0.119371047950 &
            ,0.292588015251,0.134859358954,0.623762281282,0.029498431763,0.155274075555,0.001791472489,-1.717098793751,0.072495360484,0.210769834437,-0.085551529085,0.441013999260,0.089733696285 &
            ,-0.341154315004,-0.107686841664,-1.077436158732,-0.157685487823,-0.117781338665,-0.471351152928,-0.546261692859,0.084385521846,-0.396000280532,-0.172542415845,-0.223099255973,-0.175794776941 &
            ,-0.539161188555,-0.074452945985,-0.926570499444,-0.002994259612,-0.146742089064,-0.202471147037,1.409829005178,-0.113298429373,-0.016511172145,0.027436827586,-0.129709374161,0.149652973942 &
            ,0.421877191165,0.189542858992,1.658249648613,0.259315255001,0.081034784027,-0.157497113144,0.489615876385,-0.186490579466,0.077699786687,0.143308116275,1.534080716815,0.099796602375 &
            ,0.026936875745,-0.539800363008,0.386328711148,-0.009470356778,0.136191460508,-0.000649701701,0.867757642594,0.090901572374,-0.201377648736,0.682424987729,-0.608397189154,-0.230347453695 &
            ,-0.055217540745,0.449099627404,-5.922096651311,0.094917638748,-0.301554988319,-2.892002612341,1.259108183854,-0.161638186243,1.253213383367,-0.560495087196,-5.411539086979,0.337125510395 &
            ,1.094136912446,-1.864720823003,0.251016710389,0.120961697387,-1.156226732077,0.602565414354,-3.522318195242,-0.364719585848,1.193375550201,-0.402313270383,0.867295181596,0.819689797396 &
            ,0.823930689410,0.084876876058,-2.557227357386,0.494231065000,-1.368922818283,6.255971320000,-1.507554286629,-0.824258093166,-1.091386709369,0.809527303719,1.449302385373,-0.299752751389 &
            ,1.303431020248,-2.178528044345,-0.172137382902,0.171588769134,0.211921570301,-0.736660841180,-0.899448519601,-0.348679774576,-0.387228686422,3.464731024748,-1.340239172679,-0.379195491144 &
            ,0.867613076295,1.489308327560,-1.919501663541,1.202271284159,0.041786366961,-0.816388343204,-0.352578807717,-0.472397492388,0.473837820621,-0.242446007998,-1.149633273361,0.053981517433 &
            ,1.091946431942,-0.639414281988,2.292330354777,0.418646882707,0.381226472114,0.983914876299,0.456502201111,0.336268862286,2.408218239191,0.977449243336,3.697240102169,1.322179588528 &
            ,-0.264387885884,1.314176674443,4.778519860879,-0.009118236676,-0.145135807217,0.229406155647,-1.178701778950,-0.629706517339,-0.138077314034,0.088313505573,3.879122410345,-0.123484205535 &
            ,-0.247509887814,1.728415709761,-0.382056440788,-0.199595415776,0.325218804308,0.233337860283,1.401541210693,0.076679693370,0.284234830929,-1.452627543457,0.281326707288,-0.326380678885 &
            ,0.560493848629,-0.164319003698,1.244323345205,0.170092485266,0.613786684959,-3.001965276742,1.219807048510,0.133293984875,0.009552166487,-0.268563168341,0.469879504076,-0.185539835037 &
            ,0.372336522907,-1.764980449837,0.298823274372,0.084900355667,0.064619156135,0.568428434156,1.414940171442,0.085321354128,-0.622817463344,2.991727118379,-1.190972432879,-0.816110739701 &
            ,-0.489033300774,0.086973146909,1.808056290248,-0.266010913362,-1.400969970058,2.788855938741,-0.986613513769,-0.337238348438,0.122475118824,0.163480517058,0.341487088353,0.092029000486 &
            ,-0.524175152898,0.761389522210,-0.304243087631,-0.314636558682,-0.121513683561,0.334255677372,-1.135221814312,-0.034478009563,0.203308009798,-0.199215033206,-0.515172622795,-0.139841205948 &
            ,0.856984442590,-0.657273818896,1.082128475698,0.572627786513,-0.991424653679,3.432864663606,-0.605932289692,-0.116761253743,-0.914885460671,0.021243157886,2.182858684516,-0.415429995514 &
            ,0.065653884341,4.805418883683,-1.222392320020,-0.105835615527,0.548910736658,-0.195813591918,3.708510870497,0.534056449885,-0.946312439422,5.206058455402,-1.666775230446,-0.661619924310 &
            ,-1.353564277988,0.693165913424,2.659146927736,-1.239422545063,0.420698861100,4.101281997365,-0.787497335748,-0.513968975518,1.656576625066,0.951587493018,3.352835210999,1.633177234095 &
            ,-1.195928632967,0.074024346374,0.727304389636,-0.557527939998,0.429815202251,1.145676720391,-1.207817343899,0.295250754081,-0.140966119635,-3.156662296996,1.109603589781,-0.567729826917 &
            ,1.984510490351,-0.014593475751,-0.875836632743,1.381752735148,-0.969228732146,-1.001267543310,1.953943239482,0.056602437339,-0.137976113017,0.150715832986,4.960667063436,-0.451233647289 &
            ,1.202639953915,-1.374655925831,3.454485102254,0.964603968538,-1.368670354893,-1.243512348582,1.608937506606,-0.421487867811,-1.970082763765,0.046436707761,-3.803152545985,-0.150838012141 &
            ,-3.125906929124,-0.705821058339,2.294701851235,-2.342721370290,-0.350677280448,2.459959851363,-4.889991540873,-0.652980260476,-0.456014099842,0.016858148360,0.736297205926,-0.235144213919 &
            ,-0.315165088316,-0.074745985000,-1.159924186959,-0.340429139247,0.376486403076,0.061055312330,-3.332691689223,0.250932375999,0.529406130367,0.515685211559,0.338947448981,0.099962536173 &
            ,-0.281050120784,-0.231348958788,-1.127320246365,-0.200258020884,0.344106577605,0.638461699457,-0.009531308028,0.263849384946,-0.178159497309,-0.035872565941,-1.358913938920,-0.136314023929 &
            ,0.071193330290,-0.574274339224,-0.090945279953,0.037409995009,-0.422652980558,-0.034248392474,3.196861849747,-0.274432182779,-0.713157847306,-0.015234804163,-1.107046269691,-0.389540288251 &
            ,-0.749098476231,-0.368472246667,3.227705864865,-0.576036556284,-0.913526963312,0.726963773159,-1.421982146747,-0.203231267710,0.200164317353,0.560747449591,-4.539582573874,0.300852813085 &
            ,0.859867747261,0.163787230588,0.771865552711,0.175116553805,-0.208658660002,0.254750777728,0.381728592793,-0.349343329134,0.755167391476,0.719315099994,0.482629918368,0.002187769104 &
            ,1.364645749918,0.271855434373,-1.596975795215,0.554599955886,0.701018532411,1.269460716660,2.669744695988,-0.307846291199,-1.335922414919,0.683402964654,-1.792919757002,-0.362651451149 &
            ,1.345509217823,1.443188230476,3.382826228090,1.562820906076,0.014151563528,-1.117455412840,-2.324563612305,-0.239098984655,2.346526580093,1.219770534814,-4.415167289335,-0.153722316977 &
            ,-0.767898084148,2.281126617127,-1.660440211894,0.139083586589,-0.990496501574,3.304694767254,-0.518416030543,-0.728123675657,2.080708918972,-1.120515303034,-1.106559894187,0.513860808186 &
            ,0.156120785514,4.526293636430,-0.651589985803,-0.869437694480,2.136225245614,-0.458857539406,-1.073498316838,0.807319173890,0.604575646914,2.753342179576,-0.850977586160,-2.599724997171 &
            ,-0.584925217036,-1.848696312856,-1.133748291718,-1.303130195943,-0.368137867614,2.051988056934,4.597407643583,1.211951538063,0.874375043316,-2.465415062039,-1.342391358732,0.600372312273 &
            ,-0.215496200143,1.721168164220,1.255462678543,1.135744222916,3.599213502295,-2.183911715908,-1.062227923354,2.419137295552,-0.742435667498,-0.001357306520,1.468309811584,0.176405246965 &
            ,-1.753700102943,-3.245217611319,-0.762623359594,-0.428166625671,0.604593531330,-1.004780561412,0.245923003393,-1.431395138320,-3.068108756968,1.826655681432,-0.305992523025,0.842280383391 &
            ,-0.859045119874,-0.883759649157,-0.640517799338,0.858553830175,-0.106974919471,0.958212453688,-0.124570064827,0.149153340881,-1.123547546567,-0.401150542526,-1.894161376072,-0.449582784061 &
            ,0.420805811982,-0.207393930051,-0.217599680991,1.315301207539,-1.192462364609,-0.146687156205,-1.945214603529,-2.595124007211,0.194373541996,1.751501872165,0.061844678883,0.558349143421 &
            ,-0.874089428661,-0.322059422246,-2.469163161043,-2.277408421212,-0.936482816298,2.785243275411,0.083610200196,0.382500805262,-0.628271698368,-0.674948976215,-3.133663360914,-0.885230388635 &
            ,-2.485191704053,1.474431724866,0.096646305747,0.257437813673,-0.250554838300,-0.589405433459,-3.047309911689,-0.011514628930,-2.588588713429,-0.837783132513,0.581969719556,0.053934628151 &
            ,-0.152086531203,-0.856143464324,-3.142812906647,1.257694239786,0.204781495404,-4.076035698212,0.969439881659,-1.902406294684,-0.394221301588,-0.100165473709,-3.104327193005,0.843336679664 &
            ,-0.221176849282,0.352838608090,-1.393070250234,0.043355761426,-0.483193249432,-10.952489545718,0.576141075921,-0.026857144855,0.435713895723,-1.435781959503,-0.746015542064,-0.176852112349 &
            ,-0.597092056541,-0.570289278837,-2.039356120905,0.066584647414,0.937102742577,3.278253436257,0.458677293151,1.185203116290,5.221464291205,0.539567841185,2.086126158193,-0.271523037317 &
            ,-0.429713787556,-2.563602877467,1.063001445283,-0.698344327644,-3.627431503837,-1.095003524157,1.553937184942,0.612812156783,-1.139761591415,2.452863472105,1.614389721697,0.107202037404 &
            ,0.002996176355,-0.417123743164,2.861496298982,-1.050147696972,0.160356436767,3.324642462538,1.116899467716,0.395861661924,-1.236668205607,-0.171922476553,2.146008182895,-5.543614218480 &
            ,-3.324835917000,2.990022870297,1.895926426566,-0.326171068096,2.375270025439,0.824838630221,-3.645150821648,-3.198610551361,5.191293004653,-5.504449368206,3.333668615710,0.896442397935 &
            ,2.073629057696,1.805305627447,-2.582967893309,-7.402033314138,2.353042575446,-9.653153471524,2.955020464102,1.581253841980,1.018267767973,0.966983320708,4.940089424579,-2.490169215127 &
            ,-3.180635449839,-16.394691970724,0.756059327273,2.969625083487,2.951561646678,-2.537291857572,-0.351311998729,4.545192490661,-3.015820774348,-1.294806422866,-0.429453659494,3.630677438979 &
            ,1.055027619996,-1.621383989614,-0.786116449325,6.861246842369,-1.015240611942,-0.712549405775,-0.561276096270,1.120063081207,0.575862979659,-0.146874294809,1.085749381780,0.542741051425 &
            ,1.056350396095,-1.900645219500,-0.597221564615,1.984881621431,0.184444461625,1.129988088209,-0.999336102712,1.278938270758,2.102199756135,-1.791696633046,-0.274114077990,2.516216837101 &
            ,-0.443165627304,1.679741187699,-2.145388704846,1.042463883184,0.126844638774,-1.944807184404,-0.256709359498,2.415037330338,-1.191816919349,0.165502167214,-0.032903267714,0.562007929104 &
            ,-1.136931546693,-4.220474481709,0.367920638054,0.671999111422,-1.681434989821,0.062003335761,1.619819217034,1.517793888796,0.378718914903,-6.612157510981,0.513859024060,1.117498678975 &
            ,-1.544448586899,-0.284584160882,-2.494241025084,2.750375227818,-0.520623551925,4.909937384160,0.088442462505,1.772221511336,-0.487911764236,-1.962769931238,-9.015501570178,-3.397711966488 &
            ,0.332444637148,-0.068971290748,1.851601946293,0.202429286136,0.267341565149,-2.316047923719,1.151459755747,0.256964370055,-0.486072104210,-0.051931674667,3.236241933819,-0.349249577343 &
            ,-0.688532558074,0.061796502129,-1.347403643233,-0.411221208736,-0.634598776007,-0.105599121154,-1.641720343941,-0.381059965049,-0.331371600293,0.578088815786,-0.451370202339,0.087863888503 &
            ,0.481936625349,0.404915334686,1.574521694275,0.414037592811,-0.175154886851,0.532307053840,-0.011081242039,-0.380381923335,-1.210801879984,-0.225151997031,2.492587936986,-0.694061626141 &
            ,-0.774783601337,-0.178304870074,-1.858311491423,-0.009169287136,0.473544768707,-0.093948694326,-3.728396782519,0.246738542767,0.457479960172,2.392761899740,0.501642237905,0.330769728993 &
            ,-0.210297372306,-0.094619875090,-3.279674986581,-0.059198739125,0.010114845597,1.033760149494,-0.474626034520,0.355910619102,0.086569914243,-0.042850709322,2.168312728616,-0.054891288349 &
            ,-0.481387634116,-1.962091136146,0.587047699735,0.138358047864,0.677351610525,0.492971098408,2.891482980188,0.314291451047,1.655595442110,1.052007888147,1.570182258600,0.645233932391 &
            ,-1.010441312656,0.713447485619,-0.151834781731,-0.674654595216,-1.470784484779,-0.864877167720,-0.782986378512,-0.169714735661,0.281107225854,-0.095038161240,1.351908197622,-0.113468630567 &
            ,-0.064900336282,-0.669758645767,-0.128056821950,-0.337907672895,0.485344596038,0.127296437766,0.571524728305,0.168377799127,0.014580719197,-0.745095974145,0.406988890377,-0.175693547101 &
            ,-0.501629735539,0.208709915816,-1.169167362198,-0.337509253698,-0.187629269322,-0.974861301888,-0.406194770308,-0.154503717177,0.316248668427,-0.161341191829,1.300639361785,-0.037493028153 &
            ,-0.185749894728,-0.389803931987,0.484932561383,-0.080725997838,-0.013905234548,-0.214304136373,0.974647899112,-0.168316966126,-0.084055125614,1.440289279492,0.091124724146,0.103762559704 &
            ,-0.144244581161,0.274775946282,0.518937527924,-0.137269241223,0.416991970421,1.178113475443,0.149467355252,0.028208585410,-0.133324431548,0.449940475283,0.609540954087,-0.067934815567 &
            ,0.255297606715,0.281168496149,0.135318557124,-0.094299205198,0.273708683193,0.077384174737,-2.028648337983,0.101050564089,0.746534002115,-0.421451071079,0.505593203341,0.125425352149 &
            ,0.379848786704,0.185009678022,2.577094631316,0.284502836996,0.625126421627,0.592185331525,0.719184450893,0.161369255924,-0.174983962556,-0.011560124513,-2.981551610022,-0.056728142291 &
            ,0.299688091163,-0.350412927596,0.336175230410,0.279803073585,0.288883730412,0.174302003474,2.918244326530,0.175609079546,0.058289048522,0.090928559811,0.119375811194,-0.202248828951 &
            ,-0.088401870081,-0.062348334476,-3.694941915159,-0.158177724088,0.604672097068,-0.461185183860,0.225152441595,0.166222883349,0.059921331313,0.124305409810,-0.641720711933,0.108863554354 &
            ,-0.075593475426,0.684127913974,-0.285264127736,-0.099900901986,0.067317673394,-0.192743199968,-0.695390944324,0.006726121006,-0.170079193034,0.360397388927,-0.318280078952,-0.031298685407 &
            ,-0.385543385650,-0.158767490875,-0.551059515292,-0.224563630976,-0.208135668494,-0.055770865893,-0.297068326408,0.149833909414,0.136641281444,-0.306361953659,3.631330684531,-0.024694630815 &
            ,-0.237390931335,0.645235061641,-0.106416390333,0.049742250962,-0.376322834840,0.239980059287,-1.215354489900,-0.077495959957,-0.728622993351,0.880571726674,-1.079333292306,-0.388812592104 &
            ,-0.102928329693,-0.020895093988,-0.769015227015,-0.099407584886,0.454040502706,-0.713639384840,0.259643605298,0.166570604609,0.089962801623,0.031611922295,0.120325807995,0.061953454543 &
            ,-0.146928183303,0.214805234663,-0.099422051269,-0.089491800021,0.006064949414,-0.027880302802,0.014877780121,-0.000497236555,-0.107090159712,-0.032544193765,-0.100530928572,-0.021998605508 &
            ,0.033435514314,0.019662385683,-0.639590692521,0.039953841586,-0.089947134660,0.040687397653,-0.144907895765,-0.048282702962,-0.038865339978,0.112623647193,-0.352237927793,0.018566807935 &
            ,-0.029763199312,0.088321171864,-0.191252282011,-0.084627340005,-0.060962899728,0.073016055072,-0.463536687205,-0.016897861484,-0.032920243830,0.063145084449,-0.114391002568,-0.054560606256 &
            ,-0.088034804585,0.014114690208,-0.396314185548,-0.030741325453,-0.063045875764,0.272768999810,-0.108945788482,0.012689463536,-0.138962260599,0.025747807910,-0.557454539049,-0.059421787371 &
            ,-0.028743760200,1.122044179737,-0.135370344080,0.030167927734,-0.038953587153,0.005807520456,-0.721275926926,-0.029236533207,0.099537545541,-0.449257514252,0.061645115361,0.039491736416 &
            /),(/8,126/))
real, dimension(2,8) :: hidden1 = &
  Reshape((/4.8337,6.8437 &
            ,1.3224,7.8554,6.2925,-0.49776 &
            ,-9.4427,-8.7105 &
            ,0.49761,-4.6306 &
            ,-4.9262,-6.5074 &
            ,0.783,-6.1292 &
            ,-0.69727,9.1807 &
            /),(/2,8/))
real, dimension(1,2) :: hidden2 = &
  Reshape((/3.0285,8.4878/),(/1,2/))
real, dimension(8) :: bias1 = &
  (/-0.16734,1.1975,4.3017,-4.1693,0.93856,-7.1351,2.5262,2.546/)
real, dimension(2) :: bias2 = &
  (/-4.8108,-0.73451/)
real, dimension(1) :: bias3 = &
  (/0.14767/)
contains
subroutine fnet_CO_initall()
end subroutine fnet_CO_initall
subroutine fnet_CO_engine(inarray, outarray, init)
  intrinsic MatMul, Size
  real, dimension(:), intent(in) :: inarray
  real, dimension(:), intent(inout) :: outarray
  real, dimension(126) :: inarray2
  real (kind=8), dimension(8) :: layer1
  real (kind=8), dimension(2) :: layer2
  real (kind=8), dimension(1) :: layer3
  integer , intent(inout) :: init
  integer :: i, j
  do i = 1, 126
    inarray2(i) = inarray(127-i)
  end do
  layer1 = MatMul(input,inarray2)
  layer1 = layer1 + bias1
  do i = 1, Size(layer1,1)
    layer1(i) = 1.0 / (1.0 + DEXP(-1.0 * layer1(i)))
  end do
  layer2 = MatMul(hidden1,layer1)
  layer2 = layer2 + bias2
  do i = 1, Size(layer2,1)
    layer2(i) = 1.0 / (1.0 + DEXP(-1.0 * layer2(i)))
  end do
  layer3 = MatMul(hidden2,layer2)
  layer3 = layer3 + bias3
  outarray(1) = layer3(1)
end subroutine fnet_CO_engine
end module fnet_CO
