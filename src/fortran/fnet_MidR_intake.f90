module fnet_MidR_intake

! a = 0.00034476
! b = 0.41063

intrinsic Reshape
real, dimension(8,126) :: input = &
  Reshape((/0.031211862283,-0.123123491393,0.023959904014,-0.054740203249,0.077615879720,0.157081704983,0.043116424008,0.501295231854,-0.797772453882,0.180981227944,-0.206451898648,0.212168219245 &
            ,-0.487233000843,-0.099755493107,0.073990615602,1.331134807565,0.965423176522,0.054287289440,0.097902629487,-0.092614108939,0.037307911875,-0.101979947058,-0.021184774168,-1.936281089486 &
            ,0.199593925958,-0.353543343233,1.239922680913,-0.205410532194,0.618595509764,0.155068446293,-0.074447015152,-1.620646175582,-0.606220909423,0.329143164936,-0.675216366287,0.240493774046 &
            ,-0.280518993711,-0.141621137012,0.190441805118,1.057376774940,0.604021112342,-0.010125753774,0.368848345804,-0.139255999713,-0.031173059871,-0.000047155830,0.018210064477,5.842709214014 &
            ,0.011663315207,-0.129735710150,0.013959579285,-0.074670994613,-0.142056150433,0.084886011525,-0.063702660928,6.358024213478,-0.327465333664,0.350588579015,0.381176935123,0.488980534517 &
            ,-0.578136495005,-0.211402320736,0.387883868189,9.667186505852,1.028227783491,-0.297371770772,0.411751100892,-0.416783289371,-0.213212768420,0.200122912374,-0.217017419300,3.595076460645 &
            ,0.712626042734,-0.130400964831,0.148183586836,-0.518845011769,0.513639494199,0.185038287571,-0.083494965237,2.460332926167,0.111523372329,-0.034296289494,0.101652367653,-0.029667635710 &
            ,0.132990387677,0.012503802341,-0.005461072158,0.470800374650,0.064870077910,0.019968892207,0.049138455555,-0.014987516427,-0.117944987415,0.010836220410,-0.013280535930,-0.286110617786 &
            ,-0.099907617436,-0.010937186202,0.025392699352,0.034858046925,0.026505390923,0.005758681674,0.020891289044,0.294231655601,-0.135304455417,-0.042392752654,0.065870298418,0.047863549611 &
            ,0.070511205406,0.031706234811,0.021438700786,1.053194363771,-0.246184725203,0.047290356600,-0.048459902486,0.082507951117,-0.023163829483,-0.031488926200,0.036793520908,3.797739570952 &
            ,0.001897804036,0.053482519508,0.090130914730,0.102544050035,-0.254677497804,-0.000131446056,0.047479863946,1.708041627795,0.072698524047,0.027557565410,0.230999957564,0.033170809281 &
            ,-0.014339667514,-0.076456118543,0.037781405072,6.946843544071,0.224259890820,-0.272976660998,-0.084294108009,-0.130468621908,-0.150718765077,0.159424770185,-0.221880295914,17.545297079335 &
            ,-2.160300190661,-0.322818905745,-0.410416558060,0.365568950752,1.659316811858,-0.346139599910,-0.226944766100,-11.064512752897,1.114002183357,0.784105101131,0.859720255300,0.102619404761 &
            ,-1.650898875002,-0.556366669607,0.359763580312,2.914943654245,4.008547578857,-0.376906084825,-6.095626839750,-0.172560533847,-1.918196468970,-0.419662073638,-1.117163834836,3.047879672316 &
            ,2.247081785070,1.211055429568,-9.011292123394,0.521371192435,-0.325852713735,-0.025512982102,0.064711243067,-7.313033992085,2.223405608080,-0.071299380327,3.755307579432,-0.549908310218 &
            ,2.589742966885,0.006304675831,0.228234493606,-2.882335416687,1.404048030979,0.332701808335,-2.355893216805,-0.731771668763,4.050341557082,0.594770001490,0.750655987544,4.801223195667 &
            ,0.438445624345,0.296101552532,1.052372886281,0.142322740755,2.904332585271,1.450258897006,1.383686498901,5.105664946509,-4.490505613532,-0.881562847620,6.357306868586,0.584961812204 &
            ,0.260508149013,1.192758127020,0.567646350605,2.047345521516,-6.244392021001,2.541580024759,-8.832842073575,1.293821243366,1.259105694367,0.572313386678,1.822934365541,12.338617650675 &
            ,3.047364854177,0.376336978898,-3.313715066625,0.015914743540,2.028309904620,0.529597640377,1.133055058502,4.594430431527,0.464898597062,-0.298355944096,0.917481148947,-0.129453422526 &
            ,-0.524019991450,0.184837610847,-0.059900989169,-0.645934247651,0.113560715021,0.159106730953,-0.702522877580,-0.001695159129,-0.253601979667,-0.047441348791,0.067193803872,1.065380489873 &
            ,0.539752762312,0.297043863203,-0.500203558917,-0.070912753049,-0.487501836446,0.008074065070,0.141018142510,1.161884900322,0.282263001696,0.116597302564,-1.168440429714,-0.014679129130 &
            ,-0.337218562811,-0.046182156213,-0.102001700680,1.148592233129,0.384669742110,-0.027107580932,-0.602708832935,-0.088549281487,-0.191111655475,0.052534028325,0.027922680208,0.819623238613 &
            ,0.818107227067,-0.629410972887,-0.847806048174,-0.165071835317,-0.024088594918,0.151065772340,-0.446725804463,1.003219606208,0.237572317030,-0.243439871120,0.076222917236,-0.137882453708 &
            ,0.281918570661,0.295762284900,0.071963762330,1.201055824311,0.439569033577,-0.328374932722,-1.411115874110,-0.130271442646,0.201340104443,-0.037273753459,-0.268316742112,0.109378413990 &
            ,-0.533875279442,0.079400457985,0.985123721584,0.425912382064,0.090447236348,-0.309436800940,0.290550879806,-7.293067730275,3.280877677074,0.821798644557,-1.443154541335,-0.246690759247 &
            ,0.210562389414,-0.721035820953,0.233169611016,-2.533337111843,1.817829600268,-1.381694988434,2.136607521052,-0.004822423222,0.587270822765,-0.364235031082,-0.707378304177,-11.602341537017 &
            ,-3.731158885869,-1.022842896582,-2.580627258354,0.510819093603,0.900336904712,0.157849591318,-0.676677341811,-11.968378405772,-2.775723415869,-1.760763475541,-0.013474568691,0.335353427164 &
            ,1.827517752694,0.273280209485,-0.989115480979,-12.224969448386,-7.805679869460,-1.585554261238,-3.588266340834,0.555566848285,2.274579872094,1.035983520852,-0.936461886228,-11.843802141347 &
            ,-7.837336713642,-1.188384959628,-1.694898491580,0.919969866293,2.618671765735,0.790222411361,-0.373514852812,-15.222185575372,-6.339775618621,0.874823509398,-5.462204502251,0.710485176384 &
            ,2.186644501765,0.350825289070,0.369159938429,-9.155739506482,4.137705895547,0.231363543067,-3.132477999228,-0.895276278842,0.276655777416,-0.052700938149,-0.639289750786,-20.188434228318 &
            ,1.580688428310,0.949381183022,-6.126778943315,-0.433762911540,-1.141901484742,0.115829847690,-0.239389948672,-20.461750401968,0.331458730089,-0.285801541898,-0.252161985333,-0.170662319973 &
            ,0.220645889853,0.150837499925,-0.204047118825,-0.745068810394,0.924718893009,0.308579320834,-0.293078916502,-0.142762345007,-0.043298791929,-0.090842669837,0.101205136583,-1.170264936127 &
            ,0.532936610898,0.063213557741,-0.607218576548,-0.060534364305,-0.490997618409,-0.039709339299,-0.110601674781,-1.522211102707,0.656211705457,0.050641639400,0.086453800208,-0.050943171289 &
            ,0.394755942560,-0.077150519046,0.088703066239,-0.172456676632,0.788162759025,0.003272702924,-0.365115731195,-0.180626025873,-0.279973901521,0.066275545493,-0.118558167757,-2.247683158253 &
            ,0.884337411496,0.266369370248,-0.528245817772,-0.268336327935,-0.328785580252,0.046674886950,0.018988956499,0.852252238476,-0.190118418010,-0.174272265922,-0.000029255805,0.112590917048 &
            ,0.604026638884,-0.078312824972,-0.035670044056,-1.964430280559,0.840312363886,0.250489773614,-0.131046178292,-0.099617045431,0.077156885991,-0.097416366050,0.148724111735,0.297293087446 &
            ,6.914767775525,-3.127078545472,25.559443862997,0.094369538130,-13.295281990583,-2.300384937618,-1.943349953153,-16.047693647451,5.143622308159,2.167214091642,-10.215663597811,0.148401773519 &
            ,7.354850883569,-2.415006936836,-0.138491882464,-13.034670591147,-11.610850674778,-0.245197326909,-8.300692688125,2.282634829512,-9.512519969175,2.247568626286,-0.191162963443,-10.036747845603 &
            ,-11.202260984200,-3.409321251718,5.958226840267,1.583909986976,-11.362434353255,4.084224605996,-0.538253255470,-11.801540522163,-1.494144476354,1.605830379740,4.480299902857,-1.387257746568 &
            ,2.429064343861,-9.886281696105,-0.149198733829,-23.668128527364,6.994745498961,3.550596305348,0.942395809553,0.682262866601,0.159528672440,-6.409725914048,3.300361044466,-28.526597978597 &
            ,-11.126935174039,-4.501216933500,8.629990316842,0.015211768959,-5.861764098476,4.866754617515,-0.809459174763,-10.743042035705,-14.393198289204,11.803825191085,4.549527180544,5.730911685406 &
            ,-9.319854593908,-22.736037006332,3.126289189612,-12.444833829947,7.352572431091,1.591485381617,-22.539570709427,-5.159778449801,19.377500927131,-7.739759832851,-4.328389536023,-26.880248067446 &
            ,10.524250019510,8.247694733140,-7.757027751356,-6.597475886894,-0.878236327581,0.747799065051,-3.346867596926,-12.562213788281,-0.215231860976,-2.866442998322,-1.409667723569,-0.726454080480 &
            ,-2.031150687080,-1.531652728829,-1.168611812059,-1.198716946625,-1.002406907507,5.018201155289,-1.618685195112,1.218680747226,-2.797490689183,-1.372843326106,1.263850414769,0.091948460296 &
            ,1.432113085100,5.372909585376,-3.639907200043,-0.083353285977,-3.609834069106,-1.155558237940,1.111368048974,1.894041921979,6.461146333041,-2.462319275959,-3.058831460167,-1.518924692999 &
            ,-2.828406739248,-0.911858206345,-3.306853448699,4.110580192307,11.273357257847,-0.092540884497,-5.888161359373,-2.958100978116,-4.035420803198,-1.168543422749,-1.512205530323,7.232857564074 &
            ,12.072257412901,5.397640558236,-6.866177607560,-2.469259880849,-2.735772487152,-2.822039704709,0.016909414941,9.697830347520,8.991939697190,0.871405819206,-1.782155391815,1.247077984384 &
            ,6.058995825287,-0.893217034070,1.334144857954,12.047732275025,1.516094931866,-2.600059834122,0.339414414934,-3.413425603191,10.573569250952,2.027096042530,-2.387697489938,15.964125752797 &
            ,-10.097056577706,2.869649560004,-7.069874298236,2.127010847641,1.712833892320,-5.383272017043,1.451331603599,3.216706096703,-2.147099846406,-0.554222803118,4.203012176156,-0.248531319684 &
            ,-0.812870324583,-3.690977341981,0.475503902397,2.611222745125,6.139110501471,-1.561919826185,3.387927035328,-0.623499426359,-0.999716445686,-2.078818458513,-1.017709144417,1.879835226049 &
            ,1.127713290307,2.624415023486,-14.757914850935,-0.044278513527,3.050900235015,-8.667409240332,-0.019533744665,3.489322612802,1.720959082601,0.752033469474,0.780468971565,0.211827083266 &
            ,1.137953772896,-14.246960092952,0.872808483255,5.972098723927,-1.310309697519,-0.032804939548,-0.525713072921,0.621138873042,-1.497826996292,-9.302833471675,0.446918540053,6.044446132421 &
            ,-0.876197772771,-0.487479084104,-1.818325082633,-0.311595476456,0.418268955283,-16.828816000149,-0.620520674106,7.419085046847,-1.816958158171,0.151239867479,3.705769612331,-0.759944417302 &
            ,4.521946722445,-29.002164002592,1.459920465152,3.177453610141,7.602640368573,-0.290357262234,-1.138916429080,-0.085452816970,2.240956577407,-16.764524900172,0.598678390831,1.303808819710 &
            ,19.893720697216,-2.902727407674,-0.268354871028,-2.841520586456,4.897771942711,-5.822774392047,-2.205416936397,-6.132765155343,2.498334473798,0.486358207638,0.083318838564,-0.027491816067 &
            ,0.568958750952,0.160736626066,0.296740592717,-1.881728204425,-1.669562317243,-0.678237697431,-0.402573245118,-0.178221883895,0.075417153729,-0.133564831425,-0.549203802051,-1.670015696225 &
            ,2.062595489860,-1.968530950239,1.003837194342,-1.085763773389,1.183605440394,0.031870282896,-1.458929110128,-1.822322323713,2.991684784181,-0.010239122009,-0.620866716911,-0.373033476422 &
            ,0.306158573896,-0.244051765578,-0.273593468129,-2.634286478281,4.918527677208,-0.238661237112,0.471983916436,-0.899760766759,0.933739472260,0.042433835159,-0.246410659222,-3.486015893686 &
            ,8.255952290229,-3.371202423468,1.213673468171,-1.505076410980,3.574386505811,0.647726855302,-2.364005639154,-4.144042845931,0.092004132798,-0.045206045185,1.371939274082,0.123206772138 &
            ,1.381608701846,0.237330175737,0.489894776506,-4.049963909688,-3.933258750533,0.006964283498,0.260646976381,0.811299341447,-5.919025639959,-0.638196987948,-0.710661853740,-8.792835008139 &
            ,-0.080834410995,0.474429838023,-2.444511134955,-0.204391000878,0.436429128951,0.183272358306,0.017499224331,0.057402739370,1.691002865632,-0.025289297685,0.045390323150,-0.161840655494 &
            ,0.383671335269,0.130463310875,-0.016527813719,4.922855701801,0.394087773563,0.393113020049,-1.380102793960,0.106586672686,-1.227979089815,-0.093060925784,0.104520474001,0.848892725322 &
            ,-0.986334164878,0.860020616670,-1.171039098863,0.436587918421,-0.718998345569,0.258897233637,0.678550358012,-1.434383298718,-0.387076052481,0.242798472517,0.533194179168,0.323282308654 &
            ,-0.529316053973,0.521907357180,0.172128803937,2.763462937152,-0.718641226222,-0.487624431957,2.203930080543,0.200663059833,-0.564730199409,0.621042903745,-0.103528378017,-0.129353476506 &
            ,1.858676952185,1.110089932752,-0.604266510534,0.120064677862,-0.521402386372,0.487535848983,0.780011230288,-3.654356396808,1.082984281838,-0.560413426372,-3.688621411882,-0.288582830594 &
            ,1.684895147040,1.979360100932,-0.399496033814,-1.038691941725,2.762072879919,0.217280913075,2.205942838648,-0.924706891245,2.095349299502,1.335378240078,0.824162227585,4.154004025731 &
            ,1.638908988380,0.026544711039,0.805821493581,-0.562652611537,4.428192195289,0.742300375481,1.645514666851,-3.967800861707,0.483147731255,-0.234868785320,-0.054858398543,-0.078338825641 &
            ,0.652134847665,0.182373859460,0.094228571973,-0.068335823879,-0.136009883345,0.045362205261,0.785699519667,-0.014949526623,0.457991995395,0.017839084205,0.228586121647,-0.528984906855 &
            ,0.282848942258,0.066812300151,-0.234408351409,0.024759258823,0.080319141153,-0.004575639556,0.166241548873,0.505552456241,-0.330956648976,0.049237560007,0.279461782917,0.089153057184 &
            ,0.307608092818,-0.011361872359,0.218698555803,-0.275791826757,-0.405657351512,0.075804062017,0.673974790277,0.087424117854,-0.130077674256,0.006356599142,0.260279737732,0.415712180458 &
            ,-0.267677338158,-0.026650616289,0.297389231046,0.102516774691,-0.162813468435,0.132451286896,0.247903722383,-1.167975865326,-0.427126547718,0.058737825528,0.324189395639,0.089286231343 &
            ,-0.686647404379,0.130852903649,0.266829282871,0.923057458304,0.525760389451,0.224566249761,-0.770361797398,0.050516533949,-0.179906158184,-0.119959427559,0.136936437071,0.665903734048 &
            ,-0.427590949344,-0.084853321379,0.333079527162,-0.172887401499,-0.016116878170,0.215246595848,-0.107663544066,-15.550865416255,-0.597335820721,-0.286678771485,-0.245067998247,-0.161557042686 &
            ,0.323313671591,0.174758561086,-0.269170693363,-18.110685901290,-0.720446571628,-0.116510572972,-0.639467882643,-0.281879682229,0.763897330451,0.232359764855,-0.131179810243,-4.232259804552 &
            ,0.090830851003,-0.162601025487,0.285874000926,-0.174005162890,-0.145093137384,0.103005265441,-0.148029257314,-2.918659101070,0.002423290661,-0.360235123634,-0.031230662330,-0.197996436219 &
            ,0.269398868652,0.131073867340,-0.274516151576,-5.997462770116,-0.641420468289,-0.195329417577,-0.291002712040,-0.017384012315,0.354965188336,-0.035966578681,-0.185913935674,16.329505388922 &
            ,-0.755689713751,-0.332161563206,0.624617603649,0.015374197117,-0.201057991747,0.108001903623,-0.122568691809,2.366967400489,-0.081066755472,-0.106779869793,1.628390568890,-0.042280231961 &
            ,-1.419324336373,0.253643098534,0.329737053000,1.898887731989,-0.317157631686,-0.122507396798,1.117071008369,0.097612899054,-1.099917543363,0.030837666083,0.198483007760,9.363020980602 &
            ,0.154712745632,0.002507877872,0.087038415421,0.068576843788,-2.168302585984,-0.151619576173,-0.155525344051,3.937674361648,0.171708989410,-0.117778682176,0.048947230589,-0.038427556620 &
            ,-0.241078702726,0.043314782648,-0.060345224565,0.340852892002,0.086791043560,-0.040696867025,0.116883353184,-0.007280262621,-0.183996072167,-0.000238063864,-0.023445054726,0.112618939490 &
            ,-0.033812655829,-0.043218130941,0.096587852719,0.016886024224,-0.064094248062,-0.002138418824,-0.021425841830,0.378390416005,0.036767514612,-0.068559007738,0.152574377879,-0.002976908635 &
            ,-0.109940303120,0.018906013061,-0.025975771055,0.241025446856,0.039348182461,0.001417932854,0.059514206498,0.000749514686,-0.123771373579,0.011090135687,0.015846882185,0.461872402321 &
            ,0.087560232132,0.019467105631,0.028547274949,0.007161564425,-0.101455993861,-0.013430109402,0.004498543955,0.572885197010,0.019204707733,0.007827668547,0.019908868796,0.016077538281 &
            ,-0.004014512825,0.001768238382,0.026449220443,-0.151832969182,0.193673489851,-0.137443093980,0.380654852535,-0.025526397507,-0.216489149131,0.052735460271,-0.032459949693,0.882602507778 &
            /),(/8,126/))
real, dimension(2,8) :: hidden1 = &
  Reshape((/-0.64225,2.5477 &
            ,3.7768,-3.9266,0.20368,0.62571 &
            ,-2.3363,19.9596 &
            ,0.92166,-0.79757 &
            ,5.0689,-2.7039 &
            ,-4.033,3.8877 &
            ,-0.094634,9.3681 &
            /),(/2,8/))
real, dimension(1,2) :: hidden2 = &
  Reshape((/2.296,2.3758/),(/1,2/))
real, dimension(8) :: bias1 = &
  (/-6.6726,-1.6607,26.9584,-0.47124,-12.7655,10.8771,-0.35886,-4.3157/)
real, dimension(2) :: bias2 = &
  (/-2.7771,1.0371/)
real, dimension(1) :: bias3 = &
  (/-1.9106/)
contains
subroutine fnet_MidR_intake_initall()
end subroutine fnet_MidR_intake_initall
subroutine fnet_MidR_intake_engine(inarray, outarray, init)
  intrinsic MatMul, Size
  real, dimension(:), intent(in) :: inarray
  real, dimension(:), intent(inout) :: outarray
  real, dimension(126) :: inarray2
  real (kind=8), dimension(8) :: layer1
  real (kind=8), dimension(2) :: layer2
  real (kind=8), dimension(1) :: layer3
  integer , intent(inout) :: init
  integer :: i, j
  do i = 1, 126
    inarray2(i) = inarray(127-i)
  end do
  layer1 = MatMul(input,inarray2)
  layer1 = layer1 + bias1
  do i = 1, Size(layer1,1)
    layer1(i) = 1.0 / (1.0 + DEXP(-1.0 * layer1(i)))
  end do
  layer2 = MatMul(hidden1,layer1)
  layer2 = layer2 + bias2
  do i = 1, Size(layer2,1)
    layer2(i) = 1.0 / (1.0 + DEXP(-1.0 * layer2(i)))
  end do
  layer3 = MatMul(hidden2,layer2)
  layer3 = layer3 + bias3
  outarray(1) = layer3(1)
end subroutine fnet_MidR_intake_engine
end module fnet_MidR_intake
