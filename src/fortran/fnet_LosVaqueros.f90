module fnet_LosVaqueros

! a = 0.00029913
! b = 0.36952

intrinsic Reshape
real, dimension(8,126) :: input = &
  Reshape((/-0.061184783806,-0.046085332913,0.170883049074,0.136311309609,-0.017915110417,0.099181318403,0.210071603236,-0.025526098007,0.007986625423,0.031134762313,-0.262735581910,-0.013048956089 &
            ,-0.034553558671,0.004377906251,-0.262288784627,0.120902797611,0.053229271163,0.061505757011,0.583920948804,-0.036284166346,0.020583682156,-0.037481556685,-0.031777921296,-0.167716001476 &
            ,-0.098758942822,-0.047930821972,-0.132120195811,-0.028731226123,0.015579135651,-0.022263302947,0.167569124967,0.071792941018,-0.030559951463,-0.062559494378,0.279465106247,0.066188012805 &
            ,-0.093270793861,0.063762396472,-0.086255962307,0.143352939191,-0.035837159931,-0.062629697290,0.578595903858,0.249072380531,-0.083570920497,0.196135160741,0.032100165215,-0.027362304678 &
            ,0.060814553114,0.221601519681,-0.379108831409,-0.241987650633,0.100313683730,-0.169206437761,-0.304726418937,-0.059223434968,-0.106441695712,-0.050383864707,0.037879567403,0.085380561126 &
            ,0.027784678824,0.063758344947,0.231915089555,0.082895735054,-0.153451338045,-0.185476269979,0.185167665469,-0.051360317860,0.009840879683,-0.037917457031,0.236384513477,0.319275592217 &
            ,-0.016865171665,0.186773983874,0.489190613591,-0.410213340588,0.170451289200,-0.334827625170,0.027773150099,-0.146322276737,0.047144734289,-0.048199723869,0.508092745317,0.123998934071 &
            ,-0.104860904479,0.096661397660,-0.126776662496,-0.031746749948,0.001163611382,-0.003135714845,-0.056326512879,-0.057701096213,0.008846724158,-0.044139130679,-0.019226393499,0.044914332191 &
            ,-0.000187620167,0.015750372021,-0.076312403454,0.012542002395,-0.013350325307,0.013568974520,-0.038968339709,0.007963689155,0.005219792716,-0.035667903536,0.269837406888,0.010636552892 &
            ,-0.040183975639,0.015055505492,-0.012382824648,0.019726105073,0.014448142112,-0.006529883234,0.133096296738,0.032625501765,-0.018886116531,0.031040758481,-0.035073693130,0.003251698450 &
            ,-0.026117767317,0.053951325011,-0.094449483497,0.053046168842,-0.018135646850,0.044809310285,-0.053099774089,-0.009157022413,-0.003274133038,0.011091545624,-0.030379035029,0.029552665392 &
            ,-0.009463607863,0.023372819998,-0.001727971318,-0.018978371148,-0.011558948700,-0.076919747820,0.065031148025,0.028486374202,-0.024142390474,0.030273368690,0.045293097454,0.066263465591 &
            ,-0.717007093375,-0.596461890742,5.609404368224,0.138458780858,-0.293858557043,0.096265982014,1.668849323536,0.078154214222,0.788956949918,-0.522099026480,1.468359776638,-0.570944019883 &
            ,-0.994349147334,-0.328339717655,-2.368470393034,0.177713920611,-0.779178991477,-0.302566092682,-3.815656232898,1.366053099510,-0.066495468833,1.152950002774,1.102251349294,1.239134776778 &
            ,0.285369873411,0.188635518119,-1.300043818478,-0.688220296182,0.111555485468,-0.360880925241,-1.210204460712,0.916254155377,-0.078452959864,-0.084224114152,2.591924886754,-0.058217331200 &
            ,0.252754632938,-0.392941022305,1.547543814767,-1.317165932827,-0.574243440078,0.698157413512,1.004425136690,0.288513590405,-0.254422248282,0.263029964911,0.507414890924,-0.465907950788 &
            ,0.059888306417,-0.355219621573,-0.083279865554,-1.132967322449,-0.201772339762,-0.872274378943,0.769391286986,-0.001547770891,0.063424175862,0.644700271233,1.127229050918,0.008302463186 &
            ,-0.339642746134,-0.263768425048,-0.100920973982,-1.438306772239,-0.431069642362,0.569357296142,-1.332850757002,-0.276955312696,-0.078707157186,-0.512076339882,-0.566915875744,0.195535658534 &
            ,-0.915350510319,-0.227304178945,0.563568925059,-0.443756687786,-0.251986337270,-0.473821602269,2.726643211898,-0.836190412961,-0.176823795328,0.159028733898,-0.289575570811,-0.069927435384 &
            ,0.122086694916,-0.056805121070,0.558406945007,-0.206562262719,-0.094110875017,0.121510597530,-0.237216726581,0.216736954373,-0.033212363425,0.174551273048,0.040354876402,-0.084967546628 &
            ,-0.083243781150,0.139034597277,0.863817570501,-0.012747395542,0.021315152982,-0.003740127737,0.005456793374,-0.091177430367,-0.013431710537,0.233074737959,0.888570363071,-0.005045173642 &
            ,0.007571894201,-0.006757222820,-0.281938381521,-0.135176013822,-0.113922299349,0.047033387975,0.476729071661,-0.190165815572,0.012530982416,-0.121139778665,0.203723174072,-0.062625788609 &
            ,0.012163199549,-0.001995231751,0.487884959667,-0.343532618786,0.111544765721,-0.241303881882,0.201941473701,-0.083249318641,0.021228834146,0.037014254801,-0.047837094716,-0.432980782197 &
            ,0.119916793922,-0.271022138771,0.056075986165,0.036927906248,-0.237715257442,-0.217397297219,-0.090099172330,0.051309925672,-0.246648107293,0.163843525701,0.069015869472,0.422914380789 &
            ,0.273191142578,-0.132706458339,3.748986880456,-0.009842460738,-0.200591709070,0.042737419181,-0.747794518408,-0.006206546701,-0.339300358510,-0.338180876782,6.605927026077,0.527866513932 &
            ,-0.531480749144,0.546101533931,0.788722784689,-0.124317054080,-0.500775124590,-0.732513273388,6.182732457518,0.494056027845,-0.604577942162,0.534813026232,0.710366104555,0.461493758109 &
            ,-0.200863172047,0.017699051270,0.644303968562,0.037880691254,-0.169667124711,0.142433730018,0.169419437300,0.049825249982,-0.450977082046,-0.428526502286,2.532159626362,-0.065671598593 &
            ,-0.076919750282,0.005630759930,0.221229507744,1.091239069457,0.026343892825,0.284737433828,-6.274808045168,-0.471040992242,0.565982894547,-0.396960229427,-0.329061819961,0.723617035506 &
            ,0.329280780587,-0.142285398798,-4.062422697832,-0.829422578122,0.545034406427,-0.731934332241,-1.245913247840,1.309231598749,0.698456741937,0.339672024252,-4.007481058020,-1.143417593088 &
            ,0.727805894334,-1.003400558757,-1.193952884153,0.376407905286,-0.446533319588,-0.900595274777,5.313048825140,-0.125794960026,-0.421285305470,-0.114010107718,0.965915966575,0.438747159425 &
            ,-0.065765665606,-0.257412085824,4.588870200715,0.099711334600,-0.506162888750,0.060122427458,0.486485858011,-0.736164072172,-0.105551411338,-0.085913991602,0.176480711200,0.183065541806 &
            ,-0.082633643049,0.148577477727,0.214678702413,0.043802794931,0.000572482448,-0.121215331114,0.974223252268,0.042148206246,-0.175360030673,0.043246381657,-0.035748626812,-0.024661844838 &
            ,-0.121708161956,-0.102652273037,0.946598565268,0.056034111250,-0.038076977922,0.039512262058,0.357924210552,-0.029049061701,-0.049999732541,-0.063544097019,1.085297576126,0.068815841310 &
            ,-0.171824682414,0.085833909841,-0.011297304383,-0.070196756186,-0.097693945668,-0.069872329305,0.389226179787,0.042290055821,0.002693752048,0.023990766850,0.284212990876,0.001144423655 &
            ,-0.220587787191,-0.118651325660,0.787227177341,0.341186148417,-0.139418115834,0.236872775165,0.263922876416,0.101747030593,0.161611503998,0.104840355329,-0.240721405923,-0.183908186096 &
            ,0.076322570871,-0.101546220418,-0.083035880010,-0.191332823211,-0.154534407714,-0.095734531808,1.565656793396,0.057435822480,-0.113603797222,0.042713999908,0.156836525927,0.085637006894 &
            ,-0.975480701211,1.529463414250,-2.279687267245,0.160572685191,2.090700035978,0.162244301545,3.889068098536,2.264302347842,0.114943718101,-0.990963541676,1.793146874911,0.477667390099 &
            ,-1.191704314016,0.256865287070,1.849292231806,-7.224529464195,1.535177940369,-0.526360659437,4.181779747926,-1.285321487183,0.606756682151,-0.406936192324,1.476776877706,-0.071553549743 &
            ,0.186359517962,0.185553952520,-2.046679848050,-1.019844568445,0.551366256667,-0.847365232762,0.600568847083,-3.800163214634,-1.951949552868,-2.765255891962,-5.684552046108,0.390322553516 &
            ,-3.078217757383,0.166565275199,-6.398548384224,-2.060509341512,0.148810386158,3.052544537840,-0.131524266935,-1.222667321050,2.633734734709,-0.106566523766,-0.519334649242,-1.899836315901 &
            ,-1.739669559208,-1.242102629793,-1.031996913789,1.419420442119,1.063480081604,1.827647559488,2.237693101985,3.396073735504,1.073121384026,0.893921277966,1.014209175600,-1.441850740781 &
            ,2.395274914768,-0.831213533730,-0.278736302609,-3.305818619796,1.117343350940,3.915148410036,-2.002766891979,-1.713958946120,8.214967156770,1.483323249768,-0.192086294627,3.772710868042 &
            ,2.352142305144,4.614497288466,-2.599394138414,-1.446371311408,7.944630034995,-0.928705508207,0.578113136601,4.584055960371,1.599898648980,-2.495198892523,-0.983180851590,-1.421788498878 &
            ,-1.720920398942,-0.910668383231,-2.091062617512,1.523101957205,0.547973166865,-1.506578340352,-0.091038984029,-1.086098910945,-0.343849946933,0.396450129439,-2.190056505156,2.404522854539 &
            ,0.795967658750,-1.354877972349,-0.260392014802,-0.061229957913,-0.147362415100,-0.341197827950,-2.033778745450,2.722230061505,1.069740231166,-1.302951466553,0.127001337345,-1.606798803679 &
            ,0.223151318752,-0.788900891103,-1.552284653836,2.398408873274,1.970965662925,-1.570331370702,1.637617080049,-3.180467131839,0.420646562235,-2.072084860973,-0.899636732876,1.230394168568 &
            ,2.155708893591,-1.632400245391,3.723299454740,-3.805844922079,0.164957461339,-2.636137227986,-0.148737978293,0.540832873767,1.738359142228,-1.336874445721,3.553868975676,-2.816323716693 &
            ,-0.143825497702,-0.545961435293,0.585439671918,0.005606290367,-0.593032012070,1.201825891472,-2.077762190297,0.598668631058,0.619831481775,-0.165548428716,0.438535133636,-0.512926898719 &
            ,0.359936425830,-0.285169466569,5.580180295866,-0.343672852943,-0.679230945447,-0.321954360244,-0.357627160549,-6.585911384930,-0.017523950233,0.229207175475,2.974804585910,0.034812607720 &
            ,1.193717812228,0.210802003451,4.796155490800,-7.589312851195,-1.315487524395,-0.190010013083,-0.440312200391,1.720084787562,-0.273526938628,0.891902908887,2.949558958404,-8.247199252339 &
            ,-0.209918403353,0.455578208906,-1.561687536068,0.223958824159,2.310004522529,0.225293221798,1.883029665564,-8.478164043905,0.625958553751,0.978662897407,-1.000884837070,-0.622617806806 &
            ,2.467711627001,0.817496086027,1.845737309690,-12.708856921323,0.091400306507,0.903094465394,1.905194027136,0.332848078369,-1.677136713828,2.136424265578,-1.473569555509,-14.080695486860 &
            ,0.687199503217,0.440797662535,-0.039522134270,-1.218075186293,4.632544334518,2.867892255915,1.625273761800,-2.977531463835,-0.235728452876,3.083790618539,-0.882614831748,0.205395758161 &
            ,8.258137105781,6.236640485392,-3.966848866956,0.893692161371,-0.210074532302,5.659237784075,2.578237038347,0.188053308482,8.347220124911,10.083072643437,2.113390259390,0.154550649830 &
            ,0.470642210684,3.395265669034,2.439286163434,-1.036858574803,2.008303852215,3.882714756342,3.503266829861,-5.036436727451,-0.288928866854,-0.260431305879,-0.207253541470,0.101208430749 &
            ,0.532712602162,0.006340830054,2.677475762713,-0.753970387666,-0.069841450915,1.036961596744,0.293076615471,0.312512735996,0.281533820036,0.256990600201,0.181450384439,-1.232378056326 &
            ,0.112975851254,0.605029639922,0.457470371547,-0.091726402870,0.768389207265,-0.143089207711,0.264550301429,-0.459467406809,-0.130711087151,0.126429592362,0.327580497166,0.118729434036 &
            ,0.177252769988,0.107188447199,0.818424289460,-0.384354994090,-0.111056178323,0.844852204855,-0.255478165821,0.112095705788,0.430625965801,0.212666469868,0.783703644146,-0.606423267719 &
            ,-0.407234645259,0.206623140278,-1.516971934195,0.417647152618,0.436100241273,0.061309518676,1.279513198733,-0.728087123080,-0.045034565577,0.076132730816,-1.749937208454,0.044015301822 &
            ,0.242366062176,-0.054661656503,-0.058938096474,0.303693431782,-0.153632555956,0.186550482035,-0.639232256672,0.103833617134,-0.274648074894,0.124905125315,-0.217544068058,-0.388885516405 &
            ,-0.051354497461,-0.138815866009,-0.147609273852,-0.221048049639,-0.109404425874,-0.137009538523,-0.512203097549,0.659901116111,0.025635677776,0.090428077130,0.912678912178,-0.083033346575 &
            ,0.020613343356,-0.083597349271,0.025526968206,0.130257753846,0.014288559745,0.179202334702,2.519697658835,0.079340987676,0.042788476916,0.061050227503,0.071927138539,0.048212093900 &
            ,0.152727512448,-0.189697042239,1.806899428845,-0.125455813881,-0.133831231275,-0.099697484151,-0.350513486699,0.597175375499,-0.386252590145,0.048369583184,-1.532871574536,0.940576884191 &
            ,-0.266511557093,0.619293553673,0.606002545749,0.312260064192,-0.028350913792,-0.100645620442,0.256953605671,0.344496897451,-0.088796413404,0.183170929280,0.099181028804,0.602987918671 &
            ,0.435550255362,0.341927134020,0.272202070148,-0.863680678435,0.381960501059,-0.900020742901,-0.347010503698,-0.134469363899,0.576934965281,0.659311561599,-1.650328701088,-0.327265521621 &
            ,-0.345154104658,-0.495109348581,-0.439402492321,-1.180884874581,-0.295972716738,0.238393213017,-1.751968308985,0.053076800360,-0.652016780270,-0.487506355775,0.094396585980,-0.913313566600 &
            ,-1.501953250542,0.358576948862,-1.588606120776,0.286320089383,-0.315105893484,-0.155581949774,2.716988104446,-1.347563083052,-0.240518417131,0.487162257874,-0.940688257914,0.065007243804 &
            ,0.094040279132,0.044472509771,0.412365664804,-0.568261900652,-0.298480093258,0.247498317962,-0.777098968560,0.294832227152,-0.044393152573,0.201387269323,0.378502406516,-0.309114340022 &
            ,-0.309372282451,0.314648818664,-0.087681041287,0.223162738068,-0.122492194552,0.163052232827,0.165952730932,-0.327522004579,-0.314251659724,0.681166612597,-0.765553129134,0.235947071567 &
            ,0.022828968870,0.167920711694,0.168523312493,-0.717926392884,-0.427917763672,0.313700042498,-0.429046809572,0.287449473089,-0.077981346764,0.191037565516,0.352066057459,-0.295961343809 &
            ,-0.470329945132,0.291374422294,-0.899435130250,0.439300761063,-0.124726244039,0.308468534639,0.320854283997,-0.172258083500,-0.500078224094,0.615156314399,-1.515325202631,0.365000010456 &
            ,-0.041439834520,0.246889390798,0.352842029541,-0.569182454297,-0.096568810526,0.135932090379,-0.450781584348,0.163538733323,-0.036153508312,0.129213578291,-0.085681290231,-0.017863725789 &
            ,0.029968621025,0.045492448475,-1.490655246895,-0.050587894538,0.050098845470,-0.048962190382,-0.138562284581,0.049069517083,0.045038458375,0.031680250040,0.186639964133,0.015305501009 &
            ,-0.058152252187,0.027075241001,-0.389972279223,0.105479155857,0.119006407771,-0.123423388883,-0.592754744340,-0.304465603310,-0.008385872017,-0.221195498642,-0.158330591966,0.084381950489 &
            ,-0.005204585129,0.024818680283,-1.088308166234,-0.186793928692,0.111424780348,-0.149865867383,0.129173233716,0.022943179754,-0.008113339643,0.228422343791,-0.347672393732,-0.304510011512 &
            ,0.148835029134,-0.241953543823,0.083608932678,-0.294907332199,0.029018870093,0.033035710818,0.591649910188,0.071539434282,-0.114061971735,0.096840122906,-0.307823095335,0.048400443182 &
            ,0.138687779910,0.058718182688,0.288198009415,-0.173753399967,0.025930515851,-0.108117467345,-0.379200629376,-0.006654808846,0.009819207874,0.341935357925,-1.217449290176,-0.352012561236 &
            ,0.107528909836,-0.189468258934,-0.291183069118,-0.185305501280,-0.654855927026,0.193274756830,-1.860318583439,-0.738756395300,0.320551973974,-0.598706375824,0.940403879439,-0.053367367193 &
            ,-0.610317750280,0.302781017646,0.813034933539,-0.612619575628,0.347052901185,-0.552641341494,0.666984390785,-0.069917878819,-0.019924604886,0.031167194803,0.084264807894,-0.047099279035 &
            ,0.057235693828,-0.043710650783,0.078816821598,-0.030632051846,-0.021574270190,0.016741903005,0.256235982645,-0.081567235219,0.042322205487,-0.071875022245,0.027930094828,-0.000933443348 &
            ,-0.008687868188,0.029538422397,0.105136870932,-0.054656478341,0.045939028545,-0.048329604940,0.012511627505,-0.010768333802,-0.013875686113,0.016543010333,0.154201064863,-0.066503406304 &
            ,0.034268494733,-0.054999625966,0.028921925849,-0.005882840990,-0.006278967883,0.024486164057,0.030149160064,-0.032124021531,0.025195185308,-0.028195063923,0.011246392164,-0.020174284637 &
            ,-0.014344216908,0.019459757888,0.121423633376,-0.053580753450,0.022767920156,-0.046759737863,0.047863843500,-0.037088811295,0.065965069394,0.001077051665,0.139647477449,-0.074876616370 &
            ,0.031624760986,-0.060081481955,-0.028554657709,-0.041809870170,-0.006208000213,0.023593764012,0.256904894371,-0.142984523191,0.054889060483,-0.116856089636,0.098304779488,-0.083629174060 &
            /),(/8,126/))
real, dimension(2,8) :: hidden1 = &
  Reshape((/0.20052,9.3659 &
            ,2.2761,17.1289,0.4678,-0.18237 &
            ,-0.0057996,15.3195 &
            ,-4.4369,-22.7833 &
            ,0.31825,-21.4327 &
            ,0.49033,6.3006 &
            ,0.41354,8.1008 &
            /),(/2,8/))
real, dimension(1,2) :: hidden2 = &
  Reshape((/-2.9425,11.1236/),(/1,2/))
real, dimension(8) :: bias1 = &
  (/1.6011,-0.84276,-7.1193,7.0654,-1.1877,2.4524,-5.0276,6.4349/)
real, dimension(2) :: bias2 = &
  (/3.175,-1.1765/)
real, dimension(1) :: bias3 = &
  (/3.109/)
contains
subroutine fnet_LosVaqueros_initall()
end subroutine fnet_LosVaqueros_initall
subroutine fnet_LosVaqueros_engine(inarray, outarray, init)
  intrinsic MatMul, Size
  real, dimension(:), intent(in) :: inarray
  real, dimension(:), intent(inout) :: outarray
  real, dimension(126) :: inarray2
  real (kind=8), dimension(8) :: layer1
  real (kind=8), dimension(2) :: layer2
  real (kind=8), dimension(1) :: layer3
  integer , intent(inout) :: init
  integer :: i, j
  do i = 1, 126
    inarray2(i) = inarray(127-i)
  end do
  layer1 = MatMul(input,inarray2)
  layer1 = layer1 + bias1
  do i = 1, Size(layer1,1)
    layer1(i) = 1.0 / (1.0 + DEXP(-1.0 * layer1(i)))
  end do
  layer2 = MatMul(hidden1,layer1)
  layer2 = layer2 + bias2
  do i = 1, Size(layer2,1)
    layer2(i) = 1.0 / (1.0 + DEXP(-1.0 * layer2(i)))
  end do
  layer3 = MatMul(hidden2,layer2)
  layer3 = layer3 + bias3
  outarray(1) = layer3(1)
end subroutine fnet_LosVaqueros_engine
end module fnet_LosVaqueros
