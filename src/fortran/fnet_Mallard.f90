module fnet_Mallard

! a = 3.6365e-005
! b = 0.13276

intrinsic Reshape
real, dimension(8,126) :: input = &
  Reshape((/0.002265821354,0.012547001006,-0.007657309843,0.175005891196,0.168122061356,-0.110403288208,0.046586160877,0.002459225791,0.040907509956,0.060059433683,-0.012943081759,-1.444746225983 &
            ,-1.426153316137,0.036249782301,0.212645933666,0.035760493991,-0.045548418622,-0.017031818860,0.225717372099,1.039314333245,0.967401399326,0.124757238314,-0.371061370257,-0.139395757159 &
            ,0.029178520259,0.001100102526,-0.178444061209,0.254046870630,0.214853175736,-0.001368094860,0.206149806056,0.123069088594,-0.034117843252,-0.040244446481,-0.089011148178,-0.240872317170 &
            ,-0.186420693762,0.513954119489,0.064372184927,-0.023393477959,-0.034609759996,-0.065671038588,-0.427836499279,0.224631392630,0.240186901051,0.612153886067,0.231723424826,0.018929799401 &
            ,0.089382265455,0.033565874049,-0.085963452939,0.228271713627,0.278374176861,0.563201865402,0.467790899241,0.238034325515,-0.041781185917,-0.023455670346,-0.231892297935,-0.579159716055 &
            ,-0.602274644908,1.502876237257,0.138274063473,-0.089392640809,-0.070252866354,0.096273614490,0.662667665518,-2.044958551508,-1.865049397568,-4.033407859533,-0.450020619270,-0.427388560187 &
            ,0.146433039290,-0.002973797291,-0.072425600497,0.675523802011,0.580282894699,2.295192163970,0.486829942165,0.658818630966,-0.093701099813,0.012433670390,0.021664930560,-1.251544960132 &
            ,-1.256682752614,-0.012318848818,-0.328574492371,-0.354493348827,0.018496688343,0.063299272126,-0.071047008400,-4.349860770628,-4.282038095250,1.283449288986,0.329801558440,0.001088242933 &
            ,-0.016784957312,0.048123073671,0.238700734514,-0.908909705654,-0.869527230593,-0.111071821679,0.094094370353,-0.120733444178,-0.061571165415,-0.002159097821,0.234821417872,-1.411458708732 &
            ,-1.361967042931,-0.050018867712,0.062296855521,-0.084656377834,-0.049551344438,-0.034631268287,-0.258944690537,-0.175288695883,-0.159156896173,-0.239439293640,-0.008623096190,-0.058308975184 &
            ,0.008378200798,-0.031097681673,0.015698990024,0.074331524912,0.047029892090,0.618817325885,-0.082537010933,0.153889722094,0.027355692071,0.045804647366,0.404499241937,-0.374897096717 &
            ,-0.318507646629,0.191837362193,-0.117975942733,0.026704822801,-0.017035265243,-0.013098820414,-0.458955779098,-0.967440400081,-0.883774345563,-0.689610691350,0.360013871714,-0.016298559640 &
            ,-0.089952142307,0.071063854794,-0.009803121714,1.137513500813,1.449351535710,1.901865474611,0.452076339433,-0.454278271387,0.070911420038,-0.037908716230,-1.245507618373,-0.826179187615 &
            ,-0.833863023301,3.425613416106,1.659037798515,0.096201506479,-0.105407222581,-0.004078021595,0.092161429254,6.850099074082,6.008623860164,11.709092405080,-0.139043742812,-0.195321798889 &
            ,-0.072701470479,-0.282292993691,0.334854199223,-1.435112099376,-0.975298823351,-3.512991394587,0.130217624979,0.533312930752,-0.014785781203,-0.160274975815,-2.589686348953,-1.666318435253 &
            ,-2.033251889553,5.802054416439,-1.013096868409,-0.170196340953,0.186653266776,0.234818835629,1.422266800948,-0.553357587335,-0.510412452507,4.231033813695,2.114648603959,0.525169885113 &
            ,-0.313672476107,-0.212182580945,0.461303941548,3.959130197797,3.767141625643,0.404718294656,-1.063355817011,-0.597136233005,0.287980751031,0.112323692692,-2.202193609271,0.966002796978 &
            ,0.334819497728,6.403692990063,0.949916280686,0.439777808428,-0.109303203815,-0.334390181043,-3.218247119713,-1.262337591950,-0.680549220828,5.956830147369,5.163248674105,0.330713500806 &
            ,-0.246930550545,-0.595201887704,-1.864376137172,2.342498066231,2.835832533485,4.142020983455,0.091179582204,-0.569025444706,-0.038279823558,0.085983971159,-0.559769379401,1.206364162728 &
            ,1.092446029801,-1.109197018277,0.799692838319,-0.504574917654,0.208784795512,0.181193701397,0.439240506684,2.555197510890,2.178004662046,0.222800822708,-0.050985563400,0.158344097211 &
            ,0.239218506344,0.168804576999,0.915927029993,0.618951428822,0.236257207416,-0.812111064432,-0.767875792134,0.390784993069,0.018822202550,-0.022087855391,-0.448225349255,0.245959183149 &
            ,0.208243375581,-1.324458986616,-0.222191481936,-0.077468800747,-0.188688432487,-0.088763437026,-0.380458513348,0.960330125744,1.272430175845,-1.245582779793,0.104033023216,-0.621022083261 &
            ,0.164954477927,-0.067318711022,1.397223699995,0.598274953211,0.603246125403,-0.486450759914,-0.632033866133,0.734948680745,0.146643292506,0.140453386692,0.976484687684,-0.834538470056 &
            ,-1.094149248965,1.706590583949,-0.480420975043,0.145974528754,-0.178677227844,0.036823501545,-0.576492666458,1.232634022352,1.151222473740,-0.630814794068,0.003004519315,-0.816239651287 &
            ,-0.355277049770,-0.195579998993,1.005540470696,0.380458596754,0.336459479703,-5.763642826971,-0.694616244843,-0.057586837862,0.132855955442,0.440880736354,-0.387398623415,3.168804005138 &
            ,2.359717877353,-2.727271328300,-0.353353601252,-0.497681031777,-0.192012225981,-0.261263672854,0.293683073412,-1.960611959569,-2.390820688240,-3.144408864199,-1.247565776786,0.719550186732 &
            ,0.730997966401,0.552781290075,2.213353838064,-1.337016850031,-1.767096103201,-3.666475931965,-2.072540294794,0.078018990651,-0.589169758920,-0.286306992880,2.987002386816,-0.716459863676 &
            ,-0.413606541201,1.226609948932,-1.708467586569,-0.621353049553,0.154379856918,0.024509393434,2.607098159762,-4.352936590999,-3.274565025352,-2.663785517291,-2.235701284554,-0.340812255251 &
            ,-0.556309294904,-0.437158088586,4.704420732825,-1.008114332070,0.390945514878,-4.164573883851,-1.820547756492,-0.356532026816,0.305163634494,0.463734253117,4.089566518287,0.143076111109 &
            ,1.310707290389,-3.753369743744,-0.706241456306,-1.006225669506,-0.405147540357,-0.249078225587,-3.058812259909,-0.829226443635,-0.926326964911,-3.103278468203,0.740491458625,0.290488797951 &
            ,0.593295279459,0.497294283751,-4.042886433969,0.226444811745,-0.691427871318,-7.094011409331,0.418616675419,0.208899554005,-0.008315211073,0.079897170195,-0.077897991636,0.662629467290 &
            ,0.551699544988,-2.392286516830,-0.174182395152,-0.144605814262,-0.031517450718,-0.036046774503,-0.762128016815,0.369793400446,0.242222033720,3.343515821465,0.489553575587,0.067552449852 &
            ,0.151488520479,0.077453268925,-0.760259489646,1.092578684110,0.840920847088,-0.609945256194,0.235706001784,0.303438917110,-0.072593038497,-0.045448705158,-0.516304573788,1.191556404838 &
            ,1.041220376659,4.417092863826,0.279203873963,-0.095358213160,0.138949228804,0.089441234707,-0.514979853099,-1.533928784150,-1.549124198935,-4.940624481437,-0.209313590277,0.207226235317 &
            ,0.083575355022,0.183722659581,0.410358099597,-1.331031542059,-1.280820846536,-9.184129244768,-0.540127765175,-0.222778315782,-0.070749076554,-0.093603523644,-0.122925909399,2.616663402924 &
            ,2.417275400456,13.603386140242,0.771703289378,0.055100612095,0.355566703080,0.184345056485,-0.219331525343,1.909647664859,1.762027739989,-2.441762764422,0.249168975298,0.332861619117 &
            ,-0.394494839055,0.265044215967,-1.108436357065,0.579379524565,-0.170133969873,-2.022095889073,-1.127034334354,-2.626410764624,-0.093859704303,0.436039385178,0.207702206041,-3.096882105848 &
            ,-1.698829680493,-3.051476685208,-0.416485504059,-1.363085310835,0.591146599715,-0.301223915796,2.492382285358,-2.733252407875,-2.277582353142,-0.037523779074,0.779922770544,3.743991956515 &
            ,-0.401295784573,-0.204703517990,-3.371252740128,2.578077365472,0.868591762345,2.489229432721,-2.637660703236,-2.159409362701,0.005173480216,0.123680396203,1.036171271744,2.422169551080 &
            ,1.954315461229,5.187609915704,-0.846038936254,0.195422197199,0.744587507966,0.427194766973,2.777285621413,-3.437630044497,-1.199840960953,4.106355135466,-0.615051839017,2.230879956294 &
            ,-0.509219319876,-0.498220466111,-2.415328214574,-3.241408846891,1.095700417778,-1.093535145438,-0.750228774934,-0.803616735124,0.402413721534,0.177092632415,-3.633186362966,0.512560122004 &
            ,0.807269560556,1.736459002775,-0.041841041644,1.785213032348,-0.136013310093,1.499862120409,0.886965436951,2.166855998612,2.432495615503,2.201663982711,-3.095775778195,-1.992904525436 &
            ,-1.515741541918,3.006945804223,3.723168669910,-0.844868267073,3.515004172960,-2.855787957860,-0.744150354128,-5.810469306801,-0.321780749240,1.735165651207,0.667180758492,3.251133462836 &
            ,-1.596960970541,-1.560741561555,0.088499021033,-3.655086844594,-0.011998151826,0.716952732506,-0.227059580469,0.682176474319,0.526207834847,-1.351103075191,-0.568392435869,-2.106415847352 &
            ,-0.971517359606,0.368976666290,-0.572141482515,-0.510751095197,1.279647769530,-1.082862237206,-0.887794299113,-0.768135526507,0.217547711852,-0.609045929227,-0.219713585306,-0.792631105428 &
            ,1.231405737057,-1.202446562709,-0.401598279706,-0.544454983769,-1.350233257326,-0.333680458371,0.892598143228,-0.107187359411,0.409600057691,-1.862709835793,0.679687817314,-0.093025633394 &
            ,0.339073270821,-0.553317515355,2.543032236951,1.181532515091,-1.446380199506,-2.406040005783,0.985616585901,-0.153510737943,-0.584595163445,1.625237440778,2.353443098367,-0.060625755417 &
            ,-2.255319278176,-3.306433670524,-1.927640195861,0.612432235119,0.173709149070,-0.703701337082,-0.298167604267,-3.441402429471,-2.464095638537,-6.652035112036,-0.104475991437,0.770752616965 &
            ,0.096179473195,-0.419343403947,-0.951733763609,-0.941189021543,-0.734839676989,-3.024580398447,-0.746704400390,1.334747814530,0.003253155036,-0.233687679846,-2.589529391526,-3.482027811106 &
            ,-3.447165331641,-1.264446057781,-3.950507742077,0.308124618913,-0.083434846407,-0.147176119922,-0.556408949177,-8.406274644597,-4.996063609860,1.353451591466,0.525294731038,-0.207645519224 &
            ,0.046968079329,0.099109702773,2.237086708425,-3.330698220605,-5.780453366252,1.352210390913,-11.256697838760,0.417786198276,-0.108189001847,-0.453795399952,-4.538149813980,-6.325441719935 &
            ,-4.306037913461,-0.641579654112,-4.788690525959,-0.038098926558,0.085301714263,1.294596614227,1.851261572920,-5.253676087519,-3.753278565078,2.339758544780,-7.221262533822,-2.224207982889 &
            ,-0.202985595357,1.642783567851,4.443140389282,-4.511573258434,-0.896423708513,1.833949700400,-10.473964503748,-3.388940132728,0.353782738949,6.107929335536,0.447851800699,-4.658234810628 &
            ,-0.525037140534,-3.447610904904,-7.388965772204,-10.247659265406,0.227473958460,5.434150449543,-4.784052347847,-4.106818873990,0.817909191878,-3.980443288896,-3.933034294057,-2.336298948121 &
            ,-1.374873195578,7.452257990034,-1.203027974330,-2.109166687613,-2.569049427220,-4.750543145412,6.822525402147,2.791366294252,-2.277681415687,-1.347562369218,2.796247972552,0.482827536429 &
            ,-2.490831619601,-4.204730901815,2.117784950821,3.300166991817,0.771712674078,2.270644377944,-0.326018476787,1.257016560912,0.183485537458,-3.431444413927,0.731216695052,-0.918466290745 &
            ,-1.894469955358,0.263676650555,-1.695599614216,2.382459418854,1.689054001047,-3.482175714522,-0.497152613074,-3.230049700308,-2.463947654929,-0.339280234782,-1.279683892919,1.495772504151 &
            ,3.075824264004,-3.911323780372,-1.657003247836,-4.712863058727,-2.570206138521,-0.642716793119,-0.421931402622,2.198997531289,1.280420859991,-4.053992808308,-2.821175246781,-2.247761940844 &
            ,-2.336067022946,-0.482705519953,1.850720796136,0.724225689333,1.170145447822,-5.506695854340,-0.239014372895,-0.501342506129,-2.869233097389,-1.622181474263,-0.797353455632,-0.992675521588 &
            ,-1.398027230584,-8.427959713141,-0.026839396199,-0.471107033114,-0.572892447538,1.875434302434,-3.093879135210,-5.802412076096,-5.758327745503,-8.918261143625,-0.285192675934,-8.147212299247 &
            ,-0.120914230367,0.079487194879,0.331291938778,-0.149102595377,-0.222364155423,-0.396609141401,-0.603910818126,-0.615293316529,0.056584731760,-0.048779512326,-0.223651518456,0.668321662172 &
            ,0.568271503908,-1.986852311873,0.068483320165,0.250178340561,-0.105073184234,0.179673454977,0.451379624377,0.562819184244,0.399723399644,0.485384597990,0.013957384749,-0.743771470649 &
            ,-0.122721503958,-0.015506713426,-0.035361840464,-0.725511138083,-0.643351055343,1.536456910224,0.432284202615,-0.350629035276,0.089475309257,-0.033398156216,-0.040044443183,-0.583123229436 &
            ,-0.598418669233,-3.086558392637,-0.164937492210,0.291818335389,-0.136561831892,0.006730832361,0.478850112634,2.912676714490,2.699496145968,4.363847459919,0.729042653577,-0.370450353231 &
            ,0.074294887725,-0.156045560002,-0.288048553331,-2.590152887385,-2.544224539144,-1.278890805735,0.155185582743,0.557927345435,0.090313737142,-0.291315178667,-0.072802229940,2.630635655116 &
            ,2.363329275291,-2.031257450206,0.368719453218,0.816637564443,-0.097067664939,-0.011801928658,2.005841654656,-2.745852506467,-2.901237048906,0.299140500615,-0.648393472032,-0.633535803258 &
            ,0.437991958320,-0.407498223673,-0.697251892383,-3.369099966453,-3.232951838855,-1.564671902851,-0.214344699689,1.172613153810,0.099812132734,-0.020098268220,-0.601193290024,0.406815787996 &
            ,0.413797906357,-0.284682707733,0.176595952564,0.078693311096,-0.029767343891,0.004785265398,0.870742972897,1.086886292405,1.082309231489,1.441683199268,-0.242242879519,-0.164154224065 &
            ,0.111814158674,0.047995530155,0.526336494705,0.616935481824,0.544594907494,-0.608269067525,-0.206635441185,0.117780606664,0.127182184948,-0.001070622350,0.534187769302,0.456374583849 &
            ,0.410028862117,0.467127527421,-0.201829556248,0.305858199648,0.055054544314,0.067950334898,0.608680053676,0.746511172191,0.727750567565,0.488259892042,-0.351397707752,-0.166438034942 &
            ,0.056827161265,-0.048627964527,0.033693667216,0.821386625837,0.854635622656,2.351437872706,0.170117545356,0.081583395725,0.023358518885,0.070205932287,-0.023115537851,-0.026205001450 &
            ,0.018693496945,0.633942644154,0.271306162373,-0.359485680487,0.016522968346,-0.004161111613,-0.484518400925,0.736095441854,0.777136469779,-1.086171834588,0.338812121708,-0.030451956570 &
            ,-0.049430932187,0.157630279446,-0.172087255448,-0.671617963773,-0.652257969947,-0.201295370310,0.793433881651,-0.489842454550,0.000442512419,0.112094127136,-0.097930121605,-4.154230962091 &
            ,-3.940814891111,1.156705254241,0.557559615269,-0.201773437900,-0.051084877901,-0.073254813025,-0.331511551267,-1.793460117487,-1.591950323794,0.146256911528,0.307978472009,0.009263906436 &
            ,0.066417039382,0.019576808967,-0.384294198644,-1.703071594317,-1.638787556462,-1.383554302039,-0.121061217087,0.134700083915,-0.091552188939,-0.005768071941,-0.547173000754,1.253933844564 &
            ,1.255311341750,1.277565930245,0.554571751718,-0.344103108337,0.034822760529,0.076827794527,0.377693102625,-1.072978282379,-1.059378517294,-1.044742255302,-0.011827748817,0.028663915589 &
            ,0.040991658782,-0.024650713252,-0.560194697226,1.528633228410,1.424670772374,-1.433640675474,0.074237436748,0.098627938579,0.059446972059,-0.133320892853,-1.794228904458,0.252529616601 &
            ,0.237435650923,-2.663937837314,0.680608363919,0.365876684410,-0.019417711722,-0.141956962640,-0.916511225885,0.198774407000,0.262259112274,0.210740139439,0.065652572555,0.153730480048 &
            ,0.029513954101,0.098521491834,-0.012910829436,0.347527033252,0.267863710905,-0.275646282162,0.302141089319,-0.109133356805,0.014394109939,0.015251653106,0.072260213661,-0.093966987823 &
            ,-0.091126417232,-0.002099842848,-0.017384659153,0.008537035907,-0.004647441621,-0.021125352348,-0.185616258906,0.156050946224,0.144231027882,0.068898487091,0.107517678807,0.025872659866 &
            ,-0.040108907175,-0.031383660281,-0.168257293229,-0.130716846191,-0.115825550292,0.104544314588,0.046123934806,-0.062963367756,0.006292197952,0.014596850219,-0.135991858393,-0.013502258123 &
            ,-0.032815366628,0.271472922270,0.100778316655,-0.027783360124,0.007666729020,0.022027457153,0.004492050292,-0.223968429102,-0.226550958646,0.131864270059,-0.008646452193,-0.040181137622 &
            ,0.005345499480,-0.003740214756,-0.066858782376,-0.091365648260,-0.074044254241,0.195720599326,0.055884546063,0.013097687730,-0.017323989900,-0.022401359868,-0.114111882026,-0.362671702345 &
            ,-0.330613540706,-0.053455390119,0.035722634903,-0.010232911521,-0.014561073206,-0.005917447584,0.232283725764,-0.002126231585,-0.007444260527,0.439255909131,-0.077777758951,-0.001385948976 &
            /),(/8,126/))
real, dimension(2,8) :: hidden1 = &
  Reshape((/12.0846,5.8829 &
            ,-15.2504,3.3646,1.5656,-2.5671 &
            ,4.6531,-6.0192 &
            ,-4.8844,6.2021 &
            ,-7.9724,31.7033 &
            ,5.647,-10.8185 &
            ,-4.2084,1.118 &
            /),(/2,8/))
real, dimension(1,2) :: hidden2 = &
  Reshape((/1.1231,0.21524/),(/1,2/))
real, dimension(8) :: bias1 = &
  (/2.664,-2.0325,5.264,0.24869,-1.4276,-11.019,-0.51946,6.6559/)
real, dimension(2) :: bias2 = &
  (/3.4928,-5.9067/)
real, dimension(1) :: bias3 = &
  (/0.13845/)
contains
subroutine fnet_Mallard_initall()
end subroutine fnet_Mallard_initall
subroutine fnet_Mallard_engine(inarray, outarray, init)
  intrinsic MatMul, Size
  real, dimension(:), intent(in) :: inarray
  real, dimension(:), intent(inout) :: outarray
  real, dimension(126) :: inarray2
  real (kind=8), dimension(8) :: layer1
  real (kind=8), dimension(2) :: layer2
  real (kind=8), dimension(1) :: layer3
  integer , intent(inout) :: init
  integer :: i, j
  do i = 1, 126
    inarray2(i) = inarray(127-i)
  end do
  layer1 = MatMul(input,inarray2)
  layer1 = layer1 + bias1
  do i = 1, Size(layer1,1)
    layer1(i) = 1.0 / (1.0 + DEXP(-1.0 * layer1(i)))
  end do
  layer2 = MatMul(hidden1,layer1)
  layer2 = layer2 + bias2
  do i = 1, Size(layer2,1)
    layer2(i) = 1.0 / (1.0 + DEXP(-1.0 * layer2(i)))
  end do
  layer3 = MatMul(hidden2,layer2)
  layer3 = layer3 + bias3
  outarray(1) = layer3(1)
end subroutine fnet_Mallard_engine
end module fnet_Mallard
