module fnet_ORRSL

! a = 0.00025323
! b = 0.32816

intrinsic Reshape
real, dimension(8,126) :: input = &
  Reshape((/-0.095430063926,0.154723360161,0.142253260762,-0.084861805124,-0.120621665495,0.083567277532,-0.213990695730,0.045779285760,-0.031604992102,0.184678111682,0.252973286675,0.048593315950 &
            ,0.077465972142,-0.161066433551,-0.047518196346,-0.051412545563,-0.275613526780,-0.129605251449,0.081766612341,0.437079769565,0.090954409756,-0.889349707451,0.455777002691,-0.046261076480 &
            ,0.116426987101,-0.124393494153,-0.181780287212,-0.202724192756,0.283048463208,0.577987820424,-0.229421289429,0.080764787313,0.018055123049,-0.397503684652,-0.468598248196,0.280348571880 &
            ,0.290346944259,-0.533696861210,0.047475652828,0.062385186519,-0.034954549296,0.241739053759,0.187541090101,0.105231233550,-0.305538640277,-0.710242081670,-0.070185908209,-0.118519765880 &
            ,-0.125067378135,0.502999820425,0.571327064412,-0.440124193028,-0.366580738434,0.366627544433,-0.183469755703,0.194885794947,-0.075736495409,0.013397012643,0.279574085182,-0.382891238385 &
            ,0.437439779327,-3.001482004340,0.000392453581,0.086680808248,-0.357117652537,-0.030230793902,-0.068347614537,0.908087997991,-0.272094034491,-1.247579901029,0.147176631847,-0.088858002910 &
            ,-0.252627835778,-0.872064450093,-0.776579496150,0.693279114882,0.970106587127,-1.485384220176,0.298810654679,0.144708952360,-0.101166878360,0.017244448252,0.084217853426,0.106018319630 &
            ,0.081608882895,-0.150091787630,-0.034371893801,-0.093547864997,0.010491988825,0.083764923785,0.045211806754,0.071980065228,-0.096988647045,0.349252297070,-0.085567007088,-0.093702404058 &
            ,0.016867528724,0.020706657233,0.029007083190,0.035355141316,-0.061206267093,0.361522823774,-0.049519678930,-0.089703827115,-0.030143250472,0.036522333466,0.060457274370,0.063762097961 &
            ,0.109960131135,0.339669711449,-0.131257151428,-0.075800555646,-0.029161145598,0.093278146205,0.118023714208,0.005629239371,0.036978501353,0.134139218169,-0.084577313873,-0.038365022129 &
            ,-0.055398978944,0.004533218542,0.013865023607,0.091854742224,0.024797436138,-0.264247922443,0.023794482698,0.001052613211,0.063440856998,-0.089899652098,-0.044414655558,-0.177512175272 &
            ,0.224775635324,-0.066472300048,0.039727022222,0.074461324357,0.048917725420,-0.034349955135,-0.035533855633,-0.212372626539,0.053940346669,-0.095470493698,0.076395810731,0.123299970957 &
            ,0.683103267781,-0.775215227490,-0.607861842650,-0.731404150698,0.762556900872,10.841468028147,-0.222626322714,0.088239900940,0.158471930905,-2.026233535892,-1.322449009240,2.836619789785 &
            ,0.664475457338,-3.536212118968,2.812507707691,-1.995127117566,0.469049685745,1.031757439014,0.459261742919,-1.775563895854,-0.387976812852,2.597048078453,-2.178089732455,0.193282554260 &
            ,-0.850794975582,-0.617956904727,-0.496327952387,1.911949844789,-0.821910841782,-1.854978090202,2.053142414057,0.914885250649,-1.748356962370,0.251914159691,1.129228493444,0.378267114316 &
            ,0.000972918988,-6.513346226130,1.168724028696,1.251294710362,-0.494472673481,-0.734386860886,-0.243741974956,-0.500683303268,1.252044801136,-1.090186447097,-0.286992976795,-0.448807725998 &
            ,-0.726940952745,-2.493833806774,-2.500541721013,0.547310828295,1.168144459776,1.546050270991,0.471252545354,1.336024624082,-0.399689691867,0.745363906484,1.650656817550,0.226207833118 &
            ,-1.231673212820,6.587715083577,-0.472986779646,-4.117593201896,0.593956494066,-1.019340902948,-1.497064719075,0.421808898977,-0.118505081350,6.868401240575,0.237888024216,-2.166984128597 &
            ,-0.961502976696,-1.470540449612,-0.653182821280,1.595846294591,0.560591133621,3.198230012353,-0.172106362511,-2.424852874059,0.298238506687,0.364798827754,0.025296891894,-0.129854768483 &
            ,-0.411578687360,1.441120143692,-0.487646886494,-0.057868494761,-0.056886985854,0.635679444981,0.627318946908,0.112413127102,-0.290024101590,0.318874647646,-0.695574890481,-0.404047878957 &
            ,0.162074619964,0.281748142803,0.111377667874,-0.053337628889,-0.417946039472,1.115228069598,-0.209738453163,-0.229058937900,-0.072759597315,0.459503579096,0.340787912065,0.211564670691 &
            ,-0.908932839951,0.223301144251,-0.270055336808,-0.293685160025,-0.006456391973,0.641659107236,0.438882500301,0.135344449944,-0.944892445413,0.920669594556,-0.614232671627,-0.469599066816 &
            ,-0.024083031224,0.196260766023,0.234141313723,0.001901319296,0.409917566533,0.661206858753,-0.462354452957,-0.193191411633,-0.176737237845,0.549569283066,0.653793973997,0.349812184303 &
            ,-0.799523446194,0.397963013975,0.068773267544,-0.189961028414,-0.200322821985,-0.343697860253,0.005871779316,0.687318682513,0.010111329655,0.871106657697,0.370652400145,-0.189352971668 &
            ,0.347626508396,0.915871558539,0.578613087827,-1.242390750467,-1.081254744642,1.235422968368,-1.140414473269,0.113891975954,-0.607667728197,3.754723875347,3.006183832590,-2.201963720008 &
            ,-5.335921696287,1.307085097808,-3.606051923567,0.463960861060,-0.149526553683,1.964187374550,1.671378788643,-1.306154594176,-1.050486479732,3.316149857609,-3.554675668819,-0.290178845796 &
            ,-0.587524835606,2.521590771907,1.943858647887,0.139475685626,-4.246994907603,-2.895405702970,-1.480300916240,-0.244079571809,-0.244863714662,0.451674152819,0.828505833914,0.890413398921 &
            ,0.776623303165,-1.031033625294,-0.398340769016,-0.889037247427,-0.182042628496,-1.732117193505,-1.148946002845,3.162429016325,1.669896882330,-4.575173018013,3.235288014246,-0.870535149801 &
            ,0.637906144506,-3.469296590213,-2.756999258567,2.615213058762,4.652506193173,-2.493075142548,3.930792660406,-0.577736715289,0.412409211549,-1.464853157113,-1.513435575980,0.792647220992 &
            ,0.354807580273,-3.576322173278,3.220973529458,0.600250460276,0.242458053833,-0.397761836021,-0.459647034073,-0.152813203189,2.035449239719,4.550168458431,-1.239768910685,0.412916087030 &
            ,0.205680696166,1.501130079297,0.458185981174,-0.352282334372,-2.608721323922,3.088737483413,-1.915060200186,0.249575733790,-0.059846635935,0.105396930069,0.107997090782,0.327111496998 &
            ,-0.115801017583,0.343507774541,-0.102379330741,-0.317089408575,0.066437027905,0.307734876254,0.221708314160,-0.492491550063,-0.383026399333,0.882610973067,-0.395674034321,0.153696704578 &
            ,-0.039510457800,0.213642732967,0.095442143289,-0.049215061664,-0.319231316606,0.103198150442,-0.460665195078,-0.105620738473,0.224592202973,-0.216136726808,-0.189220038979,-0.465013581183 &
            ,0.268339908286,1.569391560438,-0.046002770688,0.244068027705,-0.240455513828,0.636702731531,0.558201703218,0.230825404999,-0.647739584764,0.163689629737,-0.650308293297,-0.257096173681 &
            ,-0.266605837416,0.501789511480,0.484695285463,0.182153229987,-0.401080972026,-1.280383358526,-0.352733206980,-0.323241515797,0.474896776774,-0.619367473337,-0.686708981668,-0.660359295027 &
            ,0.510878452578,1.521448265385,0.213949223614,0.552650155820,-0.111604503151,0.433038632604,0.407645339244,-0.064636654459,-0.463860450759,0.339703362932,-0.449629565229,-0.140341529915 &
            ,-1.912465277239,2.654686701150,1.646870708398,-5.254211203526,-1.935319326891,5.430648304765,-3.321181081756,5.309789625118,1.941760607477,-4.607201295377,-2.868716966151,2.788779418037 &
            ,0.394532200635,7.270591207576,9.201938991951,1.044659708296,-3.277039940840,-0.305844335154,0.180845212187,4.014243435039,0.217335217378,3.076977400759,0.752043822650,1.068286122711 &
            ,0.733568481052,1.387038771582,4.639779034981,1.027906039372,2.042542992024,2.714601438842,-3.320927166334,-9.927658350845,9.413191475491,0.993210181621,-4.883194867479,-6.305565184141 &
            ,-2.775254120572,-9.025474650349,-5.251622746224,1.923392913939,6.248328855330,2.137255493496,2.352368731581,-5.160764978127,-1.847736063042,-19.320539070710,-1.637508958806,3.100269309139 &
            ,-2.391615830679,4.406175457927,1.711681783946,-0.021696910753,-0.964390676281,-20.636939472539,-10.619353037613,3.137299543190,17.933111128346,-1.079548533358,-5.100940512441,0.784208288553 &
            ,-3.311999199025,-12.539858368646,5.115247485128,-2.618040676434,8.648678248822,4.721144999521,0.635556500505,-0.278030441845,-6.557864152837,-5.709218741364,-1.297401567550,5.051820745665 &
            ,6.074086728137,-2.835066620636,-3.148107867199,5.285829911183,-3.493731889233,3.128378746585,15.885119919662,20.973522241974,-2.284647957954,2.574095180671,1.146494483748,2.730180653176 &
            ,-2.230735604790,-1.104468766500,-0.950436850005,10.543168932085,0.330477879715,0.076689443848,0.342779499683,-0.800782556324,0.427939245526,-0.845524935798,1.033119456038,4.250713628428 &
            ,-1.227204030592,0.313556276201,0.577093426094,-2.223802224253,-1.333091277557,1.274082029650,-0.524617468726,2.692922334284,1.418074036175,0.676034388258,-0.624671616766,-2.869068746607 &
            ,-1.610008130097,4.088666987454,0.748271043705,-0.341537180428,3.031757180614,-2.885369595787,-2.348992904643,1.051826335343,-1.017181560098,6.473830593201,3.924074180561,-1.933997165574 &
            ,0.912719945251,-0.258747108027,-2.670800398971,0.790650386647,-2.227737170913,8.233113464104,3.170035625349,0.804720397448,1.257310523720,0.753957230638,3.841616629374,-0.855496589860 &
            ,3.598319329610,10.354030517067,-0.024327760386,0.400778403861,-0.489730186681,4.586228582324,3.970825418169,-1.791341582682,-4.236742789505,7.792182768116,-2.922162552707,-1.418353824771 &
            ,3.033138816761,-3.271433996545,-3.004466301687,1.447819820533,2.110877510794,0.348655292793,2.744785637683,-1.356469785896,4.782846567025,0.452003689238,-0.927238595249,-1.683809403335 &
            ,0.646621554507,6.195728205066,-3.758277162476,-1.248475070513,3.457238725217,-0.210793384056,-0.567298536132,0.585582947760,0.086395258963,0.341689322065,0.613100726080,-0.511833734748 &
            ,8.057423063293,-1.854695285349,-1.993949098676,-0.402968885292,0.074460413843,-2.302270992947,1.992049493098,0.687218094490,9.860709715382,1.518389489479,1.807526784850,2.585798177286 &
            ,0.348336997656,-6.801135036475,-0.047561306180,-2.350209798052,10.772721716863,-2.112714430082,-1.895847488630,0.065465909097,1.711880435359,2.112060656585,0.920485967442,6.337115851857 &
            ,18.236493134553,-2.600305850249,-1.431029051013,0.326745380145,1.535708523204,8.986989150039,1.828600336273,-3.991969663879,31.892913671422,2.706511659976,2.852263616816,3.191464428145 &
            ,-1.218881018082,-2.287455097880,-1.499815276738,1.271775650281,11.667604784243,-2.245941740695,-2.705160972043,0.152252343385,1.628712662728,-2.368961928244,0.398474781373,50.614307437031 &
            ,2.365182392961,4.162892857697,3.101635570528,0.591445043798,0.209167172863,-2.075173956045,-7.266286693619,54.992437955123,0.892852757711,0.543971107876,0.369469413588,-0.871303027558 &
            ,-0.593930956316,1.158557500920,-0.297345723129,0.463715911744,0.198980244847,0.547068217675,0.733255893892,-0.254532198716,-0.307584173530,-0.393826363345,-0.270730160995,3.600357024745 &
            ,0.418745372454,-0.304591177053,-0.435310166920,-0.659298726272,-0.320454636751,-0.472181250266,0.459638681235,1.096345342879,0.009357409551,1.004840097465,0.786383659591,-0.145965639836 &
            ,-1.280603329688,0.293433037275,-0.509912473710,1.434704933223,0.281851678210,0.164337779706,0.014807842406,-0.281372624838,-0.706929388715,1.370307748384,-0.186360581736,0.713630686337 &
            ,-0.264002582467,1.235139843827,1.008060194756,-1.394556862773,-0.228671637244,0.049130360597,-1.878085003203,1.169923360595,0.020153980585,0.517716873615,0.908577186558,0.561184138959 &
            ,-0.796352705214,-0.394298266039,1.383352868856,-0.200498915536,-0.337594387286,-0.760143603747,-1.134616458794,-0.461990936693,-0.087810798981,-4.532313054555,-0.426122083674,0.227893742648 &
            ,0.029011476504,0.193882694098,0.355953131213,0.718644436900,-0.445577113609,3.091269880396,0.350555585612,-0.438984982450,-0.526095413670,-0.166852298046,0.024694329735,0.459670522315 &
            ,-0.032670757837,-3.013013085545,0.602051877650,0.130145634283,0.267781940394,-0.653094488081,-0.841078785193,0.224793053171,0.422528549654,1.068224590224,-0.071102679975,-0.260427861730 &
            ,-0.514163706090,1.166660074866,0.947340882494,0.210742313112,-1.302712466120,1.723542768002,-0.606382315488,-0.154209380752,-0.669123476694,-1.068827911852,-1.046788603097,-0.119244525106 &
            ,0.324700336229,-2.746459723610,1.047611759281,0.883643268679,0.120373990938,-0.554273949950,-0.447127997672,-0.559653127468,1.314458440379,1.480975580405,-0.480699687576,-0.838964086381 &
            ,-1.151717507161,0.504424744351,0.189527448012,0.579998854446,-0.977264091202,-0.499994550578,-0.274733092228,0.084313825139,-1.502186086256,-0.623225743473,-0.706564086523,-1.033276402789 &
            ,-0.203800785040,3.052404680180,-0.007124702685,0.345129561866,-0.861850801356,-1.249884135380,-0.701081490068,-0.212236682888,0.857533501176,0.863163106744,0.596136327479,-2.280196427326 &
            ,-1.087061817059,-2.480646195063,-1.535866544568,1.576317374629,0.769899359635,1.613779887925,0.452916553751,-4.353316726708,-0.021518419423,-0.107024262103,-0.206137354770,-0.205533713979 &
            ,-0.032182389791,-0.268818813614,-0.167265681993,0.031100342723,-0.035680789359,-0.147202628752,-0.208643831727,0.004380092914,0.066445267149,-0.587434465218,-0.367258645581,-0.373931532993 &
            ,-0.187557667770,0.023210022831,0.002315137975,0.083035297894,-0.056119126420,-0.768244882454,-0.280995250111,-0.200907839785,-0.302594915104,0.088448485823,0.053921297876,0.452744114566 &
            ,0.124989015646,-1.473974980668,-0.561513490596,-0.407205285360,-0.359706013236,0.184375474713,0.214289886532,0.554624774257,0.225594752451,-0.926031032516,-0.629144655551,-0.472085663108 &
            ,-0.241144972369,0.011810232211,0.096649273227,0.320064274683,0.560603101695,-0.825635887053,-0.577978303953,-0.370164743681,-0.426531662783,-0.085908615908,0.062559068018,0.838085458449 &
            ,-0.084416366723,-0.868803817212,-0.129697587459,-0.463189159705,-0.201745821351,-0.274126622885,-0.033921267346,0.644102391560,-0.127490661333,-0.250394958854,0.708439985906,-0.073957058123 &
            ,-0.068626655059,-0.523944616848,-0.290801087282,0.207259856277,0.394086411022,-1.151216198977,0.582684362826,-0.089562648418,0.127684488119,-0.493774625667,-0.490041606482,0.305251894023 &
            ,0.238571883487,1.134474275751,0.326981225613,-0.036042050373,-0.078855328309,0.067019293071,0.189289257287,0.409756103802,-0.091923682838,0.235832406927,0.510890799544,0.011351666640 &
            ,-0.058506020532,0.561313633041,0.863323556220,-0.052395994543,0.322821647381,-0.607597061919,0.127864502479,-0.317730807019,-0.099259399462,0.330214666552,0.538354182845,0.013174982845 &
            ,0.144661254767,-0.451042542076,0.206789657793,0.102852317258,-0.120893975586,0.022898403235,0.190978617867,0.521322773267,0.349651957947,-0.944089593622,0.368390538418,-0.085135602953 &
            ,-0.095018866962,-0.213863416078,-0.150399542443,0.391926102429,0.107243362991,-0.949086923782,0.103368487054,-0.097507185891,-0.178246553334,0.301593268653,0.183314697803,0.158227505435 &
            ,-0.275348332097,-2.516653901397,-0.060763760246,0.049297191678,-0.298843750928,0.580696105944,0.528661319284,0.175997656102,-0.662232694458,-1.745263347852,-0.484323123462,0.033838956652 &
            ,-0.193442540120,1.183691753835,1.054684660729,0.074598905718,-0.193119464354,-0.799687762147,-1.160748169989,-0.257611106132,-0.051321968139,0.099372317856,0.073611822909,0.068631494300 &
            ,0.033051586970,-0.093402501574,-0.190854810830,0.019924176194,0.004551871999,0.070263460679,0.032318533496,0.057936664615,0.097611117811,-0.059289198238,-0.157497624511,-0.015934175362 &
            ,0.002599500071,0.051557344488,0.023117092939,0.037270574235,0.014366987041,-0.088792952842,-0.101663982325,0.003331059417,-0.049845230629,0.020206471314,0.018170456666,0.041662615651 &
            ,0.061816304322,-0.138105730992,-0.077766396583,0.057557995893,0.040975021259,0.060667501460,0.018366253641,-0.040122599444,-0.003481634249,0.064539304357,-0.065069198494,0.047832846674 &
            ,-0.007151086387,0.055707774552,0.008290891246,0.006556857222,-0.038477232867,-0.195660824367,-0.096927037334,0.022573617617,-0.016016776321,0.036358050687,0.012832367640,-0.031445149957 &
            ,-0.001775309021,-0.088583804413,-0.081828421570,0.042972208008,-0.017983474334,-0.030438655590,-0.021008211783,-0.097471923449,0.021001073284,-0.024531275049,-0.039881496988,0.075146312293 &
            /),(/8,126/))
real, dimension(2,8) :: hidden1 = &
  Reshape((/3.056,-2.9644 &
            ,-3.9858,3.9498,3.7706,-3.7594 &
            ,2.0825,-2.0232 &
            ,-3.7989,3.8268 &
            ,-0.42857,0.39842 &
            ,-1.4639,1.4353 &
            ,-2.8354,0.31912 &
            /),(/2,8/))
real, dimension(1,2) :: hidden2 = &
  Reshape((/7.5854,30.4168/),(/1,2/))
real, dimension(8) :: bias1 = &
  (/-10.7326,-1.1792,-1.6378,-10.08,9.0631,-13.4178,1.844,-3.7047/)
real, dimension(2) :: bias2 = &
  (/6.9191,-5.928/)
real, dimension(1) :: bias3 = &
  (/-7.2041/)
contains
subroutine fnet_ORRSL_initall()
end subroutine fnet_ORRSL_initall
subroutine fnet_ORRSL_engine(inarray, outarray, init)
  intrinsic MatMul, Size
  real, dimension(:), intent(in) :: inarray
  real, dimension(:), intent(inout) :: outarray
  real, dimension(126) :: inarray2
  real (kind=8), dimension(8) :: layer1
  real (kind=8), dimension(2) :: layer2
  real (kind=8), dimension(1) :: layer3
  integer , intent(inout) :: init
  integer :: i, j
  do i = 1, 126
    inarray2(i) = inarray(127-i)
  end do
  layer1 = MatMul(input,inarray2)
  layer1 = layer1 + bias1
  do i = 1, Size(layer1,1)
    layer1(i) = 1.0 / (1.0 + DEXP(-1.0 * layer1(i)))
  end do
  layer2 = MatMul(hidden1,layer1)
  layer2 = layer2 + bias2
  do i = 1, Size(layer2,1)
    layer2(i) = 1.0 / (1.0 + DEXP(-1.0 * layer2(i)))
  end do
  layer3 = MatMul(hidden2,layer2)
  layer3 = layer3 + bias3
  outarray(1) = layer3(1)
end subroutine fnet_ORRSL_engine
end module fnet_ORRSL
