module fnet_Beldan

! a = 4.0151e-005
! b = 0.13618

intrinsic Reshape
real, dimension(8,126) :: input = &
  Reshape((/0.015627433977,-0.255094713685,0.041146581666,0.263234475682,-0.127712881222,-0.060731118979,0.184460805122,-0.160179187110,0.144229735435,0.047494771906,-0.039743403041,0.140441780912 &
            ,-0.020225687473,-0.001915058701,-0.097536018404,-0.051767498094,-0.096255524092,0.233140844218,-0.008180542561,-0.165073075996,0.142928654922,0.191455646938,-0.057391066169,0.272083025687 &
            ,-0.088509059840,-0.209726165680,0.002200611166,0.361329504501,-0.109646695020,0.118819398069,-0.032945559155,0.119961065004,0.247493287089,-0.065045382978,0.035333753785,0.373282204434 &
            ,-0.047293427701,-0.200687011640,0.161576996242,-0.780915206481,0.028694380421,-0.005278084807,-0.037020363323,0.060522072797,-0.047267092148,0.201163337649,-0.061162478779,0.455613377093 &
            ,-0.357941191553,0.040902926323,0.040098733905,-0.044211067696,0.109386573517,0.045734944941,0.006569516568,0.527013219981,1.051545099470,0.012036168733,-0.025142607841,-0.754746893068 &
            ,-0.119359682723,0.010797902591,0.511186014497,-1.595925547912,-1.204518580199,-0.175220636331,-0.001155061392,0.250116910511,0.037806943571,0.257054886098,-0.530965094327,3.380297345553 &
            ,-0.460328799275,-0.115611716306,-0.024729390490,-1.133797595116,-0.043032595405,0.588961605635,0.078868511882,2.019762290330,-0.286541037154,-0.260230695983,0.023802566212,-0.098415371394 &
            ,-0.144082049040,0.149830412869,0.076642851857,0.346782391559,-0.208974795830,-0.109864655060,0.011067153075,0.134124290183,-0.061721789389,0.262844528417,0.014421337293,0.237732948410 &
            ,-0.343356786565,0.060563534626,-0.011955895198,0.668934255320,0.048369233270,0.304738700514,-0.274792732117,0.167916382409,-0.069588265006,0.168107524072,0.008686038858,0.896796905410 &
            ,0.110053779051,0.509974713884,0.067807747510,-0.034479055420,-0.438574260266,0.167739387038,0.011551866349,-0.210102710022,0.094916334818,0.272738001197,0.172058049962,4.253941031016 &
            ,7.570442296424,2.327715267466,-0.783567249588,-0.048421388972,4.061590495626,5.790627884188,-1.749458879992,-11.082239615913,-0.155806190261,-0.138584064255,0.092431777751,-0.408443084930 &
            ,0.118550922758,-0.702724577024,-0.171909433589,0.187446084240,0.044424387069,0.061799974345,0.060648377093,-0.206706817789,0.207346076450,0.210157905712,0.173591506083,-0.155868535769 &
            ,0.351279863447,0.827725898112,0.035492593513,-2.375439950960,0.612167447829,0.350326248962,0.492475928536,-2.255092572314,0.830548133922,-0.424477632303,0.031764519219,1.624009724920 &
            ,-0.442745803611,0.733139766710,0.823366798811,0.264644072580,-1.088577956288,-0.529760589503,0.313836760596,0.816273083226,0.101526376963,-0.220291099460,0.031443891681,-3.205323998053 &
            ,0.986163347532,-0.181346791750,-0.086402535071,-0.025943750060,-0.234483437739,-1.019071326774,0.418155057552,1.437309350526,0.955742620040,0.027166933930,0.003162932349,-2.827660842934 &
            ,-0.204273993421,1.573328145961,1.369477599089,-2.248456113658,-1.071264958907,-1.418055836823,0.365269223172,1.652178943776,-0.522417492617,-1.652616190296,0.125347921015,-2.227035818876 &
            ,-0.417348499189,-0.042990356535,-0.217636246177,1.857923885659,-0.229743421112,0.116652235819,-1.771837055148,2.143967732925,-0.100365975814,0.368177796684,0.199526780597,2.704165730387 &
            ,0.386697398563,1.509071833532,-0.048484450105,-0.328688291089,1.562837779280,0.516894051314,-0.058270642717,0.538477276076,-0.144867476634,1.917928760902,0.348639240580,-2.060601401374 &
            ,-1.676761169192,-0.405898946529,0.303942978318,-1.267866313011,-0.076061741928,-1.655540373961,-0.522167337487,3.488703678980,0.694199558404,-0.122016671188,0.022545762222,-0.360398215835 &
            ,-0.203855664465,0.107782797298,0.441790120598,-2.836122180618,-0.344339214633,0.044206979441,0.030139924003,-0.026890454959,0.047595801879,-0.318390982868,-0.297010460703,-0.011612261948 &
            ,0.013068006131,-0.000713906065,-0.042022977524,-0.128378360984,-0.067606664791,0.132898545582,-0.096904486315,0.645942383789,0.358990414485,0.184675583953,-0.090260557970,-0.498093139665 &
            ,-0.027532755541,0.318372494943,0.001181820454,0.526641536808,-0.176150992132,-0.221332961007,0.060668815211,0.798966918334,-0.089980581669,0.092833830551,-0.094090830517,-0.687130835335 &
            ,0.592914144674,-0.371367218177,0.131058301846,-0.244032835080,-0.252300182643,-0.314696432044,0.839277945314,-2.350346544843,0.300985087467,0.114269967428,-0.100966283356,0.001383037944 &
            ,-0.063046923728,0.037904542270,-0.183682666350,0.899006352922,-0.185126064764,0.402710081727,-0.176025815940,-2.537574080699,0.188071962701,0.776217439024,-0.171832391610,2.297104890742 &
            ,-1.714103385700,0.347961196539,-0.031517868191,-0.127177456212,0.248231505248,-0.430621861159,-1.089939266733,2.880702613435,0.348297020777,-0.688699595490,-0.043656077864,-0.748420930934 &
            ,-0.291026942312,-1.419908736577,0.337422963372,0.329393445782,-1.107601720990,0.006503340196,-0.232596147377,0.201693977203,-0.023538575973,-1.468997426403,-1.560495094197,2.484540090845 &
            ,0.255998416267,-0.046198222826,-0.054920028584,-0.420756860579,-0.128493022084,0.814697834892,0.255045263322,1.814369409100,-0.842924256919,-0.204944943469,0.109865878386,1.083224174671 &
            ,-0.234404884179,-1.756642046167,-0.832978231360,-1.409018898643,0.583392015481,0.088488274778,0.106804127975,-0.511731848803,0.165901348254,0.267753691812,0.469516625883,-1.867014806498 &
            ,-1.073099563556,0.609903328638,0.080787326216,0.031536436159,0.595731317545,-0.796969963832,-0.969303463379,-0.195506139559,1.207127367990,0.285416267707,0.166782281834,-1.857699966655 &
            ,0.583111897275,0.421317180702,1.438961420350,-0.649632291269,-1.243133916109,0.207325541380,-0.338273824293,-0.475561910412,0.176875371813,-1.839057162585,-1.742135890005,3.354697623738 &
            ,-1.186289095502,0.648592568846,-0.265696266792,-1.668173638907,0.412130624132,1.385364448721,-0.660950744116,6.841269897013,-0.152423582898,-0.007417646161,0.006364342377,-0.089447663755 &
            ,0.014309033621,0.024682079170,-0.047724877400,-0.025427708408,-0.085077728939,-0.109976728988,0.022416989410,-0.022690629810,-0.060783519156,-0.161420673354,0.057837413703,-0.127299172210 &
            ,0.014457246788,-0.049083262437,-0.010252304857,0.020583880472,-0.086984138646,0.161261569371,0.080496513591,0.240253330587,-0.332224450496,-0.049287118739,0.021155003463,0.005430015315 &
            ,0.033262792896,-0.377621284559,-0.155876361605,0.231469019375,-0.107247398056,0.233536346271,-0.060155924359,-0.206820454683,0.057006305037,0.273812601431,-0.188909564727,0.597306533545 &
            ,-0.361325155226,0.142781868205,-0.046814933090,-0.093778124567,0.074406645627,-0.138144258105,-0.376836032596,1.542345754333,0.061246432417,-0.432916682280,0.152954051158,0.272407979224 &
            ,-0.214347874878,-0.045000583896,0.555268468528,-1.905001103483,-0.203608766600,0.114310482930,0.061495640469,-0.160586950471,0.156188267527,-0.409830433631,0.017274210425,-0.067244679703 &
            ,0.043224861313,0.312088205647,-0.624265689292,2.409584742361,-0.188030036351,-1.524885934010,-3.256849371643,6.976123680430,-0.499272303830,0.928499201221,-0.020764431939,-1.149002338605 &
            ,0.753919955346,-1.060701912615,-0.399846723252,-0.449465403834,0.308836119603,-1.391359009366,0.620291322976,0.922233525909,-0.210326864644,-0.797372306541,2.636892059741,-5.240445057156 &
            ,1.346310450831,0.915481269421,0.040064810167,-0.924243875207,0.611147779782,-1.405678621027,0.646937016510,-1.026945385356,1.600199022306,-0.963257637366,-0.026959250657,-2.525079823051 &
            ,-0.870553598930,1.225844127640,2.657434478397,-5.753646825102,0.786003045703,1.796357601260,-0.100716079292,5.598875161843,1.118867992121,6.443246169524,1.248051591124,6.491898511682 &
            ,-0.740288224046,1.632439190970,-0.236626345304,3.104934044660,1.956104718055,1.033811994586,-1.178656443167,3.189289498231,-1.196794391573,2.190285968762,0.252276375244,3.935459015736 &
            ,3.616228716720,2.093668634856,2.137015267289,-0.979076898130,1.238057786664,2.145794614854,-0.250041958134,-1.383169842074,2.229460186602,3.057102867871,3.076103364463,-6.829383175228 &
            ,2.925457702315,-3.506946410743,-1.490435141482,-1.791451121794,-1.050969572659,-2.838260935592,0.605007143931,-1.566737940344,2.051211392592,0.027985723460,0.073571094043,-0.102314137938 &
            ,0.238763410827,2.414660696103,2.312472271004,-1.910743038516,0.494133233429,0.119042535298,-0.016540011189,0.922162499711,0.617081586347,0.591636084662,1.392701981807,-2.239774043963 &
            ,-1.072939745270,-0.782895221195,0.287630605317,1.243555386805,0.926112721541,1.365422821861,-0.182345732863,-2.186421830670,-1.420630739611,-0.918856120064,0.274446941807,0.444364721855 &
            ,-0.626346886445,-0.258323517905,-0.705263459593,-2.009682761395,-0.116236501372,-1.650907722810,-0.415994920489,-0.919459051040,0.302157776911,-3.390759133099,-0.376848348332,-2.270481426467 &
            ,0.815199044478,-0.257751460639,0.440368372808,-1.988318081789,-0.797821312750,-3.305854902165,-0.973138858908,-2.359188484464,1.610318677320,-1.039413608947,-0.934284627472,-3.187496147498 &
            ,-0.444430005877,-1.856895461287,0.184980804339,0.689770216916,2.846657583844,4.019900053706,-0.661006176391,-3.934133945207,0.316231313873,2.931311160140,-0.128279152456,9.308974843206 &
            ,-0.644374482801,-0.649607736078,0.215331962896,-0.018743214048,-0.137173645706,-0.965899045850,0.275747055721,-1.331646788093,0.464082395743,2.313658002817,0.046661417003,-0.065478193052 &
            ,2.001910910163,0.094561874697,0.168994935682,-1.334258670302,-0.019624708672,3.643921907785,-0.241214587288,-2.185792842217,2.762375153811,2.635947369716,-0.473070999239,0.318071958505 &
            ,0.995861026274,2.302112968540,-0.306627999850,1.946472065990,0.854558315348,-1.543623401792,-0.855290175826,3.530535645180,-1.868299780821,9.929151052537,0.337575955752,0.718729969114 &
            ,9.505158330646,-1.269649760934,-0.430542668588,1.210204973391,0.926931889380,6.308162279405,0.231283069612,1.050973005420,6.381352970582,1.285675545123,3.264186790907,-4.607506659646 &
            ,2.276701657129,1.046709228635,0.570074698064,3.361527738316,3.644850499120,-1.040186193560,7.503790323911,-5.183858309090,6.399990161567,-2.525658502149,-0.109343366234,-1.118779303939 &
            ,2.225838458717,-0.729109272517,18.001412892053,-3.967726033296,-5.369304328043,-3.189025950331,-0.114820725770,-1.324653852152,5.355936123590,-0.984953273973,11.874121774584,-6.449437304018 &
            ,11.595979795364,-2.174799206753,-6.456772802378,-3.170629199601,2.276271553086,-3.417358190420,-1.339487726632,-8.871250877770,4.741407733816,1.411841750233,-1.950741882979,3.538422592483 &
            ,0.253667791372,1.239463240623,-4.718594650581,-2.864911249318,1.025215646373,-0.513556479964,-0.087184893905,1.950721300927,1.074713978959,-0.995199837678,0.886876455156,0.759570419692 &
            ,0.281896833725,-0.341232796942,-0.425158448316,0.899272017807,1.489786803064,-1.185827809763,-0.513394803468,3.358348676302,1.634574280947,0.947108095112,-1.179816196615,1.217172006712 &
            ,2.287921789787,-4.323483952036,-4.070322449148,6.779161788319,-0.622444285498,-3.726392698850,-0.943008297920,0.441455975896,-1.700704718447,-5.126080237587,-3.169631692197,8.949712225856 &
            ,5.194978387057,-0.978699846712,-1.248022377062,-4.817097091718,-1.318501610746,-1.127265112285,-0.022885224952,5.077281346024,-1.965430835178,0.924912730049,0.061969025567,-4.849265362058 &
            ,1.302319193152,0.724261948670,0.976968853433,4.290730434144,-0.765726844400,4.086835470208,-0.034045367815,-0.582560108599,1.782669644291,4.551293753087,-0.404883165783,0.711358743053 &
            ,-0.601527099802,0.520554021222,-0.042661891066,-0.880255340532,0.373883894369,-0.561796786510,-0.654179832385,0.719462662537,0.142173130625,-0.527732396629,-0.007785381829,0.126101421929 &
            ,-0.363704669127,0.160925174347,0.298505456224,0.937153664529,0.026685645553,-0.264656446181,0.096464774630,0.124601114758,-0.122919113419,-0.215553867218,0.346172440092,-0.779726217631 &
            ,-0.463980086101,0.107697406926,0.019544888970,0.645638438181,0.172516753681,-0.049737783068,-0.454954995209,0.422159267294,0.393781926565,-0.461849020223,-0.047948338015,0.278633282582 &
            ,-0.542272923819,0.632450335696,0.223219056286,0.367403376722,0.002235512663,-0.367378131467,0.033768848242,0.230155245265,-0.271869428539,-0.487135711654,-0.111257003521,-0.441846998457 &
            ,-0.895816068474,0.060888852954,0.045416191823,0.485336104786,0.051305769762,-0.404575510838,-0.922697288791,0.539418744123,0.301557388387,0.190353700161,-0.125628581321,-0.098857256009 &
            ,-0.233343089767,0.725674353562,-0.727128269223,0.781305501400,-0.380637718059,0.291933376474,0.006913553850,-0.016850602476,-0.086132351840,-0.066949479071,-1.076919497087,0.715230371058 &
            ,-0.993759657302,0.271322145074,0.291762863328,0.602423558212,0.084233740213,-0.302570551842,-0.490857661456,1.317415386522,-0.031904637837,-0.265085112806,0.069066794450,0.112036294709 &
            ,-0.165434313398,-0.355562590230,0.142654463593,-0.382062314812,0.013426062034,0.218913114654,-0.022621813964,-0.037515601485,0.051689054610,0.078865112014,-0.138592402911,0.345368125554 &
            ,0.101713972710,0.155293673687,-0.008784897038,-0.233994658484,-0.006421249008,0.331376626693,0.084699659137,0.073828231001,-0.116699591006,0.128127465701,0.062456521920,-0.124265706294 &
            ,0.054747399196,0.047256563831,0.093085254994,-0.254067779073,-0.214742818202,0.021125598019,0.101443185407,-0.105068803962,0.038090202628,0.096294388437,0.236658210269,-0.434769989550 &
            ,0.062127205468,0.169574766669,0.038649419518,-0.115323171795,0.077445626076,0.598319190901,0.224971862888,-0.767552899740,0.162353113656,0.085756692168,-0.021489006814,-0.106777482197 &
            ,-0.029909021167,0.388688887347,0.126413548229,0.000115422070,-0.008104273549,-0.247319160118,0.038066952822,-0.118325579263,-0.080810242158,-0.389718997254,0.188088873566,0.188099304219 &
            ,0.473829082576,-0.172636530281,-0.006645650444,1.037520435180,-0.135450957820,-0.033571676793,0.133177183704,-0.116109332916,0.016082240227,-0.091269059619,0.012670287674,0.003602692004 &
            ,-0.063276013062,-0.053248589380,0.030677386806,-0.326850895700,0.064349293210,-0.020401333370,0.011273818934,0.503994680893,0.010793846261,0.129892456588,0.009211919875,-0.022758937245 &
            ,-0.014482116908,-0.066005596599,0.038744889962,0.172909346763,-0.001161271360,-0.087638419078,0.079895906550,0.058352344761,0.003966262077,-0.037244903548,-0.015793459412,-0.110409261252 &
            ,-0.031361775450,-0.152633313696,-0.091038459989,0.006109218599,0.234486975353,-0.008983392298,-0.063074986438,0.265034653888,-0.121041533536,0.151144930062,-0.096531964259,0.088789544299 &
            ,-0.543030755343,0.023778757606,0.060755255999,-0.193992419283,0.175507657024,-0.681513941203,-0.192118206960,1.217268908612,-0.271599932367,-0.173770679578,0.031534052396,0.468227841015 &
            ,-0.027330379554,-0.083358999603,-0.114525656974,0.593856266644,-0.286153938444,0.021255109202,0.018046867742,0.007699645842,0.089051878017,0.296058264898,-0.078016277577,0.670102315147 &
            ,-0.187480606727,-0.261347535746,0.051866756505,1.346168733703,-0.101309354672,-0.156060853784,-0.214469398483,0.046568433114,-0.002332421811,-0.070969529729,0.011184749569,0.066346206264 &
            ,-0.045407820960,0.046024554106,0.060963459770,-0.037277387274,-0.018089698774,-0.007587213716,0.008662730061,0.042758583673,0.000055047851,0.013522980473,0.017806800958,-0.050845866865 &
            ,-0.074214904491,-0.021245295931,0.012455434652,0.029318361682,0.003373042493,-0.031754662858,-0.014643077525,-0.038213023297,-0.080602109813,-0.009912638626,0.018680962160,0.150671751226 &
            ,0.014634436030,-0.009069182687,-0.026309690901,-0.084653458981,-0.007272705150,0.004923580081,0.004863524478,0.023120093692,0.001777747449,0.045859324205,0.002512608982,-0.152316327799 &
            ,-0.049120036960,0.035720418574,0.007856383177,-0.011545631495,0.030581742671,-0.017542084624,-0.014223144632,-0.015582260377,-0.026351717116,-0.105032188599,0.016414602584,0.121768805220 &
            ,-0.047826746117,-0.226500252044,0.007037835580,-0.039229502851,-0.039695885052,-0.024007986909,0.016893814952,0.004287832555,-0.003717715919,-0.008640309416,0.031370139807,-0.168580367513 &
            /),(/8,126/))
real, dimension(2,8) :: hidden1 = &
  Reshape((/0.82489,3.5052 &
            ,-19.5681,6.8803,6.9004,15.9858 &
            ,-1.4616,-0.35488 &
            ,-0.71149,-19.3766 &
            ,16.3765,0.30995 &
            ,-4.0297,-2.6427 &
            ,-0.82754,1.9412 &
            /),(/2,8/))
real, dimension(1,2) :: hidden2 = &
  Reshape((/7.1352,1.2477/),(/1,2/))
real, dimension(8) :: bias1 = &
  (/-6.003,-0.39071,1.7956,0.50881,-3.168,-1.1099,-0.40414,0.84704/)
real, dimension(2) :: bias2 = &
  (/-0.34971,0.67412/)
real, dimension(1) :: bias3 = &
  (/0.14601/)
contains
subroutine fnet_Beldan_initall()
end subroutine fnet_Beldan_initall
subroutine fnet_Beldan_engine(inarray, outarray, init)
  intrinsic MatMul, Size
  real, dimension(:), intent(in) :: inarray
  real, dimension(:), intent(inout) :: outarray
  real, dimension(126) :: inarray2
  real (kind=8), dimension(8) :: layer1
  real (kind=8), dimension(2) :: layer2
  real (kind=8), dimension(1) :: layer3
  integer , intent(inout) :: init
  integer :: i, j
  do i = 1, 126
    inarray2(i) = inarray(127-i)
  end do
  layer1 = MatMul(input,inarray2)
  layer1 = layer1 + bias1
  do i = 1, Size(layer1,1)
    layer1(i) = 1.0 / (1.0 + DEXP(-1.0 * layer1(i)))
  end do
  layer2 = MatMul(hidden1,layer1)
  layer2 = layer2 + bias2
  do i = 1, Size(layer2,1)
    layer2(i) = 1.0 / (1.0 + DEXP(-1.0 * layer2(i)))
  end do
  layer3 = MatMul(hidden2,layer2)
  layer3 = layer3 + bias3
  outarray(1) = layer3(1)
end subroutine fnet_Beldan_engine
end module fnet_Beldan
