module fnet_CCFB_intake

! a = 0.00035087
! b = 0.41613

intrinsic Reshape
real, dimension(8,126) :: input = &
  Reshape((/-0.036523745327,-0.014867249181,0.055274571681,0.350912066794,0.363467597163,0.174645965552,-0.314087703724,-0.421207726643,-0.156740152521,0.266627668977,0.029148545882,-0.077318893549 &
            ,-0.019106109571,-0.128317973093,-0.203769003740,0.112358657944,0.167149304544,-0.270966952583,0.046900575471,-0.172527052179,0.036498933752,-0.000787271744,-0.062715528112,0.186542662179 &
            ,0.144138211577,-0.238579055599,0.013632284589,-0.014590257740,-0.268119575085,-0.024018643655,0.448168844866,-0.003639854938,-0.340105447672,0.422844773355,0.135326754809,0.241343041415 &
            ,-0.078108051588,-0.109176950244,0.031381566640,-0.245483821515,-0.197513918641,0.738687343586,-0.051988531272,0.359533848443,0.289560879592,0.056770973636,-0.405541858716,-0.414892354548 &
            ,0.035507038929,0.016084864303,-0.001403508750,0.050532706571,-0.240623145327,-0.140598412266,0.299512337430,-0.057938599643,0.041300892948,-0.205309344934,0.043921233079,-0.086392847293 &
            ,-0.104619483827,0.023280508465,0.219691042799,0.108787117354,-0.072618563268,0.287629343462,-0.030341663910,0.248265530457,0.032763700169,-0.062229826325,0.058207562870,-0.270326307672 &
            ,0.130892375927,-0.781248125822,-0.097038619808,-0.089525482235,-0.289715446675,-0.194727831500,0.220875530988,0.128130239541,-0.020441779044,0.012257946815,-0.033906837628,0.125794001818 &
            ,-0.049287894199,-0.082927572174,0.038416973498,-0.132620606054,0.035732354451,-0.122635870060,0.025745233241,-0.053982029848,0.001934501330,-0.005925967664,-0.024603205391,0.057295008192 &
            ,0.021407894905,-0.038342959771,-0.009879754221,0.020017233253,-0.064616855413,-0.039970381224,0.077202376318,-0.026537225545,0.065459358079,-0.091621470974,-0.023635568541,-0.027739145151 &
            ,-0.007798274232,0.017153392856,0.016785111635,0.024697186060,0.138252151525,-0.206284351407,-0.001600211414,0.010830843586,0.023142293788,-0.018587879718,0.068274307379,-0.019193968838 &
            ,0.173486244156,-0.210866187560,-0.004337111234,-0.160829554471,0.025890644788,0.049452009764,0.126616624445,0.184532869271,0.032597741842,-0.086532779547,0.059662387177,-0.105692966546 &
            ,-0.053754068075,-0.036151278065,0.075833033807,0.117289190756,-0.021519983884,0.223063497819,-0.018027595622,0.026999994894,-0.178745168598,-0.013856874221,0.187243084863,-0.042882934323 &
            ,2.075947230967,-3.528799177033,-0.240305665647,-0.495394409389,-1.339080970596,-0.744773045129,3.087144650620,0.526120682728,-0.127666776232,0.839026886925,0.504544480142,0.570517335554 &
            ,-0.340613729365,-0.326465762337,0.938189704029,-0.768170645644,-1.614246127843,3.374918011646,0.815825544394,1.320030612644,2.829522330840,0.829367075417,-3.677291726660,-1.369813487331 &
            ,1.540663384358,-2.577207957343,-1.016812949228,-0.541640849623,-0.858761738892,-0.292244785863,1.630180337165,0.672046711060,1.280614851690,-1.985959545708,-0.055385658274,-0.443274060260 &
            ,-0.077029311643,-0.139058343588,0.538879169632,0.240003182930,-0.532882805405,2.152994300401,0.666197861007,0.677875780128,-0.225736036319,-1.094447209634,0.676372598808,-0.703583046872 &
            ,-0.093818589669,2.431021433271,-0.579218367143,0.312759902562,1.615091326922,0.239960898535,-1.680177904084,-0.410037190963,0.891115524316,0.863598865523,-0.175146090533,3.933740938782 &
            ,2.589602927116,-1.003062399996,-1.606361312695,-4.586238385398,0.129984933065,-2.034286956364,0.314444492477,1.418510560608,-0.085034716023,-1.616361376529,0.539751903392,-1.545270206484 &
            ,0.034424822849,2.382429784901,-0.738167634475,0.898511359310,1.063530507740,-0.166263094161,-0.951875220159,-0.990162332724,0.105254688276,0.279880981795,0.092720479110,0.145459302690 &
            ,0.565026485951,0.216067482785,-0.582231621219,-0.237296417634,-0.118929169963,0.376164247498,-0.208070156284,0.034646328755,-0.164918877095,-0.297022701708,-0.012533792780,0.029526056260 &
            ,0.044355311042,0.275959501884,0.033164510780,0.270674145560,0.530777542939,-0.006153261509,-0.551153694569,-0.279809333465,-0.056950274651,0.239812940152,0.007267980681,0.110939356105 &
            ,0.127933205652,-0.230992987663,-0.122369147485,-0.030721916430,-0.574101746066,1.519624251622,-0.215729630228,1.194984086802,0.648765026413,0.019928749841,-0.914308554276,-1.290058908599 &
            ,0.362740320857,-0.054378120884,-0.036688203149,0.439424080619,4.244817256423,1.297361123264,-5.449154134345,-0.569099839731,0.418946040105,-0.224452111805,-0.411164022501,-0.164296989343 &
            ,0.456293825432,0.037754608910,-0.926253034707,0.124479802199,-0.231281530444,0.923590157493,-0.245111557685,0.718453076556,0.797516609954,-0.080366465160,-1.577918128273,-0.824298362735 &
            ,-1.477130293275,1.200852690919,-1.154250358919,0.152113206756,0.922496572181,0.469540667809,-2.399033767078,0.123032216477,0.353284859939,0.298462115650,-0.338887728153,0.262693213547 &
            ,4.865616065252,2.144220944279,-5.136325142569,-0.182613137819,0.532191614675,-1.662633543853,-0.736904783274,-0.741550212167,4.739483449281,2.363360971282,-5.745380244112,1.019953996393 &
            ,0.814715135976,-2.075179932866,0.584153599864,-0.365462679284,1.031633739280,0.393520250264,-1.442255839982,0.262673143500,1.638868248540,-3.806157350865,-0.515112737188,-0.665693836643 &
            ,1.217375866154,0.637074952346,-1.713113147308,0.588266586812,1.953301279336,-3.997413799088,1.287020611723,-0.231732659277,-3.783705511328,-1.807133254796,4.606063796888,-0.282813064296 &
            ,0.852851149072,-2.767457377182,-0.257412375155,-0.569761488233,-4.425824743432,-1.921384179170,4.423385021207,0.403770180629,0.978572531965,-1.502223056598,0.099746839149,0.183637810658 &
            ,-4.176488077583,-2.153319010658,4.726638795745,-0.531344203949,1.195312364060,-2.073375629045,-0.754453749070,-1.721560587630,2.168721234863,1.406515102648,-1.602222949494,2.187037497259 &
            ,-0.289778674268,0.090918840094,0.489027370851,-1.476460194687,0.588542364857,0.385161527192,-0.236117972677,1.963371455146,0.012361030027,0.107662878378,0.187566877317,-0.194062080087 &
            ,-0.057822611015,-0.082563593629,0.145862859877,0.234228843093,-0.025361839262,0.269725973248,-0.164961631281,0.063617141438,0.917314967713,0.528100712672,-0.883436618329,-0.044244172598 &
            ,0.076432132121,-0.044302342550,0.024772779567,-0.155726783911,0.530736879655,0.321869608245,-0.364945242662,0.214772485020,-0.024377526669,-0.167642293598,0.124458733562,-0.187959853075 &
            ,0.451079964802,0.255150611022,-0.491265648733,0.248217274245,0.084214293365,-0.045235640652,-0.276866375585,-0.144357157280,0.816676513091,0.339337481225,-0.935875071125,0.221423065742 &
            ,-0.077022550236,0.178341078162,-0.157026075550,-0.013388580147,-0.218271656959,-0.062806864151,0.408422463353,0.080120267199,0.152639853151,-0.441881746694,0.204826215665,-0.242012245545 &
            ,-0.104745347849,0.092812466407,0.024373820805,0.215598268971,0.059165956156,0.463970585806,-0.156049087376,0.044054043903,1.080822695724,0.278361504265,-1.065714530773,0.005079026041 &
            ,-0.625590461465,7.830291960909,4.306403600211,1.516196890857,10.399882480792,1.776067905622,-11.366888054898,-2.255404923163,-0.393399761631,-1.087934539531,-0.049541716496,-1.411620406809 &
            ,-4.135790728140,3.933511189227,5.542544973261,1.722115445925,2.140679010758,-5.567240164496,-2.335045724822,0.110922341106,-3.935307106523,3.876337312234,7.080726032294,-0.196406428561 &
            ,-2.390131343796,-0.537079710122,-0.720627603275,2.206712987207,-3.782424563873,-0.557570193942,2.786732549753,-2.001861546301,-2.027150806017,7.368795865805,-5.183480199581,-5.055985767184 &
            ,-2.181181511853,0.761665200586,-1.033489390651,6.131937990954,-4.620754175086,8.392953940735,0.091550778126,-2.182073127351,-2.170653342240,2.751408661047,-2.350092646025,3.142128398893 &
            ,2.552588239758,-4.264147763746,2.233374945132,-0.058512912758,0.262734862965,3.220531361371,0.084280067070,-0.967674089196,4.026845847465,-10.047669011670,2.007799988412,10.839195703966 &
            ,3.685050968979,3.605660099033,8.136540022269,-11.216606137674,-0.542086926560,4.795265296703,-2.130620920481,1.488127405205,0.013601499286,15.495258360750,-1.228116561221,-2.266102796288 &
            ,0.171813152698,0.445449663837,-4.562005045197,0.259563715845,0.682595118740,6.908574798156,-1.236980847487,-1.020431752626,-1.123602548933,0.517710438326,1.434956331766,0.019739571220 &
            ,1.110392754190,1.005163035075,-0.273570242702,0.244051242299,-0.403640747890,1.333467078031,0.982796714515,-0.499717697527,-0.753165862815,0.978750954635,-0.978820164476,0.063179415601 &
            ,0.618941688749,1.230630014854,-0.541508336879,1.173684855639,-0.194485694076,2.741511841254,0.504444630315,-1.183718574170,-1.745329222074,-0.318119614059,-5.563919910654,0.425090619695 &
            ,1.729361745394,0.718217483115,1.083097760146,0.306714682391,-4.860883811908,-4.447534960987,-14.904537629526,-0.191199231385,-3.489817378047,-1.334413415849,-4.350139480866,4.481111552181 &
            ,6.593212723377,-8.734653421823,-18.930221906272,-2.382255437453,-4.025476400325,-1.914753834793,-5.418071324276,3.324557111686,2.199416057763,-8.727956489341,-9.500265422391,-0.709153860009 &
            ,1.131471381477,5.926093072731,0.988543287802,0.049090446492,0.435126063097,-0.453491904813,2.896678158596,-0.559122179757,-1.122378521157,0.796894142283,2.566517964238,0.121288726337 &
            ,-0.778537938630,-7.382502718204,-3.537520567954,-1.336958001047,-3.878287239427,1.681109181970,2.203320993040,2.246753945618,1.439298446109,0.180048789913,1.299556953866,0.277962181681 &
            ,4.086566804789,2.333181583180,-4.342625322665,-0.701043315935,-2.182824433122,2.554052810119,0.593345537380,0.722539162486,7.580240789134,7.557344555229,-9.145529130436,-0.439218565674 &
            ,0.418186668123,3.686084556948,-0.366161588279,-1.128035975953,-0.940013551784,7.215863354271,1.291878756226,1.146397931819,1.382884794420,-7.122785718060,0.235307740312,1.087070029150 &
            ,-2.249316827254,12.315815079277,3.612168534482,-1.405780000150,0.811533718813,-2.131981673527,2.644205401281,0.184721522902,-1.277434023276,17.119541604169,2.218827509016,-0.438483356565 &
            ,-0.829075446003,5.013945743505,-1.663334535582,-0.216002555806,-0.202395362129,25.593067503555,-0.161350942843,0.393958511168,0.606716526071,-1.508307992914,-0.804595334336,-1.588093496807 &
            ,-0.923853207243,21.246961893639,-0.388250542321,1.737672086627,0.236522175574,-0.422993500307,0.922815530942,-0.728037254684,-1.547166710612,22.966775082571,1.991290682310,0.859815943173 &
            ,0.304654378137,1.724593685869,-1.414618041826,0.377768146772,-0.213012020883,8.695839486283,1.058708213429,-0.361253368808,-0.188462653029,0.187926537518,-0.050869552992,0.534973955684 &
            ,-0.215126462620,-0.568137708814,0.006168093488,-0.654948200799,-0.010840472297,-0.668828711238,0.142935525205,0.184043458141,-0.253874642335,0.714057833328,0.330276171542,-0.146104044488 &
            ,-0.026060216807,0.426733656349,-0.005341763711,0.234711284288,0.001326366400,-0.554308771071,0.249993597158,-0.207733313121,0.098701055358,-0.527945531942,0.360949544690,0.750232452599 &
            ,-0.093019604823,0.373564493599,0.190685634998,-0.968669838323,-0.571898926243,4.071481676017,-0.796299827146,0.926926296792,-0.200890230311,-0.110966893282,-0.078665245682,-1.313304757056 &
            ,0.070790955831,0.107175421038,0.210163417434,2.198159409379,2.693922588133,1.119891279439,-2.170505228332,-2.429370535933,-0.023975095731,0.954684736236,0.017194842668,-1.409570700490 &
            ,-0.461473773798,0.059171748026,-0.128898496008,1.445288237328,-1.170676855633,1.510265402375,0.701501864480,0.938389390124,1.225710461383,0.118077097732,-1.927428321523,-0.942989780809 &
            ,0.745948322470,-1.701226235028,-0.021078211548,0.608892969438,0.273116828801,0.024701935560,0.413211895174,-0.724106987791,-0.026746654521,0.742116613369,-0.024447744845,-0.155169596974 &
            ,0.687080454879,0.089650220813,-0.887215438450,0.140127089463,0.342638493268,0.027883988743,-0.105149067441,-0.069157558477,1.201492773447,0.147575582507,-1.419806617948,0.073101451317 &
            ,0.379761825120,-1.940642455937,-0.331320202069,-0.123993452319,-1.157573640021,-0.539199866693,1.508916434427,0.215992305195,0.191919578480,0.749762166341,0.331482215515,-0.639218759826 &
            ,0.650340400845,-0.371806255950,-0.738553593746,0.646113166072,0.177186615354,-0.039329301032,0.104188800561,-0.147259651669,0.433751870059,-0.639020531300,-0.282803699649,0.153701848621 &
            ,-0.012115900535,0.355196914408,-0.079924417409,0.264547903132,0.040659338031,-1.099635440392,0.132447518673,-0.310697695847,0.543603153569,-0.062753359131,0.234643372166,-0.168255575327 &
            ,1.864495386299,-0.511804328360,-2.084167038936,0.058337342845,0.188310797339,-1.324268860350,0.513583480913,0.709661181174,0.195263811551,-2.168898848499,0.279456028428,-0.712222805323 &
            ,0.091470652774,-0.692841131208,0.092337840839,0.019520073475,-0.148407632411,-1.038480559671,0.239710418108,0.131514626461,0.200232905266,-0.277221845150,0.169434828281,-0.262741837824 &
            ,0.335583273263,0.120192429972,-0.359010753035,0.289317786937,0.085733454433,-0.145068569706,-0.022898278690,-0.003054302528,0.121211786416,-0.081310173604,-0.155351973983,0.015428815997 &
            ,0.059936539676,-0.079383254755,0.040555133833,-0.131024510715,0.076682416102,0.063513710258,-0.078787049567,0.139996501362,0.032504486975,-0.673019616225,-0.023233454277,-0.225102700900 &
            ,-0.116597387564,0.035761689666,0.000548722213,0.274567283800,-0.133382551739,-0.175387571661,0.315692157892,-0.118513537014,-0.349430172049,-0.359561242299,0.367036175325,0.207342026345 &
            ,0.175442729223,-1.780520599791,-0.094153992771,-0.416941046645,-2.504989852011,-1.232112893662,2.759020030517,0.612132321016,-0.113415837715,0.414199887215,0.345551236272,0.149964799319 &
            ,-0.753571958950,-1.038943081916,0.534890498656,-0.121939022987,0.311021761402,-0.188849957219,0.067511531673,-0.291988821704,0.144431351653,-0.335523554310,-0.587022474301,0.318666114780 &
            ,-0.019316055585,-0.187286040635,-0.234031646451,-0.127630199185,-0.334432667833,-0.124653764363,0.135978184207,0.149025427977,0.140103671847,-0.096132020251,-0.319627744630,-0.049187776868 &
            ,-0.479489839849,-0.118696195190,0.461462000397,0.047290339463,0.052361599312,-0.670677840801,-0.097651348160,-0.117879582519,-0.378970792345,-0.023670476283,0.333923853019,0.128182081688 &
            ,-0.028437317130,-0.041811537969,-0.115595017092,-0.168838584542,-0.542508426768,-0.200082327651,0.443731801470,0.182737168773,0.035368967021,0.135955457723,-0.314437482779,0.244249953113 &
            ,-0.570052013886,-0.215854549635,0.547714068302,-0.277643316314,-0.064514554127,-0.261111664666,-0.372667091961,0.430690277088,-0.898716237446,-0.271819743375,0.767524997615,-0.494981318659 &
            ,-0.298584792341,0.681493390168,-0.359858520055,0.627582123215,-0.862670931771,-0.148654637077,0.575944405329,-0.779164930438,-0.047383316807,0.647291827798,-0.063960798588,0.240212101410 &
            ,-0.627969728674,-0.267582153241,0.798288822977,-0.262947776144,-0.341328764582,1.186267937011,-0.026435229235,0.209943376315,-0.171889507606,-0.001991109314,0.062198022163,-0.223275605041 &
            ,-0.424819512090,1.009302246801,0.413685859688,0.002294439210,-0.730743079786,0.137235186153,0.863376788566,-0.054397497713,0.029193264754,-0.096123777805,0.056321969753,-0.025416181134 &
            ,-0.001738993012,-0.007582736557,-0.003210122559,0.021956977288,-0.022587546424,0.009432740178,0.040500742943,-0.024564635234,0.002692319332,0.040106937714,-0.016140549929,0.019844520482 &
            ,-0.056480262137,0.114319840376,0.010751238839,0.051255646623,0.005741878273,0.046952294958,-0.000259038231,-0.063311563444,-0.053167675060,0.081272940705,0.049633437242,-0.009041234068 &
            ,-0.006191805537,0.025965922596,0.012259124782,0.006949148401,-0.078780100067,0.230384713133,0.025274938003,0.050608851062,0.039891087769,-0.019899985238,-0.045427090290,-0.049898562621 &
            ,-0.078387190125,0.219379132203,-0.015592959361,0.061904482434,0.002618295245,-0.027735219411,-0.025120562891,-0.060919843546,-0.065852428993,0.161358560454,0.006581979963,0.071623188893 &
            ,0.169389489017,0.063373721964,-0.181636571035,-0.074284378428,-0.076466582444,-0.053267554162,0.159120833894,0.012819580790,-0.074081972873,-0.024582492045,0.088805543906,-0.016235850897 &
            /),(/8,126/))
real, dimension(2,8) :: hidden1 = &
  Reshape((/-1.2304,-6.1052 &
            ,-0.3007,-2.3048,-3.6133,-15.0376 &
            ,-13.6329,-6.9411 &
            ,2.48,5.1655 &
            ,-3.4839,-0.59268 &
            ,0.34395,6.7731 &
            ,-11.7175,-5.534 &
            /),(/2,8/))
real, dimension(1,2) :: hidden2 = &
  Reshape((/9.6867,7.6336/),(/1,2/))
real, dimension(8) :: bias1 = &
  (/-6.6517,7.2786,4.9048,-5.5819,-7.807,-14.4766,8.5906,5.9763/)
real, dimension(2) :: bias2 = &
  (/10.6263,-0.21845/)
real, dimension(1) :: bias3 = &
  (/0.44987/)
contains
subroutine fnet_CCFB_intake_initall()
end subroutine fnet_CCFB_intake_initall
subroutine fnet_CCFB_intake_engine(inarray, outarray, init)
  intrinsic MatMul, Size
  real, dimension(:), intent(in) :: inarray
  real, dimension(:), intent(inout) :: outarray
  real, dimension(126) :: inarray2
  real (kind=8), dimension(8) :: layer1
  real (kind=8), dimension(2) :: layer2
  real (kind=8), dimension(1) :: layer3
  integer , intent(inout) :: init
  integer :: i, j
  do i = 1, 126
    inarray2(i) = inarray(127-i)
  end do
  layer1 = MatMul(input,inarray2)
  layer1 = layer1 + bias1
  do i = 1, Size(layer1,1)
    layer1(i) = 1.0 / (1.0 + DEXP(-1.0 * layer1(i)))
  end do
  layer2 = MatMul(hidden1,layer1)
  layer2 = layer2 + bias2
  do i = 1, Size(layer2,1)
    layer2(i) = 1.0 / (1.0 + DEXP(-1.0 * layer2(i)))
  end do
  layer3 = MatMul(hidden2,layer2)
  layer3 = layer3 + bias3
  outarray(1) = layer3(1)
end subroutine fnet_CCFB_intake_engine
end module fnet_CCFB_intake
