module fnet_CVP_intake

! a = 0.00037476
! b = 0.43766

intrinsic Reshape
real, dimension(8,126) :: input = &
  Reshape((/0.035832673550,-0.121476435606,0.094631151273,-0.094687455887,-0.093976598947,0.064001102818,-0.109688280818,-0.065451221172,-0.170603826408,-0.018369024892,-0.174564359022,0.068934268870 &
            ,-0.053034849447,-0.120031146226,0.167557658566,0.396859454158,0.008580931151,-0.032458207936,0.016797953257,0.079152773446,0.001456086497,-0.039445519280,-0.025495679747,0.055918662661 &
            ,-0.016519537816,0.015893648217,-0.019370060881,0.101995369441,-0.024910466890,-0.043823319326,0.024636995129,-0.592054883361,0.245662950920,0.368779158629,0.042005046266,-0.030484968047 &
            ,0.401973003503,0.120236411735,0.024352022700,-0.732077186944,0.104032094975,0.116117722911,0.011561515002,-0.099709912230,0.169599148600,0.080727587437,0.011938313496,-0.333757851095 &
            ,-0.057691399336,0.122257770546,0.008058986799,0.290274248321,-0.034153215348,-0.093968479000,-0.031895592392,-0.878084818646,-0.030838630894,-0.157975128093,-0.005238325188,0.228635522893 &
            ,-0.129323054437,-0.130827039162,0.011841774009,0.231584027590,0.083379285504,0.005153850243,0.017741800818,-0.033066909148,0.114130143435,0.069087931232,-0.012610780859,0.056837789311 &
            ,-0.047444678574,0.122949249223,0.009029490991,0.123695522974,0.020261904555,-0.040076321674,-0.043221797151,-0.732791870382,0.018642002947,0.108054218176,0.027340001515,-0.014197392197 &
            ,0.042440698895,0.051517901642,-0.030741340156,-0.058791618121,0.000643408914,-0.004266463168,-0.005066437562,-0.088835995349,0.002012907271,0.029015747296,0.007481537441,0.015708140526 &
            ,0.012379904912,0.024965178161,0.005317347774,-0.088343859512,0.026520561635,0.036361812500,-0.004181258729,-0.004287121223,-0.028975892337,-0.071207986762,-0.008433495412,-0.155027979027 &
            ,-0.041596805888,0.051989022820,-0.004508599954,0.291175287169,0.017608975508,-0.079084034925,0.005748610381,0.094732230896,0.005967781755,-0.060548694880,-0.008344800816,0.723313490302 &
            ,0.010647786624,-0.082360209083,-0.010835744889,0.026052113123,0.000886704767,-0.023842110494,0.011316999010,0.325806619292,0.046651894569,-0.074166673281,0.004129448667,0.250002391678 &
            ,0.026439243004,-0.113350242491,0.007837523617,-0.045482392562,0.062987050874,0.108798446145,0.008232611847,-0.243839782759,0.084271555799,0.164181470280,0.015885604824,-0.002176428503 &
            ,0.163479000525,0.617297872996,0.222101347186,-1.798241667989,0.345413308890,1.119797796512,-0.288488804226,0.900797932961,-0.501537359432,-0.437039224268,-0.274971804850,-1.793109873651 &
            ,-0.637399631885,0.568576675192,0.231214054562,-0.785259042099,-0.006579264800,-0.353229190921,0.016659548124,0.047996146731,-0.481647391158,-0.088564725957,0.073208132438,-1.865406516748 &
            ,-0.057558440324,1.082729872572,0.024490130418,-0.096158636681,0.524411075566,0.348325334515,-0.098838614223,0.233462895542,0.897472140370,0.281639549884,0.662217776353,-1.394236033091 &
            ,0.930751487927,0.891078805406,-0.682171725231,0.986067929085,-0.164973403266,-0.539730069768,0.043621560872,0.926421518710,-0.450844236883,-0.454002547816,-0.113457088455,-0.569043511505 &
            ,-0.574279081533,-0.126158604819,-0.086583992803,-0.705992513822,-0.456116806684,0.284445138058,-0.118338693622,1.434730290347,-0.522743455277,-0.479317752358,0.226875736306,-1.698516924460 &
            ,-0.986605214059,1.414076422995,-0.593925449187,0.995503395796,0.194605581033,0.306782322284,0.112979029103,1.240430561427,0.272292421919,-0.223691326175,-0.070540931711,-0.930353887569 &
            ,-0.290631231726,0.226795497603,-0.131834884857,-1.170716069889,0.019711730927,0.622639300505,0.016005542607,0.326368021206,-0.472465255083,-0.409992044629,-0.271872453202,-0.357792568046 &
            ,-0.521689415808,-0.073450037408,0.197975762760,0.371873064726,-0.243407749203,-0.122516447735,-0.085392867913,0.048905340030,-0.255579599998,-0.042271823064,0.014094013301,-0.031892996948 &
            ,-0.334558933376,0.026968241900,-0.156690439039,-0.109697207187,-0.304490096420,-0.000317324335,0.102626528685,0.020985688121,-0.172541500247,0.236935002657,-0.053898994481,0.021351812302 &
            ,-0.055472102257,-0.022243703307,0.008132659110,-0.267998132544,-0.144978059416,0.031958262417,0.120165647320,-0.776299306874,-0.215125289348,0.385822758504,-0.229087247492,0.770052951954 &
            ,-0.041264934568,0.162585640656,-0.006750362297,-0.636701443692,0.021953402732,0.330678987989,-0.016343845213,0.091830543345,-0.367207544088,-0.259292350663,-0.172649218921,-1.021831074305 &
            ,-0.436523601396,0.291928822004,0.114484485576,0.681595603167,-0.086841017397,-0.510237565785,0.090287995337,-1.495829649436,-0.260839260316,0.537000254628,-0.226898418006,1.271160459875 &
            ,0.110139844842,0.651582059729,0.535651828767,0.430038340827,0.169646517517,0.056498379132,-0.745257614445,0.476840293690,-0.158051037841,-0.114679796269,0.426125413030,1.059632835429 &
            ,-0.716429740078,-0.285662756998,-0.556978672617,-0.768218211691,0.073094480697,0.615907859578,0.604657986635,1.205044855139,-0.173108028222,-0.045284667610,-0.783658417874,-0.008843470789 &
            ,-0.168267126839,-1.018315895649,0.073996846848,-0.506740547272,-0.726166843844,0.078829438525,-0.162840507662,-0.986972021999,0.185784542674,-0.254793706162,-0.033538717747,-1.283287697236 &
            ,0.322158500125,0.362918890530,0.018146589482,-2.241526842294,0.339906352197,-1.382232094587,-0.536537172126,-2.476455728471,0.353853343494,0.389161955192,0.779490380260,-2.459392678267 &
            ,0.448442212890,-0.056355049929,-0.252745116791,-2.422714306063,1.024573582857,0.593133993266,0.379847727307,-1.084812648692,0.051867366878,-0.896135756618,-0.419511259200,-2.429835984162 &
            ,0.198657804922,0.337691727796,0.539942905773,-1.416514845410,0.083563900618,1.721030211157,0.207970039425,0.488809535555,0.450849017206,0.498723949454,-0.158892566846,1.661379401365 &
            ,-0.131752788260,1.012094941287,0.256295046309,0.799332067351,-0.305646612921,0.452070934447,-0.248286299874,3.034038903656,-0.062265170272,0.174965490431,-0.068626582823,0.134152490949 &
            ,-0.026571740112,0.024182047537,0.096212657624,-0.122902230747,0.038096241693,0.119862867635,0.068284014192,0.147557246883,0.044619834712,-0.008031496214,-0.074804791127,0.248559588425 &
            ,0.091090299024,0.174360339047,0.123835286511,0.350548835916,0.058212699090,-0.010116128604,-0.122745559098,0.265331545632,-0.238956470461,0.089714863912,-0.084287225221,-0.194332555671 &
            ,-0.250209455451,0.045664980078,0.068316968800,0.224605687519,0.079262852575,0.187029939702,0.086142876728,0.387361383203,0.115586815629,-0.070255503126,-0.091496550744,-0.093709216918 &
            ,0.080790036016,0.138388953285,0.086688025367,0.427075072706,0.040795508627,0.019768544481,-0.081278013082,0.374448439464,0.098717460166,0.054584835860,0.088461865901,0.050598061958 &
            ,0.092768526714,-0.038156770214,-0.090548133721,-0.465442804541,-0.190273509408,0.153200649661,-0.118960196322,-0.256438357374,-0.137835382411,0.115101957937,0.123438442823,0.174171460118 &
            ,-1.364579816625,0.537929153637,-2.017315577418,-2.675393243144,-0.036391628666,0.531949974498,2.188247776600,12.724906292650,-0.820651037635,-2.201466715246,0.174408006974,7.134723308199 &
            ,-2.823311290468,-2.681968224483,-0.189909997403,6.229528443635,1.662562290431,-1.202182348780,1.121176824558,1.970408049129,0.295361977469,-0.396099755080,-0.786574103160,2.816105357789 &
            ,1.170411735755,1.096411953291,0.428954774680,2.967261595793,1.328331613422,-2.477791810482,-0.086181582454,-4.745272798598,1.098583256231,6.308560821158,0.515921107869,5.139435008414 &
            ,4.879770993015,-3.731996972671,-0.537664379881,-10.106662267995,0.005614006885,1.173813079361,0.669925165069,-1.501071001415,1.255088474356,-2.721118540804,-1.209976111674,-0.136184288729 &
            ,0.415582626552,-1.579170534291,0.123632564532,-1.267401701004,-1.073069133473,1.070965380309,0.108473201881,9.432688661657,-6.405132513196,1.023454757039,-3.445085076379,5.947118700307 &
            ,-2.900219256636,-6.186182916652,2.123952922197,15.389551119090,4.682062687392,-1.404294820259,1.956415806888,6.214220823655,1.550940566163,-4.778217922161,-0.334603174345,2.076439555385 &
            ,0.705374405011,2.187797593008,0.703949764370,3.289545932863,2.155477567162,-0.814634019978,-0.926163699638,0.231851225326,0.158634523196,2.191986482559,-0.008635466963,-5.121795562828 &
            ,1.822977942406,2.047011323557,-0.265782405009,0.680019221434,0.683016727922,1.714689389017,-0.090285744505,-3.192879589114,1.682348870321,1.525057070642,0.329815446705,-0.182432091739 &
            ,0.786834635184,2.322137548416,-0.682443085306,-1.217135970398,1.872978192831,1.292143846272,1.222647637937,-0.297921409413,2.676984828049,4.448403514472,2.023450896984,-1.115247739817 &
            ,3.783568163088,1.350826143394,-2.066047729960,-4.839736047983,2.705942735368,5.633182304226,7.308206236929,-1.837435421528,3.390001745992,3.771457097211,-9.947088186975,-4.503332279081 &
            ,2.435283833897,2.584606206103,4.981858241115,-3.481532193356,2.289240469937,2.252545737478,-6.252518933187,0.839594569078,0.642330778438,-1.189440390155,0.152858780834,-3.192312329576 &
            ,0.619434944145,-2.012099758272,0.320878464584,1.308629884357,-2.637554600277,-2.885552719169,-1.605069538077,1.901932386013,-3.008970174529,-0.738386550182,1.096672646312,-0.546231024978 &
            ,0.139930005013,0.122548784609,0.389208375410,-2.342892396811,0.175158380099,0.756998023345,-0.537143299877,-7.728536479540,-0.562824329068,-0.838927039407,-0.621871429097,-2.079981132859 &
            ,-1.172697122825,-0.892226914080,0.929735644931,8.995544919502,-0.497080325116,-0.279502249799,-0.419613957076,0.188551516096,-1.233995638108,-1.416108857341,0.808874061254,10.832517478852 &
            ,-0.842523777877,0.611485725503,-0.621765911542,-0.140999829135,0.067510647656,-1.201600365754,0.426851972026,2.714849898001,2.294327583675,-0.861848129918,1.638021356674,0.509696250452 &
            ,0.026187682897,-4.489626247185,-0.697707219034,3.183608192515,0.284037963119,-0.117212386583,0.076152280863,3.045330893723,-0.515857661476,-4.914105947039,0.424504113060,-0.005754054442 &
            ,-0.461489231223,0.546356504257,-0.239832105486,-0.020970267619,-0.235189478254,-6.736513546958,0.434679177419,1.653124791890,2.180900076644,-1.491826899748,1.376715832713,9.154214002113 &
            ,-1.850178355528,-12.742076262255,0.388498144992,-1.436851836839,1.070387091165,-0.566276725530,0.831047232026,8.220207490345,-0.904757174909,-7.553334884243,-0.033475343970,-0.449513787743 &
            ,0.139817031699,-0.480788419877,0.146212571185,-0.296325726268,-0.783260392721,-1.983507344272,0.152041922616,-0.040737849853,-0.144075978797,-0.781769659742,-0.016460716151,0.623249212183 &
            ,-0.720207217226,-0.209475948005,0.042211682345,-0.098325994794,-0.497580666968,-0.633527239032,-0.161762012045,1.221069398051,-0.749948916542,-0.638616858910,0.047080940324,0.009684786147 &
            ,-0.430140405178,-0.588577140733,-0.052281798260,0.660821732254,-0.801746552006,-0.645947391653,-0.010199564123,0.207713828467,-0.684000542695,-1.026580792184,-0.248546779487,1.161432126759 &
            ,-0.898459283972,-0.747901385508,0.061473344303,1.552264273654,-0.343133718775,-0.346193178889,0.106751016396,-2.060757090292,-0.593343256172,1.070491253569,-0.314787950922,-0.671262052785 &
            ,0.034226092056,0.935664516856,-0.038885869483,-3.849011243767,0.652826050564,0.854782315429,0.082812564543,-0.990682935934,-0.195804245867,-0.089495023672,0.020987113723,-0.301399862900 &
            ,-0.117210191723,0.119436753710,-0.193861748988,-0.455846151979,0.385160829591,-0.118793455615,0.230694182791,0.909069496939,-0.097635139093,-0.179588927465,-0.059679635288,0.696980841270 &
            ,-0.124201697076,0.099656318710,-0.000038223281,-0.443158232408,-0.195251717504,0.249789969493,-0.002469135944,0.516813068850,0.037764831479,-0.011157334680,0.012285114801,-0.038429813406 &
            ,0.053678543145,0.098080748142,-0.017769450171,-0.431107284007,0.324290068350,0.414369020825,0.171473382069,-0.676934013402,0.568539748401,0.453774282068,-0.190961841938,0.267762464878 &
            ,-0.375000357111,-0.379503155948,-0.064762518868,0.068830867764,-0.659579015710,-0.038798712442,0.009945706817,0.685936349467,0.259307265704,0.049939432633,0.158576088294,0.544900392418 &
            ,0.341504948902,0.112927106932,-0.201402158638,0.095875161620,-0.038267884741,-0.268296265077,-0.097659846070,-0.361927670578,-0.088632240221,0.217465109759,0.124230764091,1.225067573365 &
            ,-0.344420320161,-0.127060825935,-0.073718019099,-0.723942703988,-0.421858229542,0.505792034639,-0.005723476472,0.175038000310,0.149274324826,-0.176607706600,0.084379769920,-0.479462766688 &
            ,0.082178413442,0.934397081570,-0.135668738601,1.433279388174,-0.203258581770,-0.248062397176,-0.089047520312,0.762778444954,-0.328924796410,0.048709676334,0.041925196911,-0.749963848337 &
            ,-0.192976383247,0.191710689870,0.057725231598,0.449312354809,-0.188163859975,0.056172731046,-0.153848136677,-0.891004068342,-0.054237078257,-0.133929700053,-0.048730087869,-0.123786207394 &
            ,-0.091317220178,0.029541693551,0.044085997122,0.247269264035,0.066297156120,-0.148275696077,0.073019763749,0.218450251389,-0.050895743702,-0.087864281623,-0.068238176995,0.032750630627 &
            ,0.084412829958,0.079136525174,0.062890217630,0.350743354114,0.088691001642,-0.055403507392,-0.063495636362,-0.376339616577,0.031070992482,0.134103377636,-0.019051610035,0.340407360281 &
            ,0.093156387430,-0.139400701886,0.038820222759,-1.104616120926,-0.154388835676,0.264638444281,-0.168708936049,0.258165502054,-0.015120245453,-0.083335240373,0.193543899144,-1.376302294421 &
            ,-0.344562589227,0.296412763695,-0.344273504966,-0.421919721572,-0.094294855648,0.157161621190,0.355173943668,-0.697742845503,-0.556980006180,-0.014362736425,-0.398054879201,-0.745549119520 &
            ,-0.421776667937,0.318496497822,0.340075513762,0.466454681737,-0.446775171036,0.107968365084,-0.248098033287,-1.119773892986,-0.322460219416,0.495967567951,0.169328956690,0.569538875682 &
            ,0.256417956235,0.416262888562,0.063496258791,-0.301911240992,0.502633557470,0.266817667118,-0.033265065618,-0.125234986912,0.091286047082,0.220582463728,-0.006783677941,-0.395951998759 &
            ,0.214586084883,0.221653699545,0.034968688266,-0.106797049639,-0.083028588687,0.125054181008,-0.027548125238,-0.032105853430,-0.027349653434,-0.030978535952,0.024830718169,-0.209723069030 &
            ,0.007917646782,0.128402357951,0.024026130293,-0.178945805478,0.060579633841,0.121370935489,-0.040693967309,0.015814281028,-0.073608625661,0.101188377496,-0.015324462210,-0.401192781559 &
            ,0.054634969420,0.078181119456,-0.031720471886,-0.024785031916,0.063884470385,0.018776226299,0.016976299999,-0.802427531099,0.128181809333,0.304048728650,-0.029844474358,0.068886249455 &
            ,0.129843300009,0.082413354056,0.012900734624,-0.497024149823,0.115014090090,0.248753996674,0.038827194772,0.071378109293,-0.129252271984,-0.043175903610,-0.152691010305,-0.688954291743 &
            ,-0.124192550977,0.195865507535,0.185212258255,0.412898830290,-0.175210306942,-0.007993311263,-0.102233421539,-0.036639893466,-0.196075933048,-0.005282669197,0.092187778056,1.380365971202 &
            ,-0.076335988279,-0.258376204834,0.022655100299,0.485001981695,-0.353220459967,-0.214023046427,0.000405714628,1.924102424084,-0.000287400255,-0.059839268887,0.004518862336,-0.019125245761 &
            ,-0.038945483615,-0.019537055591,0.001168089649,0.050239138301,-0.009684278447,-0.052768801739,-0.017979788074,0.043342206778,-0.019741199533,-0.051732332009,0.022767547034,0.154284833252 &
            ,-0.009678978012,-0.052784602009,-0.006947776986,0.031623437105,-0.031543814734,-0.030572441112,0.009096527418,0.113487572970,-0.031911958258,-0.070769135643,-0.033177466272,0.115828878791 &
            ,-0.041894820221,-0.084922960357,0.035174779016,0.258113393294,-0.006084859040,-0.036097681540,0.005185668296,0.091719478208,-0.033075841096,-0.041630229547,-0.005397482465,0.221018670645 &
            ,-0.021704698119,-0.030360259651,-0.027690130937,0.080614878987,-0.024450395740,-0.048965902995,0.032792932942,0.218786582845,0.016951800277,-0.018454192755,0.007559167126,0.062079339439 &
            ,0.005517834370,-0.029403384755,-0.003110334980,0.148760223709,-0.030554346538,-0.003533273802,-0.056516474706,0.119542135165,-0.032117546033,-0.080974921610,0.080921604724,-0.341343391552 &
            /),(/8,126/))
real, dimension(2,8) :: hidden1 = &
  Reshape((/2.3267,6.7647 &
            ,4.6468,4.9135,6.82,-5.6501 &
            ,-3.655,-3.2916 &
            ,-4.0597,-5.8082 &
            ,-8.9981,-8.0038 &
            ,4.0142,-4.7071 &
            ,8.7744,7.4622 &
            /),(/2,8/))
real, dimension(1,2) :: hidden2 = &
  Reshape((/4.1568,-5.596/),(/1,2/))
real, dimension(8) :: bias1 = &
  (/1.0198,-2.6497,-2.7415,9.9248,1.5902,-1.4303,3.9758,-1.9988/)
real, dimension(2) :: bias2 = &
  (/-9.248,0.78678/)
real, dimension(1) :: bias3 = &
  (/1.901/)
contains
subroutine fnet_CVP_intake_initall()
end subroutine fnet_CVP_intake_initall
subroutine fnet_CVP_intake_engine(inarray, outarray, init)
  intrinsic MatMul, Size
  real, dimension(:), intent(in) :: inarray
  real, dimension(:), intent(inout) :: outarray
  real, dimension(126) :: inarray2
  real (kind=8), dimension(8) :: layer1
  real (kind=8), dimension(2) :: layer2
  real (kind=8), dimension(1) :: layer3
  integer , intent(inout) :: init
  integer :: i, j
  do i = 1, 126
    inarray2(i) = inarray(127-i)
  end do
  layer1 = MatMul(input,inarray2)
  layer1 = layer1 + bias1
  do i = 1, Size(layer1,1)
    layer1(i) = 1.0 / (1.0 + DEXP(-1.0 * layer1(i)))
  end do
  layer2 = MatMul(hidden1,layer1)
  layer2 = layer2 + bias2
  do i = 1, Size(layer2,1)
    layer2(i) = 1.0 / (1.0 + DEXP(-1.0 * layer2(i)))
  end do
  layer3 = MatMul(hidden2,layer2)
  layer3 = layer3 + bias3
  outarray(1) = layer3(1)
end subroutine fnet_CVP_intake_engine
end module fnet_CVP_intake
