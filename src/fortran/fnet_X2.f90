module fnet_X2

! a = 0.014731
! b = -0.55292

intrinsic Reshape
real, dimension(8,126) :: input = &
  Reshape((/-0.050348497029,-0.092429675394,-0.120077372114,0.000112902190,-0.029856281011,-0.156793719898,0.048000113480,-0.025467696276,0.106372388454,0.050714356197,0.088896973788,-0.027228584402 &
            ,0.022265046119,0.016813110056,0.000871670740,0.039755221904,-0.222320098685,-0.110878763743,-0.245910027708,0.005235766001,-0.092510382902,-0.150984236060,0.041442248294,-0.023951966067 &
            ,-0.018912167228,0.017783162503,-0.090072253003,0.027048196977,0.004871518501,-0.275204807354,-0.007551882203,-0.012983546364,0.116728150083,0.207006200421,0.362873581370,0.017592162613 &
            ,0.087105265898,0.202886153140,-0.172241142151,0.056181587467,0.105560333524,-0.269024182750,0.091046728433,-0.083659091931,0.007229943203,0.404009605347,0.063028814852,-0.051362801341 &
            ,-0.120873738064,-0.061272115935,-0.400747596491,-0.005283482462,-0.088531143455,-0.798576502613,0.199226130611,-0.025386779052,-0.035097378029,0.180707194381,0.341967670062,0.161031801560 &
            ,0.052270332977,2.661107751489,-0.292857109783,0.007853301241,0.035330435905,-0.031680405687,-0.041531751726,-0.116338793249,-0.011775692045,-1.306840727202,0.034370320690,0.036631273227 &
            ,-0.112731011715,-0.013571990334,-0.354450168172,-0.023919327047,-0.142325039040,0.071528223227,0.141244604626,0.006764357897,0.012425982363,-0.055974865624,0.060461405589,-0.013739574182 &
            ,0.009789076716,0.361212254952,-0.020980920069,-0.015624354954,-0.112932028209,0.119753178963,-0.059441064231,0.036014138490,0.008124468290,0.425589358578,-0.064266598675,0.003809100584 &
            ,-0.121126570212,0.317265927884,-0.116129356264,0.081687676953,0.007668189048,0.463731964522,-0.068779687311,0.034212366739,0.032386764649,-0.135905214893,0.046089533551,-0.021804689855 &
            ,0.034100266947,0.277414057210,-0.050355064987,-0.012185119515,-0.033933874968,-0.161136537166,-0.117562109377,-0.012442589475,-0.031486252914,-0.083460834937,0.038546637525,-0.001722349537 &
            ,0.081933434169,-0.227934637789,0.061595343547,-0.053331421237,0.018404517818,-0.479661344654,0.001485202461,-0.025725466056,-0.027330595624,0.137354805451,0.034201838390,0.069855960206 &
            ,0.038380506532,0.492320758628,-0.057607238502,-0.043239636243,0.112610951103,0.236415101308,-0.080011965431,0.015212892615,0.001171158250,0.394684389567,0.182946348786,0.024812439218 &
            ,-0.505161684311,-0.474520626849,-0.412226479619,-0.182328603830,-0.194072033905,-2.931933553967,-0.156971738350,0.048075540537,0.350829809969,0.400238377861,0.404167239574,0.297866497696 &
            ,0.125812974262,1.201572699685,0.138785263088,-0.195298926991,-0.332737344189,0.932906931760,-0.050477559712,-0.180210541776,-0.079062630007,0.176258562824,-0.449101323072,0.412383675477 &
            ,0.393401188377,-1.122956873988,0.267827737318,-0.113025470822,0.348575972165,1.521399420281,0.057687171053,-0.167786789154,-0.222716128338,-0.000265351894,-0.247795835516,0.471062210205 &
            ,-0.138721791279,1.011944284749,0.142499683310,-0.359651919849,-0.106440886160,0.705562424056,-0.594737159901,-0.409823229469,0.107620076421,0.844396404151,0.247056271589,0.437203472583 &
            ,0.214895028819,1.049108217986,1.092301956696,0.318818801294,0.211538718964,-2.718629601904,-0.634039047245,0.062699156235,0.221978536672,-2.336575023784,-0.288880666569,-0.009035739691 &
            ,0.107864420306,2.468821886577,0.345255335301,-0.529499076434,0.617307498313,1.231922390800,0.920409587894,-0.122407332824,0.810003893817,-0.157152804957,-0.234816258506,0.270147096111 &
            ,2.074166957762,-0.698027009758,2.289647235370,0.501179944678,1.339344697166,1.971380070749,0.072887151852,-0.306765200210,-0.447317159163,-0.892628882240,-0.518748773481,-0.187654191082 &
            ,-0.200886024158,0.145441153727,0.219489624277,-0.174619501775,-0.102753829426,-0.235756664791,-0.009261517141,-0.144408312735,-0.248547250594,-0.926765909829,0.273626390281,-0.054067237558 &
            ,0.036016554286,0.785956214890,-0.100436742307,0.003251180590,-0.019825352524,0.348137080615,0.160673154078,0.154211159496,0.176372069797,-0.425468467701,-0.063806706182,-0.301967620400 &
            ,0.144214709050,-0.372694902910,0.101453863719,0.125838746212,0.084065724574,-0.149305490838,-0.023326184537,-0.157886190750,0.102303978993,0.669293690293,0.123494298439,0.062776628998 &
            ,-0.092603149753,0.797407521051,-0.708404119660,0.041362889815,-0.110471931594,1.034237601090,0.579864477583,0.062984894229,-0.012202076141,0.147183317789,0.383880269841,0.144630879316 &
            ,0.018773994260,-1.091658175997,-0.201209854846,0.081620150219,0.148923441168,0.127749161052,0.809130043554,0.208051995492,0.245643893934,-0.420180994926,-0.709988233138,0.002484916403 &
            ,0.315406613617,0.730910898436,0.706670086292,-0.145145134027,-0.082489633575,-0.658015925571,-0.056640025614,-0.248583444311,-0.573315212130,-2.237915818156,-0.884300397485,0.247927346975 &
            ,-0.427808370695,-0.366666079674,-0.192353448976,-0.063515951099,0.040805615033,0.173020807920,-0.044954770428,-0.151675692156,-0.300462299443,0.177946772181,0.434259709075,-0.537213739232 &
            ,0.660673014560,-0.628487871920,0.238492816185,0.029319185047,0.358382915233,-0.802149159068,0.133028546647,0.780194891111,-1.060850857149,3.667981410047,-0.784112621737,0.513642497367 &
            ,-0.351348488946,1.327968143637,-0.230902966758,0.165389019559,-0.390046443783,-2.398294161369,-0.281881816981,-0.290305886696,0.231742002120,2.289489943333,-0.534623115209,0.434767437822 &
            ,0.219459701612,-0.608890933396,0.452781031792,-0.717415047899,0.087138402639,2.463758147076,0.189095011973,-0.315734536484,1.663857207362,-3.620483914866,2.123106239918,-0.648706803014 &
            ,0.556042079200,0.182496729194,0.355484879827,-0.313789148671,-0.614792055860,3.535770835612,-0.545400978933,0.518445599469,-0.546117692229,0.084780868677,0.081648260683,-0.449197887356 &
            ,0.232381320389,2.774572641859,-0.324701933932,0.589302538341,0.167839990486,-1.332914442366,-0.191488778684,0.935600015134,-0.156863039364,-0.609779480378,-0.325080642305,0.091265682246 &
            ,-0.049105951858,0.479031654089,0.172819295987,-0.291898827466,-0.290373993005,-0.119137372560,-0.588434190414,0.041991245088,-0.193238347499,0.041346099017,0.210215328749,-0.024982933116 &
            ,-0.231977461087,0.358243071599,-0.298149211182,-0.000924544195,-0.127715596520,-1.005744166036,-0.163534835323,0.250064970620,-0.288159272010,1.444273988909,-0.122482134251,0.304356397783 &
            ,-0.074911864954,-0.225562334949,-0.237202634560,0.189400222054,0.080605821138,0.380087451583,-0.165862958076,0.151083463354,0.019791333225,0.834290605328,0.098199182809,0.095123606004 &
            ,0.056141656033,0.583765379891,-0.141890463255,0.243206839509,0.208411805329,0.622283395315,-0.211356757948,0.335365836595,-0.239675384779,-0.449152488856,-0.146822610416,-0.039275670257 &
            ,-0.249878477359,-0.847920774346,0.131083378440,-0.085825187887,0.037700301218,0.735336125126,-0.464381210422,0.338129332674,-0.028074458864,-0.511250075335,0.349970851439,0.285335929783 &
            ,-1.882144504301,-1.163354484322,-1.233703743465,-0.690718305162,-1.769855726416,5.359437727854,0.446093672926,-0.159782945484,1.379512384900,1.142918932428,0.409893311373,0.148617089317 &
            ,1.345637634200,-2.329499587988,-0.177294951444,0.569482760627,0.216764194167,-0.058735129689,0.404672598009,0.705157028055,0.424653249731,-3.705270377430,-0.132435922705,-0.687725718454 &
            ,-1.479483279109,-0.822074903332,-0.694248191813,-0.489010051004,-1.615209256244,0.459170977602,0.018138663764,0.145364896780,0.174789210382,-0.089734358773,1.196676890537,0.538791320725 &
            ,0.328511182569,-1.876114011987,-0.559046678389,-0.084953118416,1.631600240417,1.023653495499,-0.362963956213,-1.405134217358,-0.234542640189,-0.706187441744,1.343131403435,0.754213205552 &
            ,-4.455750684646,-1.080342163407,-2.812780655206,1.358223432699,-2.774386536957,-2.370285750344,-0.405564078586,-0.923710508083,-1.065718103116,1.285041005552,-1.198715214648,-0.113559774063 &
            ,-2.335285005258,-2.564842982268,0.033559033563,0.333364166272,-1.698970060609,-1.076965643119,-1.402478733141,-0.233260036635,-2.613238732794,2.161019227023,-0.023836256153,-0.123319450132 &
            ,-1.853959437470,-1.219346715507,-2.017831003371,-0.319150210124,-3.575480098336,-0.091763668553,-1.329519268200,-0.269719138975,-0.898023958635,2.037201368940,1.387754125087,-0.234696307220 &
            ,-1.793993569913,-2.400284206458,-3.110674965702,0.174976057245,-0.269738756390,0.267913511778,-0.335729715616,0.554013913722,-1.681314194012,-2.121946946662,1.051901193807,0.957627859535 &
            ,-1.350167104645,-0.950882420903,-3.014705395989,-0.652169332726,-0.852443721523,-1.399169063610,0.136574023553,-1.465121546763,-2.926554502272,-2.378970927855,-2.645349540888,0.005738169012 &
            ,0.415018308927,-1.783425392694,-0.523464006595,0.877402501324,-2.069542627306,0.149674003534,-1.593953391864,0.642446660035,-0.041581559122,-1.474175772846,-1.770035978687,-2.039405387601 &
            ,-2.161330524181,0.998081659179,-0.928470334298,1.382216390718,0.438254588472,-1.728707649806,-1.622413843787,2.422201627752,-0.696958354983,2.356103107536,0.288331665584,-2.529053840037 &
            ,-1.959725031907,-0.527506680696,-0.335313719786,-2.006614255705,0.600400780807,-1.800888221454,0.089156977558,1.051980720340,1.133191692126,0.052597374553,-0.070662090301,0.658742207402 &
            ,-0.525817985488,-1.378926957712,-0.265914871063,-0.072530070487,-0.246013810049,5.730387358777,-0.163910607724,-0.168721713718,0.944730125747,1.191723930625,1.125567835542,0.199638304697 &
            ,0.267875553584,4.557544361288,-0.130600569396,0.081900855535,-0.083183887515,0.498335081975,-0.729941559453,-0.192639300811,0.408527482621,0.207375310577,0.304785388343,0.228677889203 &
            ,-0.769545454271,-0.434505768979,0.490068448129,-0.158201722895,-1.531438742938,0.959024676070,-0.529220739253,0.082545658588,-0.802471407701,0.223971396867,-1.714081060424,0.186011973081 &
            ,0.218824702077,-2.151787536254,0.572379799348,-0.146520052327,-3.267566573577,0.307569525817,-1.800407840616,-0.014985628777,-4.100950086854,3.728536143902,0.018038360112,0.076379753890 &
            ,-3.504787354135,0.913289974551,0.000200243491,-0.023058569678,-6.319300014310,0.972313056683,-0.800285729839,0.236782730666,-8.984385641787,-2.098283007095,-7.138150150150,0.193953616423 &
            ,-11.144034989422,5.102304355750,0.559086422430,-0.483066652167,-9.514132311194,1.757673611267,-10.233736470329,-0.310486680980,-14.003807236918,4.622179630340,0.177239817774,0.364424226463 &
            ,-10.469602678598,-1.561405093049,-16.294889521638,1.113657773620,-16.016597273288,-1.356608806772,-3.450709019148,-0.843933870788,-5.978450157931,-0.315849589911,-5.512326107082,-0.141526647887 &
            ,-2.396744774863,-0.353857973570,-5.040484710363,0.104962314260,-5.086245198592,-0.198753325834,-3.098225061907,0.046767887867,-3.308709685348,-0.736541146326,-0.500826471926,-0.165202163165 &
            ,-5.173592231773,0.863948696844,-3.319989499477,0.017461383713,-3.839314477418,-1.030916363467,-4.322431994656,0.240472356038,-6.923316639709,0.716588849340,-1.614552637843,-0.519371620374 &
            ,-3.025985935078,-0.749536935447,-6.714316967110,0.477751789766,-6.557574659425,0.005443420475,-2.146853110013,-0.404969952857,-5.001514030959,-2.871077380485,-4.346569628184,0.039010173398 &
            ,-6.923099344781,1.443525463526,-3.895731973167,-1.740407766359,-5.156060270698,0.440388034457,-3.957210820203,0.774205007779,-8.197835534688,-2.865071394914,-2.330753316230,-2.396950668449 &
            ,-5.991232235504,-1.696780106847,-3.119932216922,-0.930467468898,0.515774594259,-1.389695197634,1.881691893800,0.147111652048,-0.443122828665,2.914120950100,-0.211858126301,-1.512223448469 &
            ,-0.006572175309,0.035389440913,0.013841495098,-0.048759514460,-0.034001062960,-0.247133790671,-0.047647512293,0.085729755202,0.232578093028,-0.194252141489,0.347761650800,0.072034583941 &
            ,0.141776684501,-0.872167750845,-0.030576482321,-0.176821540176,-0.388094915363,0.523344487963,-0.535582391064,-0.035684603755,-0.247923173796,0.251308794720,0.146140040139,0.119684766104 &
            ,-0.179684626281,0.025073411850,0.055172382958,-0.016720391482,0.096365593055,-0.487970836293,-0.282399093223,0.061915763520,0.475853215684,0.057331015407,0.287809787118,0.086928266004 &
            ,0.095247113249,-0.063342369469,0.222812865242,-0.094717028605,-0.083517561693,-0.092913995407,-0.138673119871,-0.046466971971,0.149245278729,1.581894015408,-0.030473949423,-0.011333511485 &
            ,0.360966183053,0.180703361997,0.579118193016,0.012669107120,0.461278481505,-0.679660972720,-0.359529146852,0.147976930066,0.627115583607,-0.418205984809,-0.100491332901,-0.099495027568 &
            ,0.428313591521,0.548338995222,0.627710879524,-0.138712632143,0.323444204330,-0.643086970140,0.465049259974,-0.021274835403,0.668240494471,-0.283454991479,-0.141994424339,-0.102413564321 &
            ,0.172332422150,0.932277938825,0.849926797012,0.055254864930,0.705170439794,-0.896213961843,-0.220868055504,0.273592918462,0.636052674455,0.048911587396,0.341755556800,0.098974837038 &
            ,0.229758081709,1.495824559136,0.392401186177,-0.038238114053,0.323393498929,-0.312375578789,0.272924116708,-0.087446599576,0.168440606392,0.246948832509,0.100733942561,-0.027282613978 &
            ,0.124376365690,-0.339122663471,-0.012077294983,-0.071800565544,0.019154039578,-0.771426432802,0.304235731135,-0.092605046650,0.418993040239,0.205488272968,0.429060964141,0.068112278745 &
            ,0.296858762304,0.651620784947,-0.001560630094,0.062480049349,0.322371509812,0.082297362059,0.132296535460,0.012003630950,0.138562039347,0.829044851754,0.302421923678,-0.026693986629 &
            ,0.192570413999,0.100696459531,0.002696458077,-0.003959883362,0.078245750656,0.302277368349,0.329995252527,-0.026873405637,0.032305732835,0.360121516694,0.070915061437,0.085227594314 &
            ,-0.014361148279,-0.878163888130,0.088241086758,0.113848603257,0.050100572383,-0.145025816409,0.041346355692,0.049398116440,0.123824859049,0.846302164059,-0.120642721151,0.017202303333 &
            ,-0.166590025956,0.274160654650,-0.240007912689,-0.090612952119,-0.102248738936,-0.212739438594,0.082762424216,0.130614596671,0.111535242679,0.327268387221,0.078631932892,-0.099368501432 &
            ,-0.032343670923,-1.122968774708,0.080038036392,0.100365735421,-0.060501264926,-0.118774147018,-0.096900341544,0.009803799740,0.020379264950,0.197626127724,-0.005527948801,-0.044422582996 &
            ,-0.040455533370,-0.362039569402,0.178290312498,0.154973764193,0.045174070533,0.482380138883,-0.188972800962,-0.148617216133,-0.132275277636,0.360114327796,-0.007540731689,-0.041886834351 &
            ,-0.025063044751,-0.428226480264,-0.107577654702,0.091519861238,0.171356262236,-0.226625421819,0.149467817533,0.015292690727,0.014481031327,-0.041833415100,0.064545070220,-0.092243705376 &
            ,0.068036527755,0.317192848654,-0.088331327791,0.052548041754,-0.015018730616,-0.573111742290,0.107531341200,0.048608286763,0.026161661069,-0.264469666646,0.171480155222,0.024980303509 &
            ,0.116582599436,0.996977397322,-0.208503406831,-0.009911766399,0.048544555111,-0.043994453158,0.058336103392,-0.047867180146,0.007518559590,-0.175740475108,-0.028352010059,0.019198930687 &
            ,-0.093190141316,0.027487798036,-0.187623722110,-0.010977269526,-0.108315478715,-0.669986130081,0.074508806150,0.021232472771,-0.023504993733,0.042631596597,-0.068410947759,0.002237127852 &
            ,0.007611640370,0.269428602366,0.046804152618,-0.029379498850,0.013283607657,-0.018623216264,-0.004704482272,0.026364533423,0.007907954896,0.041071031422,0.015274660447,-0.014758501799 &
            ,0.081234866833,-0.163914423948,0.037809353311,-0.013247972682,0.013446295488,-0.113341514726,0.063156178024,-0.048503533066,-0.003048189016,0.058069055513,0.051029349196,0.014613105550 &
            ,0.012270113472,-0.104307655461,-0.028944004882,-0.012354558245,-0.042813084483,0.077527428999,-0.045416873902,0.008123270950,0.025496637837,0.117212821493,-0.042512481726,0.028109984070 &
            ,-0.050154094509,0.114540330653,-0.085662231133,0.035771027391,0.035308741734,0.151810010625,-0.058764172988,0.063260519880,-0.115441323057,0.337389429251,-0.351413678789,4.953205951248 &
            ,-0.023333396297,0.256828502783,0.110042142903,-2.728720725199,-0.063345681419,-0.031982934544,-0.097497433824,0.000951880474,-0.022993653033,-0.332501286681,0.063348232297,-0.048237364535 &
            /),(/8,126/))
real, dimension(2,8) :: hidden1 = &
  Reshape((/0.67183,-3.5235 &
            ,3.4246,-1.9206,-6.0386,2.3294 &
            ,-4.0166,2.6797 &
            ,-2.6662,11.9976 &
            ,4.8125,-1.5439 &
            ,-6.7629,3.772 &
            ,-4.839,3.3933 &
            /),(/2,8/))
real, dimension(1,2) :: hidden2 = &
  Reshape((/0.36403,1.1888/),(/1,2/))
real, dimension(8) :: bias1 = &
  (/9.503,1.0993,7.243,-1.4515,6.8854,-0.44966,3.3383,1.4682/)
real, dimension(2) :: bias2 = &
  (/-2.096,-0.82397/)
real, dimension(1) :: bias3 = &
  (/-0.26237/)
contains
subroutine fnet_X2_initall()
end subroutine fnet_X2_initall
subroutine fnet_X2_engine(inarray, outarray, init)
  intrinsic MatMul, Size
  real, dimension(:), intent(in) :: inarray
  real, dimension(:), intent(inout) :: outarray
  real, dimension(126) :: inarray2
  real (kind=8), dimension(8) :: layer1
  real (kind=8), dimension(2) :: layer2
  real (kind=8), dimension(1) :: layer3
  integer , intent(inout) :: init
  integer :: i, j
  do i = 1, 126
    inarray2(i) = inarray(127-i)
  end do
  layer1 = MatMul(input,inarray2)
  layer1 = layer1 + bias1
  do i = 1, Size(layer1,1)
    layer1(i) = 1.0 / (1.0 + DEXP(-1.0 * layer1(i)))
  end do
  layer2 = MatMul(hidden1,layer1)
  layer2 = layer2 + bias2
  do i = 1, Size(layer2,1)
    layer2(i) = 1.0 / (1.0 + DEXP(-1.0 * layer2(i)))
  end do
  layer3 = MatMul(hidden2,layer2)
  layer3 = layer3 + bias3
  outarray(1) = layer3(1)
end subroutine fnet_X2_engine
end module fnet_X2
