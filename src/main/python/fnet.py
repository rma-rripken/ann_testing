import numpy as np


from tensorflow import keras
from tensorflow.keras import layers
from tensorflow.keras import regularizers

def exp_transform(vec):
	nvals = len(vec)
	vec_out = np.zeros(nvals)
	for nv in range(nvals):
		vec_out[nv] = 1.0/(1.0 + np.exp(-1.0*vec[nv]))
	
	return vec_out

# This is a pure numpy version of the function
def predict(input_vec, weights, biases):
	layer1 = np.matmul(weights[0],input_vec)
	layer1 += biases[0]
	layer1 = exp_transform(layer1)
	layer2 = np.matmul(weights[1],layer1)
	layer2 += biases[1]
	layer2 = exp_transform(layer2)
	layer3 = np.matmul(weights[2],layer2)
	layer3 += biases[2]
	return layer3

def create_fnet_model(input_dim):
	# Define the model architecture
	model = keras.Sequential([
		keras.layers.Dense(8, activation='sigmoid', input_dim=input_dim),
		keras.layers.Dense(2, activation='sigmoid'),
		keras.layers.Dense(1)
	])
	
	# Compile the model with an appropriate loss function and optimizer
	model.compile(loss='mean_squared_error', optimizer='adam')
	return model

def set_weights(the_model, weights, biases):
	#input_array is from fortran, need to adjust it for numpy
	the_model.layers[0].set_weights([np.transpose(weights[0]), biases[0]])
	the_model.layers[1].set_weights([np.transpose(weights[1]), biases[1]])
	the_model.layers[2].set_weights([(weights[2].reshape(-1, 1)), biases[2]])  # seems to need [2,1] and not [2,]

# Just an example of how we can pull the weights and biases out of a tensorflow model.
def print_tensorflow_details(model):
	np.set_printoptions(threshold=np.inf)
	for layer in model.layers:
		weights, biases = layer.get_weights()
		print(f"Layer: {layer.name}")
		print(f"Weights shape: {weights.shape}")
		print(f"Weights:\n{weights}")
		print(f"Biases shape: {biases.shape}")
		print(f"Biases:\n{biases}")
		print("===================================")

def tf_predict(input_vec, weights, biases):
	model = create_fnet_model(126)
	set_weights(model, weights, biases)
	# to do a single prediction we need input to be inside a 1 element array
	
	return model.predict(np.array([input_vec]))[0]


# These could come from parsing the fortran.  Not including that here.

# np.set_printoptions(threshold=sys.maxsize, precision=16)
# print( "input_array = np." + repr(input_array))
input_array = np.array([[ 8.4746524686200e-01, -1.5168924958160e+00,  1.7119863274400e-01,
                          1.5985228706700e-01,  1.8294005182190e+00, -1.8978493210250e+00,
                          6.7226916688900e-01,  3.6328898148800e-01,  1.9033102289310e+00,
                          9.4315672402400e-01, -1.3502597569970e+00, -9.5225547981300e-01,
                          3.5058759098800e-01, -3.2175460364800e-01, -1.4696813197100e-01,
                          1.0223874687120e+00, -1.6663037242700e-01, -7.7214212223000e-02,
                          2.4453080341800e-01, -4.8979853395400e-01,  1.2391004756350e+00,
                          -1.5284989489000e-01, -6.0383802814800e-01,  9.4619299278300e-01,
                          2.2561591823840e+00,  5.5989466620400e-01,  9.9927258692800e-01,
                          -2.8488923093830e+00,  4.9193159059300e-01, -1.2866117021760e+00,
                          -5.4776543176100e-01,  9.5852997331900e-01,  3.8983137283000e-02,
                          7.2220658966800e-01,  5.9726398657100e-01,  1.0554955251750e+00,
                          -1.6293142871100e+00,  5.8973760453000e-01, -2.0718124410400e+00,
                          -2.1290775429390e+00, -1.8070506306790e+00, -1.4597733442960e+00,
                          -2.3184948565010e+00,  1.8091439033690e+00, -1.7843822922220e+00,
                          -3.3814002953480e+00, -4.0879550667100e-01, -7.2787230224300e-01,
                          -3.7350806490300e-01, -7.3878701232000e-01,  7.3629038560600e-01,
                          -1.7133138781100e-01, -1.0904906160800e-01, -1.3772853424500e-01,
                          4.7063218301680e+00, -2.6013158612900e+00, -3.1786681550740e+00,
                          2.4052487583720e+00, -1.4631257331500e-01, -3.6763774280500e-01,
                          -1.1697695258060e+00, -3.5366904787450e+00, -1.1431776766640e+00,
                          2.6001911807790e+00,  6.1477808774900e-01, -1.3351729986500e-01,
                          -9.8987519716100e-01, -1.7148445765730e+00, -8.5310161841400e-01,
                          -1.7693458717400e+00, -2.8680805460200e+00, -1.9097709319590e+00,
                          5.6950306869400e-01,  1.4488873547150e+00,  1.5145608369710e+00,
                          1.3628306907310e+00, -2.6180115318230e+00, -3.4887437794240e+00,
                          -4.9160831244280e+00, -5.9168015095820e+00,  2.2748341180600e-01,
                          5.1219644903870e+00,  5.7007315452760e+00,  6.9776174634100e+00,
                          6.3104287794940e+00,  4.0026724211560e+00,  1.6152726954680e+00,
                          1.7299310159670e+00,  2.8649298313500e-01,  6.9005203297900e-01,
                          -3.2303997902800e-01,  2.5169201572800e-01, -8.7892417301100e-01,
                          7.6384135317700e-01,  2.2597298367000e-02,  6.4294311775900e-01,
                          8.4583624470900e-01, -9.0827196755300e-01,  8.0637377000100e-01,
                          5.9502960012600e-01, -5.1144375979600e-01,  1.5127973645700e-01,
                          1.7048066363400e-01,  3.8539853699300e-01, -2.9012511623800e-01,
                          -8.1423785359000e-02,  1.3736820280900e-01, -1.0510959283400e-01,
                          -8.3811806375000e-02, -9.8201538115000e-02,  2.1041186283200e-01,
                          -9.2617635220000e-02, -1.5782403887200e-01,  4.0819720180000e-02,
                          2.9961932895000e-02,  2.0241797944000e-02,  1.5201397742000e-02,
                          -3.9206380484800e-01,  8.8063225328000e-02,  4.5419134500000e-02,
                          -1.4457532493000e-01,  8.4954835690000e-03, -1.5639404592900e-01,
                          -2.0140377281800e-01,  2.9043661954000e-02, -9.7631736407000e-02],
                        [-6.9930913828600e-01,  1.0207179425660e+00, -3.2788233782460e+00,
                         8.4925611251500e-01, -3.5187758611440e+00,  6.5274705744340e+00,
                         -3.0030916224720e+00, -2.6043803014090e+00, -6.5711948227400e-01,
                         -2.5960101939280e+00,  9.1056842068500e-01,  1.4030076723800e+00,
                         4.5389544593800e-01,  2.3061269292130e+00,  1.0475441677010e+00,
                         -1.5115603120080e+00, -8.2008600982500e-01,  8.4569561516500e-01,
                         -3.5019926495360e+00,  3.6063106646560e+00,  5.9619170918200e-01,
                         -2.2549877057140e+00, -1.5262723417710e+00,  4.2883872327320e+00,
                         7.9905619268400e-01,  2.8909743501000e-01,  2.2277850127540e+00,
                         8.2265727732800e-01,  9.2666649761900e-01,  8.9086964411600e-01,
                         2.0862553163900e+00, -8.9267974820000e-02, -1.1691015558940e+00,
                         -3.1093958635700e-01,  1.4391152185590e+00,  3.4240430576800e-01,
                         -2.9738177754000e-02, -3.1834432770860e+00,  1.4320023359250e+00,
                         -2.8990445517100e-01,  3.0279384885580e+00, -2.3840963660870e+00,
                         -7.9270382725000e-01, -2.5030586775400e+00, -1.0578958259280e+00,
                         -2.1070368080430e+00,  1.0711515379190e+00, -2.0088137245710e+00,
                         -6.0351473387000e-02, -1.5799563902060e+00,  1.0538757800330e+00,
                         1.0750233760420e+00, -1.6980813507500e-01, -5.9108677217900e-01,
                         -1.0964858689800e-01, -1.9426261429750e+00,  1.9570186907390e+00,
                         -7.2310476163300e-01,  3.2335019958220e+00,  1.0659219459460e+00,
                         -1.7993691718950e+00, -3.2394259292540e+00, -3.1063003254810e+00,
                         2.8801124777890e+00,  1.0637295388480e+00,  3.7908598658000e-01,
                         2.0566447575100e-01, -4.3175592966400e-01, -9.7682678112900e-01,
                         -1.0224577071030e+00, -4.7062566919600e-01,  2.3726692250400e+00,
                         3.1421998046630e+00,  2.6443284797840e+00,  5.5754904388200e-01,
                         3.1683169465100e-01, -1.0506437349910e+00,  3.3276539469840e+00,
                         -5.5384290469900e-01,  1.7126544693680e+00,  2.4682136493140e+00,
                         -2.1826985401340e+00, -2.0967376383770e+00,  1.6442547885800e-01,
                         2.1497333399600e+00,  1.2323951357200e-01, -6.0379665020400e-01,
                         1.2095524238500e-01, -7.4163356274100e-01,  3.4800419336440e+00,
                         7.7066653310800e-01,  7.2110585197700e-01, -1.8608576662740e+00,
                         2.9392563619300e+00, -1.7334951652590e+00,  2.6534685841800e-01,
                         1.5689625746570e+00, -4.6970694160900e-01,  2.8546629106100e-01,
                         1.1580126640880e+00,  7.4566380706000e-01,  1.5624098225500e+00,
                         -2.5213018703600e-01,  1.6158907260220e+00, -4.8842620020000e-02,
                         -1.7146304259120e+00, -5.0585343204700e-01, -5.7463649409700e-01,
                         6.4079340439600e-01, -1.5416585241300e-01,  3.1184564567300e-01,
                         -5.2176768557600e-01,  6.3180136487500e-01, -2.0577040741300e-01,
                         -1.9061878498800e-01,  6.5309071930000e-01,  2.5977821019000e-02,
                         -1.5240816319100e-01,  1.1977652993400e-01, -1.9699681984000e-02,
                         1.6622427100100e-01,  7.6488660598000e-02, -1.3761007855700e-01,
                         -3.9164996654000e-02, -7.5077915570000e-02,  1.9176561897300e-01],
                        [-9.4766661902000e-02, -2.9203919428100e-01,  7.0842344919100e-01,
                         -1.0109265606800e-01, -1.2990737215000e+00,  5.2780081178300e-01,
                         -7.0994516481900e-01,  5.0824840010800e-01, -1.4185417498370e+00,
                         -6.5641127201400e-01,  6.3678890220600e-01,  3.8060192326000e-02,
                         -8.1324847284000e-02,  4.5164428178200e-01,  5.6247270290700e-01,
                         -9.9911827577900e-01,  2.6663800764000e-01,  1.6095368969600e-01,
                         -2.6259199661600e-01, -7.0037071450000e-03, -1.0696470812620e+00,
                         7.5275921207700e-01,  1.2288842171700e-01,  2.5844595000700e-01,
                         -2.2839724200990e+00,  3.5812687425300e-01,  1.4401046949420e+00,
                         8.8183182267400e-01,  1.0323633298800e-01,  9.2935402059200e-01,
                         2.4457921945100e-01, -4.8345703700600e-01, -1.7781688811600e-01,
                         -2.9923650693300e-01, -9.7582669517400e-01, -7.6295665759000e-01,
                         2.5888126234350e+00, -1.6287062795000e-01,  2.1880591822790e+00,
                         1.1633313803410e+00,  1.1218581343800e+00, -8.8386768761700e-01,
                         8.9911515251400e-01, -2.5047005002990e+00,  1.5637210289640e+00,
                         2.7637932688670e+00,  2.3098022916500e-01,  3.5515984608300e-01,
                         4.9983298214300e-01,  3.1811407226400e-01, -3.1579726013500e-01,
                         3.6296949389600e-01, -2.3689770930600e-01,  2.3817592888800e-01,
                         -1.5597982669620e+00, -2.5634780588180e+00,  3.4362283771610e+00,
                         7.5717934963100e-01, -1.7979130414050e+00, -2.8000781399570e+00,
                         1.0636996426290e+00,  3.0193570919450e+00, -5.9045456530000e-01,
                         2.1392909916010e+00,  2.2403327279250e+00,  6.6389824392900e-01,
                         1.2000737569840e+00, -3.4210534499200e-01, -2.3379186775000e-02,
                         6.0225892400000e-03, -3.3585948762340e+00,  2.6451873496740e+00,
                         4.4484740117000e-01, -2.1347088857820e+00, -3.5113699022600e-01,
                         -3.0254041317210e+00,  2.6740297917950e+00,  3.3133077758200e-01,
                         6.9281676523800e-01,  8.0673999448100e-01, -2.7488237081090e+00,
                         -3.2091606844560e+00, -2.5722848113040e+00, -3.5114393180290e+00,
                         -2.6727862019530e+00, -1.8244285316730e+00, -7.2342235211600e-01,
                         -2.7237496143000e-01,  6.2222682524100e-01, -2.6704602803650e+00,
                         1.5494811609000e-01,  1.2626148341200e-01,  3.4979429145100e-01,
                         -4.0725921702700e-01,  1.7928250212400e-01, -3.2527169510300e-01,
                         -4.8192184957900e-01,  5.8822691916800e-01, -3.9887737098700e-01,
                         -7.3873294607000e-02,  3.5069497005700e-01, -2.5397626445000e-02,
                         -9.1750522947000e-02, -1.5862054116800e-01,  2.1245505688900e-01,
                         1.1026501386500e-01, -7.0474804911000e-02,  2.7474781852500e-01,
                         4.0573382760000e-02,  7.2271134353000e-02, -1.6571328036300e-01,
                         4.7740874370000e-02,  1.1185207741700e-01,  1.3733741270000e-02,
                         -2.1415642522000e-02,  2.1178844683000e-02, -5.1614205090000e-03,
                         2.0370676684900e-01, -4.7586270042000e-02, -4.5165857807000e-02,
                         3.6938980095000e-02,  4.4708049210000e-03,  4.2227196547000e-02,
                         8.3626402000000e-02, -7.4261439054000e-02,  1.7404307439000e-02],
                        [ 2.0029613744170e+00, -3.6290379297970e+00,  5.6945107411900e-01,
                          3.9152807525800e-01, -1.3623472094140e+00,  1.0049497510180e+00,
                          -3.3964644197830e+00,  3.0095694186950e+00, -1.5859152697650e+00,
                          -1.0244663965970e+00,  7.8174418001500e-01, -4.1304299764900e-01,
                          3.7787531141800e-01,  4.4792208537700e-01,  6.7913382332200e-01,
                          -4.0696058796400e-01,  1.3912119967000e-02, -8.2635272306000e-02,
                          -2.7497428675250e+00, -3.5730257787800e-01, -2.0598005672940e+00,
                          1.7162670264920e+00,  2.5843776935670e+00,  1.5221495155530e+00,
                          -4.7592308115430e+00, -1.5454334680370e+00,  8.5874097402980e+00,
                          -3.4757341879760e+00,  4.0195953217500e-01,  6.6056406070500e-01,
                          -5.8320077306400e-01,  1.0321428334000e-01,  2.6770637090900e-01,
                          5.2423073258100e-01,  7.2127987351000e-02, -1.5669927680680e+00,
                          3.6274545291550e+00, -1.1291278869810e+00,  4.2826112931270e+00,
                          -1.0955133144070e+00,  1.0312291592820e+00, -1.5531189520860e+00,
                          2.1581440469610e+00, -3.3103832027320e+00,  2.8378008336390e+00,
                          -1.0711904194300e-01, -5.0479510169000e-02,  1.7328495223000e-01,
                          -3.4783621428800e-01, -3.9191827127500e-01,  2.7369776708400e-01,
                          3.9917869213300e-01, -3.0216396424600e-01, -4.3251642225800e-01,
                          8.7835988952500e-01, -8.4642032352990e+00,  3.0177056690560e+00,
                          7.9164111753050e+00, -2.0488229421490e+00, -8.5032426858400e+00,
                          -4.6512400976000e-02,  2.9093101190820e+00,  1.5824512350620e+00,
                          2.1718181664240e+00,  1.6470759422490e+00,  1.3130593578410e+00,
                          7.6230965087300e-01,  9.1733013894700e-01,  2.1026759205180e+00,
                          -1.1100060287000e-02, -1.1715290792950e+00,  2.7888636331410e+00,
                          -1.2702562852180e+00, -2.2795900545210e+00, -6.2841868484200e-01,
                          -2.3089999855800e-01,  4.2624158202930e+00,  6.1185781413090e+00,
                          1.5177527832550e+00, -1.6231523645860e+00, -4.0090482327500e+00,
                          9.0221506295000e-01, -1.5295227842190e+00, -3.4383050097400e+00,
                          -3.2881711003560e+00,  4.9470102860900e-01,  2.3761439563700e-01,
                          4.6099233817500e-01,  2.5777574959000e-01, -2.7208100217520e+00,
                          5.8032070125900e-01,  1.7977663037400e-01, -3.5493401558000e-02,
                          -7.0752281710000e-02, -1.4916695236900e-01, -4.1907157238000e-02,
                          -6.6115683582600e-01, -7.6596526365000e-02, -1.4899908351800e-01,
                          8.5976272341000e-02,  1.5787155995000e-01,  5.6574604592500e-01,
                          6.7074127004000e-02,  1.7078199095700e-01,  8.4264593616000e-02,
                          2.4241039527400e-01, -4.7969317463200e-01,  5.6232088913800e-01,
                          -1.1351197426400e-01,  3.3287221883000e-02, -2.7920612858000e-02,
                          -8.3397436472000e-02,  1.1308021608200e-01,  9.8668565091000e-02,
                          -1.3341933547700e-01,  9.7696789182000e-02, -1.3532324117100e-01,
                          1.2925195948200e-01, -7.7159688036000e-02, -9.3387767896000e-02,
                          -8.2967955570000e-03,  3.1382769069000e-02,  1.3255679652000e-02,
                          2.2145482842000e-02, -2.5749384779000e-02, -1.7028056254000e-02],
                        [ 2.1242987434760e+00, -2.6836720429790e+00, -5.4787800570000e-01,
                          5.2516690888000e-01, -1.2805891275840e+00,  1.8963444430360e+00,
                          -4.3615857722390e+00,  2.8712277196080e+00, -2.1506026269250e+00,
                          -7.9636767978700e-01,  8.8001670357000e-01, -1.5519304078000e-02,
                          3.5714860276500e-01,  1.2483793218210e+00,  1.7637972102600e-01,
                          -5.8096895630700e-01, -3.4225580615200e-01, -5.4525281296000e-02,
                          -3.5688124987590e+00,  9.4887498759000e-01, -1.4408787700780e+00,
                          9.8968551334600e-01,  2.6658385779810e+00,  9.8553724337200e-01,
                          -4.9703462875020e+00, -2.7987265107310e+00,  8.9066880640650e+00,
                          -3.5528858356450e+00,  4.6283260086700e-01,  5.2949226615500e-01,
                          -6.7682361911900e-01,  6.4072239271400e-01,  4.2879502933000e-01,
                          5.9949733010300e-01,  1.0141768379800e+00, -1.6820414461650e+00,
                          4.7606006870610e+00, -2.1447468594440e+00,  5.4879189491620e+00,
                          -1.5926293148020e+00,  2.0749299581130e+00, -1.2847422682230e+00,
                          4.3049887157940e+00, -2.4480907223230e+00,  3.4043693614310e+00,
                          -1.4627531672710e+00, -2.8639908265700e-01, -1.7044831914500e-01,
                          -7.9479931668900e-01, -7.8335199949100e-01,  2.3847583517600e-01,
                          3.9851731906600e-01, -1.1564510658300e-01, -9.7099668984400e-01,
                          -1.1438709366390e+00, -3.0007263885100e+00,  1.4676535923940e+00,
                          8.1980469438630e+00, -8.2348182697000e-01, -4.6720041511300e+00,
                          -1.7268408999550e+00,  5.4377954325800e-01,  9.1539507098900e-01,
                          -1.4467709234100e+00, -1.4493114601430e+00,  4.7998940965300e-01,
                          5.3799974723600e-01, -1.7582340727000e-01,  1.8253647111200e-01,
                          2.9456581597490e+00,  4.7492837662210e+00,  3.0529842694000e-01,
                          -1.7951240840020e+00, -1.3537482324200e+00, -2.1981943200500e-01,
                          -7.1410105066400e-01,  5.6181697551050e+00,  1.0548555636467e+01,
                          4.9607833109450e+00,  1.6725815114840e+00, -1.9184057912020e+00,
                          -7.1215257331520e+00, -2.8081242870830e+00, -2.3844803772180e+00,
                          -1.5583590882280e+00, -6.5859755004000e-01, -1.2838128894800e+00,
                          1.0704697023210e+00, -2.0867571459890e+00, -7.0184410415900e-01,
                          8.3577662854600e-01,  6.9089432547000e-02, -4.3945538464900e-01,
                          3.8959962566800e-01, -3.5471414047100e-01, -2.5359139471200e-01,
                          -4.6208466802900e-01, -8.5645827072800e-01,  9.8733966567000e-02,
                          4.8546265727300e-01,  3.6379078373800e-01,  1.1893972386290e+00,
                          2.7080018368000e-02,  5.0388272124000e-01,  1.3150258616000e-02,
                          -2.1555381643800e-01, -4.9162280515500e-01,  2.9543317066200e-01,
                          -5.6486329238000e-02, -5.4193700277000e-02,  7.6694878027000e-02,
                          -2.0630059831600e-01,  2.3772868592000e-01,  7.4338761741000e-02,
                          -2.0006385053100e-01,  2.1180241002600e-01, -1.8483672020700e-01,
                          1.3154777198900e-01, -4.5846839569000e-02, -1.4586254792300e-01,
                          -6.6936168430000e-03, -6.8551679590000e-03,  3.1667049380000e-02,
                          3.6140269259000e-02, -6.1667934730000e-03,  2.3119308591000e-02],
                        [-7.9117021340100e-01,  4.3651189558500e-01,  9.6140720521300e-01,
                         -7.3426449389700e-01,  3.2091667244600e-01, -6.7032603405700e-01,
                         -1.8295856300200e-01,  5.8533993337600e-01, -8.3709395095400e-01,
                         -1.0379638579810e+00,  5.2950423079000e-02, -4.9054107420400e-01,
                         3.5298707427100e-01,  1.1058467356610e+00,  7.7195407327800e-01,
                         -1.6852704722570e+00,  6.7618041324100e-01,  3.1493720851100e-01,
                         9.8124387670700e-01,  1.6665517210600e+00,  5.0537324216400e-01,
                         5.8925625988100e-01, -2.3126170084000e+00,  8.9484611888700e-01,
                         -1.3470878102830e+00,  1.6794045982950e+00, -1.6270117345090e+00,
                         1.2525964603840e+00,  9.6533639821800e-01,  8.0690264981800e-01,
                         5.5271145550500e-01, -1.4633442430500e-01, -9.1256065577200e-01,
                         1.1425880318000e-02, -1.4687972549270e+00,  1.0560487096400e-01,
                         4.1143654357620e+00, -2.2727287622200e-01,  2.1622375422770e+00,
                         1.0728500732470e+00,  1.0801960685930e+00, -3.4779481371880e+00,
                         -7.8201069988000e-02, -2.8005657355120e+00,  2.2938747354080e+00,
                         4.0954690657610e+00, -1.3148181875000e-01, -7.5901461282000e-02,
                         1.2080468349940e+00,  1.7548678354400e-01, -2.3011767902300e-01,
                         7.5404403220600e-01, -4.3155947640400e-01,  4.3026777041200e-01,
                         -2.2116891799320e+00,  7.2858327179700e-01,  2.5524861858270e+00,
                         -1.4873332722090e+00, -9.1703614739400e-01,  2.7778777363520e+00,
                         -1.2242091600640e+00,  3.3770184897440e+00, -3.3423511487320e+00,
                         2.5443488328060e+00,  3.5666128383760e+00,  1.1415021145090e+00,
                         -9.4145254971400e-01, -1.6392077256850e+00, -2.7785270328200e+00,
                         -2.6812949346850e+00, -1.0144928874550e+00,  1.2057980813650e+00,
                         1.4590674559940e+00,  5.5786166900000e-02,  1.6239206445100e-01,
                         -3.6602321005260e+00,  1.9778574535850e+00, -1.3038453209300e+00,
                         2.7733027858870e+00,  2.4888506783290e+00,  5.7212527036740e+00,
                         3.2131911987650e+00,  8.8170606615200e-01, -1.4739685327700e-01,
                         -4.0014646365500e-01, -1.0562872194100e-01,  4.8275944269300e-01,
                         1.0165107838500e-01,  6.4814343974800e-01, -1.9754065113560e+00,
                         -1.9046514791700e-01,  6.8943277402000e-01, -5.6062650684700e-01,
                         3.1967677163300e-01,  3.4069942058500e-01, -3.6926261163900e-01,
                         -2.0041020664100e-01, -2.7751618635000e-02, -5.3514617764200e-01,
                         1.9093094730000e-03,  3.5575180135700e-01,  9.9627766906000e-02,
                         7.9812238627000e-02,  1.0792676312400e-01,  1.3428606367900e-01,
                         -4.2702778838800e-01,  1.1870631611400e-01, -3.2401731844000e-02,
                         9.6356650099000e-02, -1.5240698307000e-02, -8.8610735590000e-02,
                         2.6960656205000e-02,  1.7584795139900e-01, -3.7678211840000e-03,
                         -4.2152076040000e-03,  5.7324120488000e-02,  1.6101733073000e-02,
                         8.3677170416000e-02,  4.4764312446000e-02, -6.4750163385000e-02,
                         -6.6640967512000e-02, -4.9367427449000e-02, -2.3605642385000e-02,
                         6.1122878425000e-02, -1.0183880102200e-01,  2.3033372536000e-02],
                        [ 8.2653779743000e-02, -2.4209249656000e-02,  2.8011760589100e-01,
                          8.3580408096100e-01,  2.4475055094530e+00, -2.1549737521960e+00,
                          2.5738513748400e-01, -6.7949241819900e-01,  9.1103565160000e-03,
                          -1.1931901462030e+00,  1.4490927967100e-01, -4.1935613157100e-01,
                          8.8229079258500e-01,  3.9583382882300e-01,  7.8317374250500e-01,
                          -1.3552343185400e+00,  1.7754995620000e-02, -3.7183598550000e-01,
                          6.2595817928000e-02, -1.0585406370030e+00,  7.5415488427900e-01,
                          6.4555887734000e-02, -3.2922802146740e+00,  1.7364040224210e+00,
                          2.7791807684450e+00,  2.2845733618500e-01, -2.4125645659990e+00,
                          -1.7131896807900e-01,  1.0602389362230e+00, -1.9280112974500e-01,
                          -4.5262348716700e-01,  1.0103505174710e+00, -1.0006949363900e+00,
                          1.4031161791490e+00, -6.4553434646000e-01,  5.5925302273800e-01,
                          -9.0203673339700e-01, -3.1503026369580e+00, -2.9197793772720e+00,
                          -1.6124178432720e+00, -1.7147914571680e+00,  9.9488286588900e-01,
                          2.0750104885660e+00,  1.3433871830400e+00,  9.9291115655500e-01,
                          2.8040080437400e+00, -1.8599604127100e-01, -1.3436231684000e-01,
                          5.0297008263600e-01, -1.5871994387300e-01,  6.7070606389000e-02,
                          4.3159053666800e-01, -2.0476430096200e-01, -2.4776060392000e-02,
                          3.6081919272420e+00, -1.3470105889950e+00, -8.4002150856000e-01,
                          -1.2694037695200e+00,  3.3573678926960e+00,  6.8371857940160e+00,
                          -2.2111145823060e+00, -2.8820527475370e+00, -4.8825416335790e+00,
                          -3.3478935985740e+00,  2.2751941633330e+00,  1.9545868119580e+00,
                          7.5380706122300e-01,  2.7515150805800e-01, -1.3756917210010e+00,
                          -2.3157542454140e+00, -6.2532286958600e-01, -2.1194459539350e+00,
                          1.1145866547200e+00,  6.8111549095410e+00,  1.9348700129030e+00,
                          8.1456218961790e+00,  9.7957004069410e+00,  3.8728704314850e+00,
                          5.9017867071400e-01,  5.7792186308700e+00,  7.1650286926110e+00,
                          2.1436479410970e+00, -2.8018243087070e+00, -3.7343269108490e+00,
                          -4.8935090777460e+00, -1.3638705994000e+00,  8.5815138430200e-01,
                          4.8790506747090e+00,  5.2173100451740e+00,  3.6820516168700e-01,
                          -3.3877856461800e-01,  2.1270822847000e-01, -9.5421012779600e-01,
                          4.8723623473600e-01, -8.4065382417400e-01, -3.3031921274700e-01,
                          7.7156770607000e-02, -2.4148374682000e-02, -5.0219751314700e-01,
                          7.5590036923700e-01,  2.2295514566800e-01,  1.3407424764100e-01,
                          6.5128820909700e-01,  6.1447320308300e-01,  1.6439964808500e-01,
                          -6.6123478530800e-01,  2.4303390058400e-01, -3.5809416025800e-01,
                          -1.0365255912400e-01, -5.5278602078000e-02,  9.8403966565000e-02,
                          -1.0806201182000e-02, -7.6057556756000e-02, -4.3468503830000e-03,
                          -2.4664574130000e-02, -1.8236557360000e-02,  5.1491867553000e-02,
                          -2.7029543684900e-01,  1.2280803676000e-02,  5.5363079600000e-03,
                          -1.0857657275500e-01, -6.0143577826000e-02, -9.1102343322000e-02,
                          -8.6041403380000e-03, -6.4803604921000e-02, -1.0689025526200e-01],
                        [-3.8641440432300e-01,  1.3377819912270e+00, -4.0050581056100e-01,
                         3.2652782436400e-01, -2.8155089588910e+00,  2.0311454835270e+00,
                         1.2219067742100e-01, -1.2970418031940e+00, -1.0241799100750e+00,
                         8.3178836076900e-01,  2.6381042537300e-01,  7.6357935689700e-01,
                         -8.9156487306000e-01,  2.9620076310700e-01, -2.5067674927300e-01,
                         -6.4308421795000e-02, -3.1247690819700e-01,  5.0209533042500e-01,
                         -5.4530198824900e-01, -4.6269415430000e-03, -1.0176910045300e+00,
                         -6.0401053959400e-01,  1.1344405459720e+00, -1.5042898593430e+00,
                         -1.7189136015140e+00, -1.8309830452300e-01,  5.0714837148700e-01,
                         1.4209532999630e+00, -9.8076186678000e-01,  4.4520064321500e-01,
                         2.9292830750200e-01, -5.3179975120100e-01,  4.6805882053400e-01,
                         -1.3904631875200e+00, -1.5669690891300e-01, -7.1825380164300e-01,
                         7.3083993405600e-01,  1.7568183804780e+00,  1.6631440292140e+00,
                         1.8038554803180e+00,  1.7720731015500e+00,  5.1726668010600e-01,
                         1.0151032680800e-01, -9.9604188026700e-01, -9.9407763515900e-01,
                         -5.4015031775700e-01,  6.2614261688000e-01,  2.2316445870700e-01,
                         -1.3841187495800e-01,  2.8164240993300e-01, -3.9153951729700e-01,
                         -1.6595113927800e-01,  7.3870065849000e-02,  7.6815573590000e-03,
                         -2.5168660224470e+00,  1.7207459547140e+00,  2.3191120436960e+00,
                         7.0622360097000e-01, -2.4131552371780e+00, -1.3208580876560e+00,
                         2.5014563403700e+00,  4.7878831223700e-01,  2.7139550990960e+00,
                         5.3439190684170e+00, -1.0152821608400e-01,  7.5733342734700e-01,
                         2.0457212597900e-01,  6.6124259370500e-01,  1.8558658700600e+00,
                         1.4558196079730e+00,  2.3959726689770e+00, -2.2635259042150e+00,
                         9.7770472537400e-01, -3.1494882191370e+00,  3.4637764247700e-01,
                         -6.0890157156110e+00,  3.7077110209880e+00, -7.1372170337900e-01,
                         1.6984645794020e+00,  3.8609829922310e+00, -1.4328355790000e+00,
                         3.0438052273000e-01, -8.7869262603600e-01,  1.5668714951840e+00,
                         4.2044765647060e+00, -1.4581564216820e+00, -1.3346586578340e+00,
                         1.4979848979000e-02, -7.5051484136500e-01, -2.0791416676160e+00,
                         2.6075735454900e-01, -3.7325717391900e-01,  8.3230888819500e-01,
                         -7.0822594038300e-01,  8.8273198962000e-02, -3.6705639178300e-01,
                         -1.9938499598800e-01,  2.2822620582300e-01, -3.4252830315200e-01,
                         -9.8106279653400e-01,  8.4212506253000e-02, -1.9066494146000e-01,
                         -7.2987806517700e-01, -4.6051412844400e-01, -6.2966459852000e-02,
                         9.3710977047000e-02, -1.9106104306000e-01,  2.0107473407500e-01,
                         1.6968358471200e-01,  7.7251417200000e-02, -1.7377791610800e-01,
                         -3.5993433130000e-03,  1.1299959113800e-01, -3.7188111136000e-02,
                         2.0044186327000e-02,  7.4463285760000e-02,  3.3107609724000e-02,
                         2.8156172067700e-01, -2.8489862726000e-02, -2.2523056660000e-03,
                         1.3734733824100e-01,  5.6733011465000e-02,  8.5874027887000e-02,
                         6.3746453129000e-02, -1.6777680352000e-02,  6.8175506048000e-02]])
hidden1 = np.array([[ -0.54676,  -1.6776 ,   0.15857,   0.17588,  -1.124  ,  -1.9823 ,
                      2.072  ,   2.291  ],
                    [ -7.737  ,  -1.7751 , -25.3483 ,  15.0242 ,  -8.7763 ,   9.7069 ,
                      5.3226 ,  10.9932 ]]) # again, parse
hidden2 = np.array([ 0.067241, -6.221   ]) # more parsing
bias1 = np.array([ 0.73999, -2.3748 , -0.84983, -2.148  , -4.475  , -6.3818 ,
                   -2.3283 , -0.40998]) # more parsing
bias2 = np.array([-1.7453,  3.8951]) # more parsing
bias3 = np.array([6.3209]) #

weights = [input_array, hidden1, hidden2]
biases = [bias1, bias2, bias3]

# create a numpy array filled with 0.5
input_vec = np.full(126, 0.5)
input_vec[0] = 0.25
result = predict(input_vec, weights, biases)
result_tf = tf_predict(input_vec, weights, biases)

print("result: ", result, " result_tf: ", result_tf)

input_vec = np.full(126, 0.1)
input_vec[0] = 0.25
result = predict(input_vec, weights, biases)
result_tf = tf_predict(input_vec, weights, biases)

print("result: ", result, " result_tf: ", result_tf)

input_vec = np.full(126, 0.666)
input_vec[0] = 0.25
result = predict(input_vec, weights, biases)
result_tf = tf_predict(input_vec, weights, biases)

print("result: ", result, " result_tf: ", result_tf)